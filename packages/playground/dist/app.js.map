{
  "version": 3,
  "sources": ["../../../node_modules/ohm-js/src/common.js", "../../../node_modules/ohm-js/src/unicode.js", "../../../node_modules/ohm-js/src/pexprs-main.js", "../../../node_modules/ohm-js/src/errors.js", "../../../node_modules/ohm-js/src/util.js", "../../../node_modules/ohm-js/src/Interval.js", "../../../node_modules/ohm-js/src/InputStream.js", "../../../node_modules/ohm-js/src/MatchResult.js", "../../../node_modules/ohm-js/src/PosInfo.js", "../../../node_modules/ohm-js/src/Trace.js", "../../../node_modules/ohm-js/src/pexprs-allowsSkippingPrecedingSpace.js", "../../../node_modules/ohm-js/src/pexprs-assertAllApplicationsAreValid.js", "../../../node_modules/ohm-js/src/pexprs-assertChoicesHaveUniformArity.js", "../../../node_modules/ohm-js/src/pexprs-assertIteratedExprsAreNotNullable.js", "../../../node_modules/ohm-js/src/nodes.js", "../../../node_modules/ohm-js/src/pexprs-eval.js", "../../../node_modules/ohm-js/src/pexprs-getArity.js", "../../../node_modules/ohm-js/src/pexprs-outputRecipe.js", "../../../node_modules/ohm-js/src/pexprs-introduceParams.js", "../../../node_modules/ohm-js/src/pexprs-isNullable.js", "../../../node_modules/ohm-js/src/pexprs-substituteParams.js", "../../../node_modules/ohm-js/src/pexprs-toArgumentNameList.js", "../../../node_modules/ohm-js/src/pexprs-toDisplayString.js", "../../../node_modules/ohm-js/src/Failure.js", "../../../node_modules/ohm-js/src/pexprs-toFailure.js", "../../../node_modules/ohm-js/src/pexprs-toString.js", "../../../node_modules/ohm-js/src/CaseInsensitiveTerminal.js", "../../../node_modules/ohm-js/src/pexprs.js", "../../../node_modules/ohm-js/src/MatchState.js", "../../../node_modules/ohm-js/src/Matcher.js", "../../../node_modules/ohm-js/src/Semantics.js", "../../../node_modules/ohm-js/src/Grammar.js", "../../../node_modules/ohm-js/src/GrammarDecl.js", "../../../node_modules/ohm-js/src/Builder.js", "../../../node_modules/ohm-js/src/makeRecipe.js", "../../../node_modules/ohm-js/dist/built-in-rules.js", "../../../node_modules/ohm-js/src/main-kernel.js", "../../../node_modules/ohm-js/dist/ohm-grammar.js", "../../../node_modules/ohm-js/src/buildGrammar.js", "../../../node_modules/ohm-js/dist/operations-and-attributes.js", "../../../node_modules/ohm-js/src/semanticsDeferredInit.js", "../../../node_modules/ohm-js/src/findIndentation.js", "../../../node_modules/ohm-js/src/IndentationSensitive.js", "../../../node_modules/ohm-js/src/version.js", "../../../node_modules/ohm-js/src/main.js", "../src/shimmed-gram-parser.js", "../../compiler/dist/units.js", "../../compiler/dist/ingredient_db.js", "../../compiler/dist/mass_normalization.js", "../../compiler/dist/utils.js", "../../compiler/dist/graph.js", "../../compiler/dist/shopping.js", "../../compiler/dist/index.js", "../src/app.js"],
  "sourcesContent": ["// --------------------------------------------------------------------\n// Private Stuff\n// --------------------------------------------------------------------\n\n// Helpers\n\nconst escapeStringFor = {};\nfor (let c = 0; c < 128; c++) {\n  escapeStringFor[c] = String.fromCharCode(c);\n}\nescapeStringFor[\"'\".charCodeAt(0)] = \"\\\\'\";\nescapeStringFor['\"'.charCodeAt(0)] = '\\\\\"';\nescapeStringFor['\\\\'.charCodeAt(0)] = '\\\\\\\\';\nescapeStringFor['\\b'.charCodeAt(0)] = '\\\\b';\nescapeStringFor['\\f'.charCodeAt(0)] = '\\\\f';\nescapeStringFor['\\n'.charCodeAt(0)] = '\\\\n';\nescapeStringFor['\\r'.charCodeAt(0)] = '\\\\r';\nescapeStringFor['\\t'.charCodeAt(0)] = '\\\\t';\nescapeStringFor['\\u000b'.charCodeAt(0)] = '\\\\v';\n\n// --------------------------------------------------------------------\n// Exports\n// --------------------------------------------------------------------\n\nexport function abstract(optMethodName) {\n  const methodName = optMethodName || '';\n  return function () {\n    throw new Error(\n      'this method ' +\n        methodName +\n        ' is abstract! ' +\n        '(it has no implementation in class ' +\n        this.constructor.name +\n        ')'\n    );\n  };\n}\n\nexport function assert(cond, message) {\n  if (!cond) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n\n// Define a lazily-computed, non-enumerable property named `propName`\n// on the object `obj`. `getterFn` will be called to compute the value the\n// first time the property is accessed.\nexport function defineLazyProperty(obj, propName, getterFn) {\n  let memo;\n  Object.defineProperty(obj, propName, {\n    get() {\n      if (!memo) {\n        memo = getterFn.call(this);\n      }\n      return memo;\n    },\n  });\n}\n\nexport function clone(obj) {\n  if (obj) {\n    return Object.assign({}, obj);\n  }\n  return obj;\n}\n\nexport function repeatFn(fn, n) {\n  const arr = [];\n  while (n-- > 0) {\n    arr.push(fn());\n  }\n  return arr;\n}\n\nexport function repeatStr(str, n) {\n  return new Array(n + 1).join(str);\n}\n\nexport function repeat(x, n) {\n  return repeatFn(() => x, n);\n}\n\nexport function getDuplicates(array) {\n  const duplicates = [];\n  for (let idx = 0; idx < array.length; idx++) {\n    const x = array[idx];\n    if (array.lastIndexOf(x) !== idx && duplicates.indexOf(x) < 0) {\n      duplicates.push(x);\n    }\n  }\n  return duplicates;\n}\n\nexport function copyWithoutDuplicates(array) {\n  const noDuplicates = [];\n  array.forEach(entry => {\n    if (noDuplicates.indexOf(entry) < 0) {\n      noDuplicates.push(entry);\n    }\n  });\n  return noDuplicates;\n}\n\nexport function isSyntactic(ruleName) {\n  const firstChar = ruleName[0];\n  return firstChar === firstChar.toUpperCase();\n}\n\nexport function isLexical(ruleName) {\n  return !isSyntactic(ruleName);\n}\n\nexport function padLeft(str, len, optChar) {\n  const ch = optChar || ' ';\n  if (str.length < len) {\n    return repeatStr(ch, len - str.length) + str;\n  }\n  return str;\n}\n\n// StringBuffer\n\nexport function StringBuffer() {\n  this.strings = [];\n}\n\nStringBuffer.prototype.append = function (str) {\n  this.strings.push(str);\n};\n\nStringBuffer.prototype.contents = function () {\n  return this.strings.join('');\n};\n\nconst escapeUnicode = str => String.fromCodePoint(parseInt(str, 16));\n\nexport function unescapeCodePoint(s) {\n  if (s.charAt(0) === '\\\\') {\n    switch (s.charAt(1)) {\n      case 'b':\n        return '\\b';\n      case 'f':\n        return '\\f';\n      case 'n':\n        return '\\n';\n      case 'r':\n        return '\\r';\n      case 't':\n        return '\\t';\n      case 'v':\n        return '\\v';\n      case 'x':\n        return escapeUnicode(s.slice(2, 4));\n      case 'u':\n        return s.charAt(2) === '{'\n          ? escapeUnicode(s.slice(3, -1))\n          : escapeUnicode(s.slice(2, 6));\n      default:\n        return s.charAt(1);\n    }\n  } else {\n    return s;\n  }\n}\n\n// Helper for producing a description of an unknown object in a safe way.\n// Especially useful for error messages where an unexpected type of object was encountered.\nexport function unexpectedObjToString(obj) {\n  if (obj == null) {\n    return String(obj);\n  }\n  const baseToString = Object.prototype.toString.call(obj);\n  try {\n    let typeName;\n    if (obj.constructor && obj.constructor.name) {\n      typeName = obj.constructor.name;\n    } else if (baseToString.indexOf('[object ') === 0) {\n      typeName = baseToString.slice(8, -1); // Extract e.g. \"Array\" from \"[object Array]\".\n    } else {\n      typeName = typeof obj;\n    }\n    return typeName + ': ' + JSON.stringify(String(obj));\n  } catch {\n    return baseToString;\n  }\n}\n\nexport function checkNotNull(obj, message = 'unexpected null value') {\n  if (obj == null) {\n    throw new Error(message);\n  }\n  return obj;\n}\n", "// The full list of categories from:\n// https://www.unicode.org/Public/UCD/latest/ucd/extracted/DerivedGeneralCategory.txt.\n\nconst toRegExp = val => new RegExp(String.raw`\\p{${val}}`, 'u');\n\n/*\n  grep -v '^#' DerivedGeneralCategory.txt \\\n    | cut -d';' -f2 \\\n    | awk 'NF{print $1}' \\\n    | sort -u \\\n    | awk '{printf \"\\x27%s\\x27,\\n\",$1}'\n */\n\nexport const UnicodeCategories = Object.fromEntries(\n  [\n    'Cc',\n    'Cf',\n    'Cn',\n    'Co',\n    'Cs',\n    'Ll',\n    'Lm',\n    'Lo',\n    'Lt',\n    'Lu',\n    'Mc',\n    'Me',\n    'Mn',\n    'Nd',\n    'Nl',\n    'No',\n    'Pc',\n    'Pd',\n    'Pe',\n    'Pf',\n    'Pi',\n    'Po',\n    'Ps',\n    'Sc',\n    'Sk',\n    'Sm',\n    'So',\n    'Zl',\n    'Zp',\n    'Zs',\n  ].map(cat => [cat, toRegExp(cat)])\n);\nUnicodeCategories['Ltmo'] = /\\p{Lt}|\\p{Lm}|\\p{Lo}/u;\n\n// We only support a few of these for now, but could add more later.\n// See https://www.unicode.org/Public/UCD/latest/ucd/PropertyAliases.txt\nexport const UnicodeBinaryProperties = Object.fromEntries(\n  ['XID_Start', 'XID_Continue', 'White_Space'].map(prop => [prop, toRegExp(prop)])\n);\n", "import {UnicodeBinaryProperties, UnicodeCategories} from './unicode.js';\nimport * as common from './common.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\n// General stuff\n\nexport class PExpr {\n  constructor() {\n    if (this.constructor === PExpr) {\n      throw new Error(\"PExpr cannot be instantiated -- it's abstract\");\n    }\n  }\n\n  // Set the `source` property to the interval containing the source for this expression.\n  withSource(interval) {\n    if (interval) {\n      this.source = interval.trimmed();\n    }\n    return this;\n  }\n}\n\n// Any\n\nexport const any = Object.create(PExpr.prototype);\n\n// End\n\nexport const end = Object.create(PExpr.prototype);\n\n// Terminals\n\nexport class Terminal extends PExpr {\n  constructor(obj) {\n    super();\n    this.obj = obj;\n  }\n}\n\n// Ranges\n\nexport class Range extends PExpr {\n  constructor(from, to) {\n    super();\n    this.from = from;\n    this.to = to;\n    // If either `from` or `to` is made up of multiple code units, then\n    // the range should consume a full code point, not a single code unit.\n    this.matchCodePoint = from.length > 1 || to.length > 1;\n  }\n}\n\n// Parameters\n\nexport class Param extends PExpr {\n  constructor(index) {\n    super();\n    this.index = index;\n  }\n}\n\n// Alternation\n\nexport class Alt extends PExpr {\n  constructor(terms) {\n    super();\n    this.terms = terms;\n  }\n}\n\n// Extend is an implementation detail of rule extension\n\nexport class Extend extends Alt {\n  constructor(superGrammar, name, body) {\n    const origBody = superGrammar.rules[name].body;\n    super([body, origBody]);\n\n    this.superGrammar = superGrammar;\n    this.name = name;\n    this.body = body;\n  }\n}\n\n// Splice is an implementation detail of rule overriding with the `...` operator.\nexport class Splice extends Alt {\n  constructor(superGrammar, ruleName, beforeTerms, afterTerms) {\n    const origBody = superGrammar.rules[ruleName].body;\n    super([...beforeTerms, origBody, ...afterTerms]);\n\n    this.superGrammar = superGrammar;\n    this.ruleName = ruleName;\n    this.expansionPos = beforeTerms.length;\n  }\n}\n\n// Sequences\n\nexport class Seq extends PExpr {\n  constructor(factors) {\n    super();\n    this.factors = factors;\n  }\n}\n\n// Iterators and optionals\n\nexport class Iter extends PExpr {\n  constructor(expr) {\n    super();\n    this.expr = expr;\n  }\n}\n\nexport class Star extends Iter {}\nexport class Plus extends Iter {}\nexport class Opt extends Iter {}\n\nStar.prototype.operator = '*';\nPlus.prototype.operator = '+';\nOpt.prototype.operator = '?';\n\nStar.prototype.minNumMatches = 0;\nPlus.prototype.minNumMatches = 1;\nOpt.prototype.minNumMatches = 0;\n\nStar.prototype.maxNumMatches = Number.POSITIVE_INFINITY;\nPlus.prototype.maxNumMatches = Number.POSITIVE_INFINITY;\nOpt.prototype.maxNumMatches = 1;\n\n// Predicates\n\nexport class Not extends PExpr {\n  constructor(expr) {\n    super();\n    this.expr = expr;\n  }\n}\n\nexport class Lookahead extends PExpr {\n  constructor(expr) {\n    super();\n    this.expr = expr;\n  }\n}\n\n// \"Lexification\"\n\nexport class Lex extends PExpr {\n  constructor(expr) {\n    super();\n    this.expr = expr;\n  }\n}\n\n// Rule application\n\nexport class Apply extends PExpr {\n  constructor(ruleName, args = []) {\n    super();\n    this.ruleName = ruleName;\n    this.args = args;\n  }\n\n  isSyntactic() {\n    return common.isSyntactic(this.ruleName);\n  }\n\n  // This method just caches the result of `this.toString()` in a non-enumerable property.\n  toMemoKey() {\n    if (!this._memoKey) {\n      Object.defineProperty(this, '_memoKey', {value: this.toString()});\n    }\n    return this._memoKey;\n  }\n}\n\n// Unicode character\n\nexport class UnicodeChar extends PExpr {\n  constructor(categoryOrProp) {\n    super();\n    this.categoryOrProp = categoryOrProp;\n    if (categoryOrProp in UnicodeCategories) {\n      this.pattern = UnicodeCategories[categoryOrProp];\n    } else if (categoryOrProp in UnicodeBinaryProperties) {\n      this.pattern = UnicodeBinaryProperties[categoryOrProp];\n    } else {\n      throw new Error(\n        `Invalid Unicode category or property name: ${JSON.stringify(categoryOrProp)}`\n      );\n    }\n  }\n}\n", "import {assert} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nexport function createError(message, optInterval) {\n  let e;\n  if (optInterval) {\n    e = new Error(optInterval.getLineAndColumnMessage() + message);\n    e.shortMessage = message;\n    e.interval = optInterval;\n  } else {\n    e = new Error(message);\n  }\n  return e;\n}\n\n// ----------------- errors about intervals -----------------\n\nexport function intervalSourcesDontMatch() {\n  return createError(\"Interval sources don't match\");\n}\n\n// ----------------- errors about grammars -----------------\n\n// Grammar syntax error\n\nexport function grammarSyntaxError(matchFailure) {\n  const e = new Error();\n  Object.defineProperty(e, 'message', {\n    enumerable: true,\n    get() {\n      return matchFailure.message;\n    },\n  });\n  Object.defineProperty(e, 'shortMessage', {\n    enumerable: true,\n    get() {\n      return 'Expected ' + matchFailure.getExpectedText();\n    },\n  });\n  e.interval = matchFailure.getInterval();\n  return e;\n}\n\n// Undeclared grammar\n\nexport function undeclaredGrammar(grammarName, namespace, interval) {\n  const message = namespace\n    ? `Grammar ${grammarName} is not declared in namespace '${namespace}'`\n    : 'Undeclared grammar ' + grammarName;\n  return createError(message, interval);\n}\n\n// Duplicate grammar declaration\n\nexport function duplicateGrammarDeclaration(grammar, namespace) {\n  return createError('Grammar ' + grammar.name + ' is already declared in this namespace');\n}\n\nexport function grammarDoesNotSupportIncrementalParsing(grammar) {\n  return createError(`Grammar '${grammar.name}' does not support incremental parsing`);\n}\n\n// ----------------- rules -----------------\n\n// Undeclared rule\n\nexport function undeclaredRule(ruleName, grammarName, optInterval) {\n  return createError(\n    'Rule ' + ruleName + ' is not declared in grammar ' + grammarName,\n    optInterval\n  );\n}\n\n// Cannot override undeclared rule\n\nexport function cannotOverrideUndeclaredRule(ruleName, grammarName, optSource) {\n  return createError(\n    'Cannot override rule ' + ruleName + ' because it is not declared in ' + grammarName,\n    optSource\n  );\n}\n\n// Cannot extend undeclared rule\n\nexport function cannotExtendUndeclaredRule(ruleName, grammarName, optSource) {\n  return createError(\n    'Cannot extend rule ' + ruleName + ' because it is not declared in ' + grammarName,\n    optSource\n  );\n}\n\n// Duplicate rule declaration\n\nexport function duplicateRuleDeclaration(ruleName, grammarName, declGrammarName, optSource) {\n  let message =\n    \"Duplicate declaration for rule '\" + ruleName + \"' in grammar '\" + grammarName + \"'\";\n  if (grammarName !== declGrammarName) {\n    message += \" (originally declared in '\" + declGrammarName + \"')\";\n  }\n  return createError(message, optSource);\n}\n\n// Wrong number of parameters\n\nexport function wrongNumberOfParameters(ruleName, expected, actual, source) {\n  return createError(\n    'Wrong number of parameters for rule ' +\n      ruleName +\n      ' (expected ' +\n      expected +\n      ', got ' +\n      actual +\n      ')',\n    source\n  );\n}\n\n// Wrong number of arguments\n\nexport function wrongNumberOfArguments(ruleName, expected, actual, expr) {\n  return createError(\n    'Wrong number of arguments for rule ' +\n      ruleName +\n      ' (expected ' +\n      expected +\n      ', got ' +\n      actual +\n      ')',\n    expr\n  );\n}\n\n// Duplicate parameter names\n\nexport function duplicateParameterNames(ruleName, duplicates, source) {\n  return createError(\n    'Duplicate parameter names in rule ' + ruleName + ': ' + duplicates.join(', '),\n    source\n  );\n}\n\n// Invalid parameter expression\n\nexport function invalidParameter(ruleName, expr) {\n  return createError(\n    'Invalid parameter to rule ' +\n      ruleName +\n      ': ' +\n      expr +\n      ' has arity ' +\n      expr.getArity() +\n      ', but parameter expressions must have arity 1',\n    expr.source\n  );\n}\n\n// Application of syntactic rule from lexical rule\n\nconst syntacticVsLexicalNote =\n  'NOTE: A _syntactic rule_ is a rule whose name begins with a capital letter. ' +\n  'See https://ohmjs.org/d/svl for more details.';\n\nexport function applicationOfSyntacticRuleFromLexicalContext(ruleName, applyExpr) {\n  return createError(\n    'Cannot apply syntactic rule ' + ruleName + ' from here (inside a lexical context)',\n    applyExpr.source\n  );\n}\n\n// Lexical rule application used with applySyntactic\n\nexport function applySyntacticWithLexicalRuleApplication(applyExpr) {\n  const {ruleName} = applyExpr;\n  return createError(\n    `applySyntactic is for syntactic rules, but '${ruleName}' is a lexical rule. ` +\n      syntacticVsLexicalNote,\n    applyExpr.source\n  );\n}\n\n// Application of applySyntactic in a syntactic context\n\nexport function unnecessaryExperimentalApplySyntactic(applyExpr) {\n  return createError(\n    'applySyntactic is not required here (in a syntactic context)',\n    applyExpr.source\n  );\n}\n\n// Incorrect argument type\n\nexport function incorrectArgumentType(expectedType, expr) {\n  return createError('Incorrect argument type: expected ' + expectedType, expr.source);\n}\n\n// Multiple instances of the super-splice operator (`...`) in the rule body.\n\nexport function multipleSuperSplices(expr) {\n  return createError(\"'...' can appear at most once in a rule body\", expr.source);\n}\n\n// Unicode code point escapes\n\nexport function invalidCodePoint(applyWrapper) {\n  const node = applyWrapper._node;\n  assert(node && node.isNonterminal() && node.ctorName === 'escapeChar_unicodeCodePoint');\n\n  // Get an interval that covers all of the hex digits.\n  const digitIntervals = applyWrapper.children.slice(1, -1).map(d => d.source);\n  const fullInterval = digitIntervals[0].coverageWith(...digitIntervals.slice(1));\n  return createError(\n    `U+${fullInterval.contents} is not a valid Unicode code point`,\n    fullInterval\n  );\n}\n\n// ----------------- Kleene operators -----------------\n\nexport function kleeneExprHasNullableOperand(kleeneExpr, applicationStack) {\n  const actuals =\n    applicationStack.length > 0 ? applicationStack[applicationStack.length - 1].args : [];\n  const expr = kleeneExpr.expr.substituteParams(actuals);\n  let message =\n    'Nullable expression ' +\n    expr +\n    \" is not allowed inside '\" +\n    kleeneExpr.operator +\n    \"' (possible infinite loop)\";\n  if (applicationStack.length > 0) {\n    const stackTrace = applicationStack\n      .map(app => new pexprs.Apply(app.ruleName, app.args))\n      .join('\\n');\n    message += '\\nApplication stack (most recent application last):\\n' + stackTrace;\n  }\n  return createError(message, kleeneExpr.expr.source);\n}\n\n// ----------------- arity -----------------\n\nexport function inconsistentArity(ruleName, expected, actual, expr) {\n  return createError(\n    'Rule ' +\n      ruleName +\n      ' involves an alternation which has inconsistent arity ' +\n      '(expected ' +\n      expected +\n      ', got ' +\n      actual +\n      ')',\n    expr.source\n  );\n}\n\n// ----------------- properties -----------------\n\nexport function duplicatePropertyNames(duplicates) {\n  return createError('Object pattern has duplicate property names: ' + duplicates.join(', '));\n}\n\n// ----------------- constructors -----------------\n\nexport function invalidConstructorCall(grammar, ctorName, children) {\n  return createError(\n    'Attempt to invoke constructor ' + ctorName + ' with invalid or unexpected arguments'\n  );\n}\n\n// ----------------- convenience -----------------\n\nexport function multipleErrors(errors) {\n  const messages = errors.map(e => e.message);\n  return createError(['Errors:'].concat(messages).join('\\n- '), errors[0].interval);\n}\n\n// ----------------- semantic -----------------\n\nexport function missingSemanticAction(ctorName, name, type, stack) {\n  let stackTrace = stack\n    .slice(0, -1)\n    .map(info => {\n      const ans = '  ' + info[0].name + ' > ' + info[1];\n      return info.length === 3 ? ans + \" for '\" + info[2] + \"'\" : ans;\n    })\n    .join('\\n');\n  stackTrace += '\\n  ' + name + ' > ' + ctorName;\n\n  let moreInfo = '';\n  if (ctorName === '_iter') {\n    moreInfo = [\n      '\\nNOTE: as of Ohm v16, there is no default action for iteration nodes — see ',\n      '  https://ohmjs.org/d/dsa for details.',\n    ].join('\\n');\n  }\n\n  const message = [\n    `Missing semantic action for '${ctorName}' in ${type} '${name}'.${moreInfo}`,\n    'Action stack (most recent call last):',\n    stackTrace,\n  ].join('\\n');\n\n  const e = createError(message);\n  e.name = 'missingSemanticAction';\n  return e;\n}\n\nexport function throwErrors(errors) {\n  if (errors.length === 1) {\n    throw errors[0];\n  }\n  if (errors.length > 1) {\n    throw multipleErrors(errors);\n  }\n}\n", "import * as common from './common.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\n// Given an array of numbers `arr`, return an array of the numbers as strings,\n// right-justified and padded to the same length.\nfunction padNumbersToEqualLength(arr) {\n  let maxLen = 0;\n  const strings = arr.map(n => {\n    const str = n.toString();\n    maxLen = Math.max(maxLen, str.length);\n    return str;\n  });\n  return strings.map(s => common.padLeft(s, maxLen));\n}\n\n// Produce a new string that would be the result of copying the contents\n// of the string `src` onto `dest` at offset `offest`.\nfunction strcpy(dest, src, offset) {\n  const origDestLen = dest.length;\n  const start = dest.slice(0, offset);\n  const end = dest.slice(offset + src.length);\n  return (start + src + end).substr(0, origDestLen);\n}\n\n// Casts the underlying lineAndCol object to a formatted message string,\n// highlighting `ranges`.\nfunction lineAndColumnToMessage(...ranges) {\n  const lineAndCol = this;\n  const {offset} = lineAndCol;\n  const {repeatStr} = common;\n\n  const sb = new common.StringBuffer();\n  sb.append('Line ' + lineAndCol.lineNum + ', col ' + lineAndCol.colNum + ':\\n');\n\n  // An array of the previous, current, and next line numbers as strings of equal length.\n  const lineNumbers = padNumbersToEqualLength([\n    lineAndCol.prevLine == null ? 0 : lineAndCol.lineNum - 1,\n    lineAndCol.lineNum,\n    lineAndCol.nextLine == null ? 0 : lineAndCol.lineNum + 1,\n  ]);\n\n  // Helper for appending formatting input lines to the buffer.\n  const appendLine = (num, content, prefix) => {\n    sb.append(prefix + lineNumbers[num] + ' | ' + content + '\\n');\n  };\n\n  // Include the previous line for context if possible.\n  if (lineAndCol.prevLine != null) {\n    appendLine(0, lineAndCol.prevLine, '  ');\n  }\n  // Line that the error occurred on.\n  appendLine(1, lineAndCol.line, '> ');\n\n  // Build up the line that points to the offset and possible indicates one or more ranges.\n  // Start with a blank line, and indicate each range by overlaying a string of `~` chars.\n  const lineLen = lineAndCol.line.length;\n  let indicationLine = repeatStr(' ', lineLen + 1);\n  for (let i = 0; i < ranges.length; ++i) {\n    let startIdx = ranges[i][0];\n    let endIdx = ranges[i][1];\n    common.assert(startIdx >= 0 && startIdx <= endIdx, 'range start must be >= 0 and <= end');\n\n    const lineStartOffset = offset - lineAndCol.colNum + 1;\n    startIdx = Math.max(0, startIdx - lineStartOffset);\n    endIdx = Math.min(endIdx - lineStartOffset, lineLen);\n\n    indicationLine = strcpy(indicationLine, repeatStr('~', endIdx - startIdx), startIdx);\n  }\n  const gutterWidth = 2 + lineNumbers[1].length + 3;\n  sb.append(repeatStr(' ', gutterWidth));\n  indicationLine = strcpy(indicationLine, '^', lineAndCol.colNum - 1);\n  sb.append(indicationLine.replace(/ +$/, '') + '\\n');\n\n  // Include the next line for context if possible.\n  if (lineAndCol.nextLine != null) {\n    appendLine(2, lineAndCol.nextLine, '  ');\n  }\n  return sb.contents();\n}\n\n// --------------------------------------------------------------------\n// Exports\n// --------------------------------------------------------------------\n\nlet builtInRulesCallbacks = [];\n\n// Since Grammar.BuiltInRules is bootstrapped, most of Ohm can't directly depend it.\n// This function allows modules that do depend on the built-in rules to register a callback\n// that will be called later in the initialization process.\nexport function awaitBuiltInRules(cb) {\n  builtInRulesCallbacks.push(cb);\n}\n\nexport function announceBuiltInRules(grammar) {\n  builtInRulesCallbacks.forEach(cb => {\n    cb(grammar);\n  });\n  builtInRulesCallbacks = null;\n}\n\n// Return an object with the line and column information for the given\n// offset in `str`.\nexport function getLineAndColumn(str, offset) {\n  let lineNum = 1;\n  let colNum = 1;\n\n  let currOffset = 0;\n  let lineStartOffset = 0;\n\n  let nextLine = null;\n  let prevLine = null;\n  let prevLineStartOffset = -1;\n\n  while (currOffset < offset) {\n    const c = str.charAt(currOffset++);\n    if (c === '\\n') {\n      lineNum++;\n      colNum = 1;\n      prevLineStartOffset = lineStartOffset;\n      lineStartOffset = currOffset;\n    } else if (c !== '\\r') {\n      colNum++;\n    }\n  }\n\n  // Find the end of the target line.\n  let lineEndOffset = str.indexOf('\\n', lineStartOffset);\n  if (lineEndOffset === -1) {\n    lineEndOffset = str.length;\n  } else {\n    // Get the next line.\n    const nextLineEndOffset = str.indexOf('\\n', lineEndOffset + 1);\n    nextLine =\n      nextLineEndOffset === -1\n        ? str.slice(lineEndOffset)\n        : str.slice(lineEndOffset, nextLineEndOffset);\n    // Strip leading and trailing EOL char(s).\n    nextLine = nextLine.replace(/^\\r?\\n/, '').replace(/\\r$/, '');\n  }\n\n  // Get the previous line.\n  if (prevLineStartOffset >= 0) {\n    // Strip trailing EOL char(s).\n    prevLine = str.slice(prevLineStartOffset, lineStartOffset).replace(/\\r?\\n$/, '');\n  }\n\n  // Get the target line, stripping a trailing carriage return if necessary.\n  const line = str.slice(lineStartOffset, lineEndOffset).replace(/\\r$/, '');\n\n  return {\n    offset,\n    lineNum,\n    colNum,\n    line,\n    prevLine,\n    nextLine,\n    toString: lineAndColumnToMessage,\n  };\n}\n\n// Return a nicely-formatted string describing the line and column for the\n// given offset in `str` highlighting `ranges`.\nexport function getLineAndColumnMessage(str, offset, ...ranges) {\n  return getLineAndColumn(str, offset).toString(...ranges);\n}\n\nexport const uniqueId = (() => {\n  let idCounter = 0;\n  return prefix => '' + prefix + idCounter++;\n})();\n", "import {assert} from './common.js';\nimport * as errors from './errors.js';\nimport * as util from './util.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nexport class Interval {\n  constructor(sourceString, startIdx, endIdx) {\n    // Store the full source in a non-enumerable property, so that when\n    // grammars and other objects are printed in the REPL, it's not\n    // cluttered with multiple copies of the same long string.\n    Object.defineProperty(this, '_sourceString', {\n      value: sourceString,\n      configurable: false,\n      enumerable: false,\n      writable: false,\n    });\n    this.startIdx = startIdx;\n    this.endIdx = endIdx;\n  }\n\n  get sourceString() {\n    return this._sourceString;\n  }\n\n  get contents() {\n    if (this._contents === undefined) {\n      this._contents = this.sourceString.slice(this.startIdx, this.endIdx);\n    }\n    return this._contents;\n  }\n\n  get length() {\n    return this.endIdx - this.startIdx;\n  }\n\n  coverageWith(...intervals) {\n    return Interval.coverage(...intervals, this);\n  }\n\n  collapsedLeft() {\n    return new Interval(this.sourceString, this.startIdx, this.startIdx);\n  }\n\n  collapsedRight() {\n    return new Interval(this.sourceString, this.endIdx, this.endIdx);\n  }\n\n  getLineAndColumn() {\n    return util.getLineAndColumn(this.sourceString, this.startIdx);\n  }\n\n  getLineAndColumnMessage() {\n    const range = [this.startIdx, this.endIdx];\n    return util.getLineAndColumnMessage(this.sourceString, this.startIdx, range);\n  }\n\n  // Returns an array of 0, 1, or 2 intervals that represents the result of the\n  // interval difference operation.\n  minus(that) {\n    if (this.sourceString !== that.sourceString) {\n      throw errors.intervalSourcesDontMatch();\n    } else if (this.startIdx === that.startIdx && this.endIdx === that.endIdx) {\n      // `this` and `that` are the same interval!\n      return [];\n    } else if (this.startIdx < that.startIdx && that.endIdx < this.endIdx) {\n      // `that` splits `this` into two intervals\n      return [\n        new Interval(this.sourceString, this.startIdx, that.startIdx),\n        new Interval(this.sourceString, that.endIdx, this.endIdx),\n      ];\n    } else if (this.startIdx < that.endIdx && that.endIdx < this.endIdx) {\n      // `that` contains a prefix of `this`\n      return [new Interval(this.sourceString, that.endIdx, this.endIdx)];\n    } else if (this.startIdx < that.startIdx && that.startIdx < this.endIdx) {\n      // `that` contains a suffix of `this`\n      return [new Interval(this.sourceString, this.startIdx, that.startIdx)];\n    } else {\n      // `that` and `this` do not overlap\n      return [this];\n    }\n  }\n\n  // Returns a new Interval that has the same extent as this one, but which is relative\n  // to `that`, an Interval that fully covers this one.\n  relativeTo(that) {\n    if (this.sourceString !== that.sourceString) {\n      throw errors.intervalSourcesDontMatch();\n    }\n    assert(\n      this.startIdx >= that.startIdx && this.endIdx <= that.endIdx,\n      'other interval does not cover this one'\n    );\n    return new Interval(\n      this.sourceString,\n      this.startIdx - that.startIdx,\n      this.endIdx - that.startIdx\n    );\n  }\n\n  // Returns a new Interval which contains the same contents as this one,\n  // but with whitespace trimmed from both ends.\n  trimmed() {\n    const {contents} = this;\n    const startIdx = this.startIdx + contents.match(/^\\s*/)[0].length;\n    const endIdx = this.endIdx - contents.match(/\\s*$/)[0].length;\n    return new Interval(this.sourceString, startIdx, endIdx);\n  }\n\n  subInterval(offset, len) {\n    const newStartIdx = this.startIdx + offset;\n    return new Interval(this.sourceString, newStartIdx, newStartIdx + len);\n  }\n}\n\nInterval.coverage = function (firstInterval, ...intervals) {\n  let {startIdx, endIdx} = firstInterval;\n  for (const interval of intervals) {\n    if (interval.sourceString !== firstInterval.sourceString) {\n      throw errors.intervalSourcesDontMatch();\n    } else {\n      startIdx = Math.min(startIdx, interval.startIdx);\n      endIdx = Math.max(endIdx, interval.endIdx);\n    }\n  }\n  return new Interval(firstInterval.sourceString, startIdx, endIdx);\n};\n", "import {Interval} from './Interval.js';\n\nconst MAX_CHAR_CODE = 0xffff;\nexport const MAX_CODE_POINT = 0x10ffff;\n\nexport class InputStream {\n  constructor(source) {\n    this.source = source;\n    this.pos = 0;\n    this.examinedLength = 0;\n  }\n\n  atEnd() {\n    const ans = this.pos >= this.source.length;\n    this.examinedLength = Math.max(this.examinedLength, this.pos + 1);\n    return ans;\n  }\n\n  next() {\n    const ans = this.source[this.pos++];\n    this.examinedLength = Math.max(this.examinedLength, this.pos);\n    return ans;\n  }\n\n  nextCharCode() {\n    const nextChar = this.next();\n    return nextChar && nextChar.charCodeAt(0);\n  }\n\n  nextCodePoint() {\n    const cp = this.source.slice(this.pos++).codePointAt(0);\n    // If the code point is beyond plane 0, it takes up two characters.\n    if (cp > MAX_CHAR_CODE) {\n      this.pos += 1;\n    }\n    this.examinedLength = Math.max(this.examinedLength, this.pos);\n    return cp;\n  }\n\n  matchString(s, optIgnoreCase) {\n    let idx;\n    if (optIgnoreCase) {\n      /*\n        Case-insensitive comparison is a tricky business. Some notable gotchas include the\n        \"Turkish I\" problem (http://www.i18nguy.com/unicode/turkish-i18n.html) and the fact\n        that the German Esszet (ß) turns into \"SS\" in upper case.\n\n        This is intended to be a locale-invariant comparison, which means it may not obey\n        locale-specific expectations (e.g. \"i\" => \"İ\").\n\n        See also https://unicode.org/faq/casemap_charprop.html#casemap\n       */\n      for (idx = 0; idx < s.length; idx++) {\n        const actual = this.next();\n        const expected = s[idx];\n        if (actual == null || actual.toUpperCase() !== expected.toUpperCase()) {\n          return false;\n        }\n      }\n      return true;\n    }\n    // Default is case-sensitive comparison.\n    for (idx = 0; idx < s.length; idx++) {\n      if (this.next() !== s[idx]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  sourceSlice(startIdx, endIdx) {\n    return this.source.slice(startIdx, endIdx);\n  }\n\n  interval(startIdx, optEndIdx) {\n    return new Interval(this.source, startIdx, optEndIdx ? optEndIdx : this.pos);\n  }\n}\n", "import * as common from './common.js';\nimport * as util from './util.js';\nimport {Interval} from './Interval.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nexport class MatchResult {\n  constructor(\n    matcher,\n    input,\n    startExpr,\n    cst,\n    cstOffset,\n    rightmostFailurePosition,\n    optRecordedFailures\n  ) {\n    this.matcher = matcher;\n    this.input = input;\n    this.startExpr = startExpr;\n    this._cst = cst;\n    this._cstOffset = cstOffset;\n    this._rightmostFailurePosition = rightmostFailurePosition;\n    this._rightmostFailures = optRecordedFailures;\n\n    if (this.failed()) {\n      common.defineLazyProperty(this, 'message', function () {\n        const detail = 'Expected ' + this.getExpectedText();\n        return (\n          util.getLineAndColumnMessage(this.input, this.getRightmostFailurePosition()) + detail\n        );\n      });\n      common.defineLazyProperty(this, 'shortMessage', function () {\n        const detail = 'expected ' + this.getExpectedText();\n        const errorInfo = util.getLineAndColumn(\n          this.input,\n          this.getRightmostFailurePosition()\n        );\n        return 'Line ' + errorInfo.lineNum + ', col ' + errorInfo.colNum + ': ' + detail;\n      });\n    }\n  }\n\n  succeeded() {\n    return !!this._cst;\n  }\n\n  failed() {\n    return !this.succeeded();\n  }\n\n  getRightmostFailurePosition() {\n    return this._rightmostFailurePosition;\n  }\n\n  getRightmostFailures() {\n    if (!this._rightmostFailures) {\n      this.matcher.setInput(this.input);\n      const matchResultWithFailures = this.matcher._match(this.startExpr, {\n        tracing: false,\n        positionToRecordFailures: this.getRightmostFailurePosition(),\n      });\n      this._rightmostFailures = matchResultWithFailures.getRightmostFailures();\n    }\n    return this._rightmostFailures;\n  }\n\n  toString() {\n    return this.succeeded()\n      ? '[match succeeded]'\n      : '[match failed at position ' + this.getRightmostFailurePosition() + ']';\n  }\n\n  // Return a string summarizing the expected contents of the input stream when\n  // the match failure occurred.\n  getExpectedText() {\n    if (this.succeeded()) {\n      throw new Error('cannot get expected text of a successful MatchResult');\n    }\n\n    const sb = new common.StringBuffer();\n    let failures = this.getRightmostFailures();\n\n    // Filter out the fluffy failures to make the default error messages more useful\n    failures = failures.filter(failure => !failure.isFluffy());\n\n    for (let idx = 0; idx < failures.length; idx++) {\n      if (idx > 0) {\n        if (idx === failures.length - 1) {\n          sb.append(failures.length > 2 ? ', or ' : ' or ');\n        } else {\n          sb.append(', ');\n        }\n      }\n      sb.append(failures[idx].toString());\n    }\n    return sb.contents();\n  }\n\n  getInterval() {\n    const pos = this.getRightmostFailurePosition();\n    return new Interval(this.input, pos, pos);\n  }\n}\n", "export class PosInfo {\n  constructor() {\n    this.applicationMemoKeyStack = []; // active applications at this position\n    this.memo = {};\n    this.maxExaminedLength = 0;\n    this.maxRightmostFailureOffset = -1;\n    this.currentLeftRecursion = undefined;\n  }\n\n  isActive(application) {\n    return this.applicationMemoKeyStack.indexOf(application.toMemoKey()) >= 0;\n  }\n\n  enter(application) {\n    this.applicationMemoKeyStack.push(application.toMemoKey());\n  }\n\n  exit() {\n    this.applicationMemoKeyStack.pop();\n  }\n\n  startLeftRecursion(headApplication, memoRec) {\n    memoRec.isLeftRecursion = true;\n    memoRec.headApplication = headApplication;\n    memoRec.nextLeftRecursion = this.currentLeftRecursion;\n    this.currentLeftRecursion = memoRec;\n\n    const {applicationMemoKeyStack} = this;\n    const indexOfFirstInvolvedRule =\n      applicationMemoKeyStack.indexOf(headApplication.toMemoKey()) + 1;\n    const involvedApplicationMemoKeys = applicationMemoKeyStack.slice(\n      indexOfFirstInvolvedRule\n    );\n\n    memoRec.isInvolved = function (applicationMemoKey) {\n      return involvedApplicationMemoKeys.indexOf(applicationMemoKey) >= 0;\n    };\n\n    memoRec.updateInvolvedApplicationMemoKeys = function () {\n      for (let idx = indexOfFirstInvolvedRule; idx < applicationMemoKeyStack.length; idx++) {\n        const applicationMemoKey = applicationMemoKeyStack[idx];\n        if (!this.isInvolved(applicationMemoKey)) {\n          involvedApplicationMemoKeys.push(applicationMemoKey);\n        }\n      }\n    };\n  }\n\n  endLeftRecursion() {\n    this.currentLeftRecursion = this.currentLeftRecursion.nextLeftRecursion;\n  }\n\n  // Note: this method doesn't get called for the \"head\" of a left recursion -- for LR heads,\n  // the memoized result (which starts out being a failure) is always used.\n  shouldUseMemoizedResult(memoRec) {\n    if (!memoRec.isLeftRecursion) {\n      return true;\n    }\n    const {applicationMemoKeyStack} = this;\n    for (let idx = 0; idx < applicationMemoKeyStack.length; idx++) {\n      const applicationMemoKey = applicationMemoKeyStack[idx];\n      if (memoRec.isInvolved(applicationMemoKey)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  memoize(memoKey, memoRec) {\n    this.memo[memoKey] = memoRec;\n    this.maxExaminedLength = Math.max(this.maxExaminedLength, memoRec.examinedLength);\n    this.maxRightmostFailureOffset = Math.max(\n      this.maxRightmostFailureOffset,\n      memoRec.rightmostFailureOffset\n    );\n    return memoRec;\n  }\n\n  clearObsoleteEntries(pos, invalidatedIdx) {\n    if (pos + this.maxExaminedLength <= invalidatedIdx) {\n      // Optimization: none of the rule applications that were memoized here examined the\n      // interval of the input that changed, so nothing has to be invalidated.\n      return;\n    }\n\n    const {memo} = this;\n    this.maxExaminedLength = 0;\n    this.maxRightmostFailureOffset = -1;\n    Object.keys(memo).forEach(k => {\n      const memoRec = memo[k];\n      if (pos + memoRec.examinedLength > invalidatedIdx) {\n        delete memo[k];\n      } else {\n        this.maxExaminedLength = Math.max(this.maxExaminedLength, memoRec.examinedLength);\n        this.maxRightmostFailureOffset = Math.max(\n          this.maxRightmostFailureOffset,\n          memoRec.rightmostFailureOffset\n        );\n      }\n    });\n  }\n}\n", "import {Interval} from './Interval.js';\nimport * as common from './common.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\n// Unicode characters that are used in the `toString` output.\nconst BALLOT_X = '\\u2717';\nconst CHECK_MARK = '\\u2713';\nconst DOT_OPERATOR = '\\u22C5';\nconst RIGHTWARDS_DOUBLE_ARROW = '\\u21D2';\nconst SYMBOL_FOR_HORIZONTAL_TABULATION = '\\u2409';\nconst SYMBOL_FOR_LINE_FEED = '\\u240A';\nconst SYMBOL_FOR_CARRIAGE_RETURN = '\\u240D';\n\nconst Flags = {\n  succeeded: 1 << 0,\n  isRootNode: 1 << 1,\n  isImplicitSpaces: 1 << 2,\n  isMemoized: 1 << 3,\n  isHeadOfLeftRecursion: 1 << 4,\n  terminatesLR: 1 << 5,\n};\n\nfunction spaces(n) {\n  return common.repeat(' ', n).join('');\n}\n\n// Return a string representation of a portion of `input` at offset `pos`.\n// The result will contain exactly `len` characters.\nfunction getInputExcerpt(input, pos, len) {\n  const excerpt = asEscapedString(input.slice(pos, pos + len));\n\n  // Pad the output if necessary.\n  if (excerpt.length < len) {\n    return excerpt + common.repeat(' ', len - excerpt.length).join('');\n  }\n  return excerpt;\n}\n\nfunction asEscapedString(obj) {\n  if (typeof obj === 'string') {\n    // Replace non-printable characters with visible symbols.\n    return obj\n      .replace(/ /g, DOT_OPERATOR)\n      .replace(/\\t/g, SYMBOL_FOR_HORIZONTAL_TABULATION)\n      .replace(/\\n/g, SYMBOL_FOR_LINE_FEED)\n      .replace(/\\r/g, SYMBOL_FOR_CARRIAGE_RETURN);\n  }\n  return String(obj);\n}\n\n// ----------------- Trace -----------------\n\nexport class Trace {\n  constructor(input, pos1, pos2, expr, succeeded, bindings, optChildren) {\n    this.input = input;\n    this.pos = this.pos1 = pos1;\n    this.pos2 = pos2;\n    this.source = new Interval(input, pos1, pos2);\n    this.expr = expr;\n    this.bindings = bindings;\n    this.children = optChildren || [];\n    this.terminatingLREntry = null;\n\n    this._flags = succeeded ? Flags.succeeded : 0;\n  }\n\n  get displayString() {\n    return this.expr.toDisplayString();\n  }\n\n  clone() {\n    return this.cloneWithExpr(this.expr);\n  }\n\n  cloneWithExpr(expr) {\n    const ans = new Trace(\n      this.input,\n      this.pos,\n      this.pos2,\n      expr,\n      this.succeeded,\n      this.bindings,\n      this.children\n    );\n\n    ans.isHeadOfLeftRecursion = this.isHeadOfLeftRecursion;\n    ans.isImplicitSpaces = this.isImplicitSpaces;\n    ans.isMemoized = this.isMemoized;\n    ans.isRootNode = this.isRootNode;\n    ans.terminatesLR = this.terminatesLR;\n    ans.terminatingLREntry = this.terminatingLREntry;\n    return ans;\n  }\n\n  // Record the trace information for the terminating condition of the LR loop.\n  recordLRTermination(ruleBodyTrace, value) {\n    this.terminatingLREntry = new Trace(\n      this.input,\n      this.pos,\n      this.pos2,\n      this.expr,\n      false,\n      [value],\n      [ruleBodyTrace]\n    );\n    this.terminatingLREntry.terminatesLR = true;\n  }\n\n  // Recursively traverse this trace node and all its descendents, calling a visitor function\n  // for each node that is visited. If `vistorObjOrFn` is an object, then its 'enter' property\n  // is a function to call before visiting the children of a node, and its 'exit' property is\n  // a function to call afterwards. If `visitorObjOrFn` is a function, it represents the 'enter'\n  // function.\n  //\n  // The functions are called with three arguments: the Trace node, its parent Trace, and a number\n  // representing the depth of the node in the tree. (The root node has depth 0.) `optThisArg`, if\n  // specified, is the value to use for `this` when executing the visitor functions.\n  walk(visitorObjOrFn, optThisArg) {\n    let visitor = visitorObjOrFn;\n    if (typeof visitor === 'function') {\n      visitor = {enter: visitor};\n    }\n\n    function _walk(node, parent, depth) {\n      let recurse = true;\n      if (visitor.enter) {\n        if (visitor.enter.call(optThisArg, node, parent, depth) === Trace.prototype.SKIP) {\n          recurse = false;\n        }\n      }\n      if (recurse) {\n        node.children.forEach(child => {\n          _walk(child, node, depth + 1);\n        });\n        if (visitor.exit) {\n          visitor.exit.call(optThisArg, node, parent, depth);\n        }\n      }\n    }\n    if (this.isRootNode) {\n      // Don't visit the root node itself, only its children.\n      this.children.forEach(c => {\n        _walk(c, null, 0);\n      });\n    } else {\n      _walk(this, null, 0);\n    }\n  }\n\n  // Return a string representation of the trace.\n  // Sample:\n  //     12⋅+⋅2⋅*⋅3 ✓ exp ⇒  \"12\"\n  //     12⋅+⋅2⋅*⋅3   ✓ addExp (LR) ⇒  \"12\"\n  //     12⋅+⋅2⋅*⋅3       ✗ addExp_plus\n  toString() {\n    const sb = new common.StringBuffer();\n    this.walk((node, parent, depth) => {\n      if (!node) {\n        return this.SKIP;\n      }\n      const ctorName = node.expr.constructor.name;\n      // Don't print anything for Alt nodes.\n      if (ctorName === 'Alt') {\n        return;\n      }\n      sb.append(getInputExcerpt(node.input, node.pos, 10) + spaces(depth * 2 + 1));\n      sb.append((node.succeeded ? CHECK_MARK : BALLOT_X) + ' ' + node.displayString);\n      if (node.isHeadOfLeftRecursion) {\n        sb.append(' (LR)');\n      }\n      if (node.succeeded) {\n        const contents = asEscapedString(node.source.contents);\n        sb.append(' ' + RIGHTWARDS_DOUBLE_ARROW + '  ');\n        sb.append(typeof contents === 'string' ? '\"' + contents + '\"' : contents);\n      }\n      sb.append('\\n');\n    });\n    return sb.contents();\n  }\n}\n\n// A value that can be returned from visitor functions to indicate that a\n// node should not be recursed into.\nTrace.prototype.SKIP = {};\n\n// For convenience, create a getter and setter for the boolean flags in `Flags`.\nObject.keys(Flags).forEach(name => {\n  const mask = Flags[name];\n  Object.defineProperty(Trace.prototype, name, {\n    get() {\n      return (this._flags & mask) !== 0;\n    },\n    set(val) {\n      if (val) {\n        this._flags |= mask;\n      } else {\n        this._flags &= ~mask;\n      }\n    },\n  });\n});\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n/*\n  Return true if we should skip spaces preceding this expression in a syntactic context.\n*/\npexprs.PExpr.prototype.allowsSkippingPrecedingSpace = abstract('allowsSkippingPrecedingSpace');\n\n/*\n  Generally, these are all first-order expressions and (with the exception of Apply)\n  directly read from the input stream.\n*/\npexprs.any.allowsSkippingPrecedingSpace =\n  pexprs.end.allowsSkippingPrecedingSpace =\n  pexprs.Apply.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Terminal.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Range.prototype.allowsSkippingPrecedingSpace =\n  pexprs.UnicodeChar.prototype.allowsSkippingPrecedingSpace =\n    function () {\n      return true;\n    };\n\n/*\n  Higher-order expressions that don't directly consume input.\n*/\npexprs.Alt.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Iter.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Lex.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Lookahead.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Not.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Param.prototype.allowsSkippingPrecedingSpace =\n  pexprs.Seq.prototype.allowsSkippingPrecedingSpace =\n    function () {\n      return false;\n    };\n", "import {abstract, isSyntactic} from './common.js';\nimport * as errors from './errors.js';\nimport * as pexprs from './pexprs-main.js';\nimport * as util from './util.js';\n\nlet BuiltInRules;\n\nutil.awaitBuiltInRules(g => {\n  BuiltInRules = g;\n});\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\nlet lexifyCount;\n\npexprs.PExpr.prototype.assertAllApplicationsAreValid = function (ruleName, grammar) {\n  lexifyCount = 0;\n  this._assertAllApplicationsAreValid(ruleName, grammar);\n};\n\npexprs.PExpr.prototype._assertAllApplicationsAreValid = abstract(\n  '_assertAllApplicationsAreValid'\n);\n\npexprs.any._assertAllApplicationsAreValid =\n  pexprs.end._assertAllApplicationsAreValid =\n  pexprs.Terminal.prototype._assertAllApplicationsAreValid =\n  pexprs.Range.prototype._assertAllApplicationsAreValid =\n  pexprs.Param.prototype._assertAllApplicationsAreValid =\n  pexprs.UnicodeChar.prototype._assertAllApplicationsAreValid =\n    function (ruleName, grammar) {\n      // no-op\n    };\n\npexprs.Lex.prototype._assertAllApplicationsAreValid = function (ruleName, grammar) {\n  lexifyCount++;\n  this.expr._assertAllApplicationsAreValid(ruleName, grammar);\n  lexifyCount--;\n};\n\npexprs.Alt.prototype._assertAllApplicationsAreValid = function (ruleName, grammar) {\n  for (let idx = 0; idx < this.terms.length; idx++) {\n    this.terms[idx]._assertAllApplicationsAreValid(ruleName, grammar);\n  }\n};\n\npexprs.Seq.prototype._assertAllApplicationsAreValid = function (ruleName, grammar) {\n  for (let idx = 0; idx < this.factors.length; idx++) {\n    this.factors[idx]._assertAllApplicationsAreValid(ruleName, grammar);\n  }\n};\n\npexprs.Iter.prototype._assertAllApplicationsAreValid =\n  pexprs.Not.prototype._assertAllApplicationsAreValid =\n  pexprs.Lookahead.prototype._assertAllApplicationsAreValid =\n    function (ruleName, grammar) {\n      this.expr._assertAllApplicationsAreValid(ruleName, grammar);\n    };\n\npexprs.Apply.prototype._assertAllApplicationsAreValid = function (\n  ruleName,\n  grammar,\n  skipSyntacticCheck = false\n) {\n  const ruleInfo = grammar.rules[this.ruleName];\n  const isContextSyntactic = isSyntactic(ruleName) && lexifyCount === 0;\n\n  // Make sure that the rule exists...\n  if (!ruleInfo) {\n    throw errors.undeclaredRule(this.ruleName, grammar.name, this.source);\n  }\n\n  // ...and that this application is allowed\n  if (!skipSyntacticCheck && isSyntactic(this.ruleName) && !isContextSyntactic) {\n    throw errors.applicationOfSyntacticRuleFromLexicalContext(this.ruleName, this);\n  }\n\n  // ...and that this application has the correct number of arguments.\n  const actual = this.args.length;\n  const expected = ruleInfo.formals.length;\n  if (actual !== expected) {\n    throw errors.wrongNumberOfArguments(this.ruleName, expected, actual, this.source);\n  }\n\n  const isBuiltInApplySyntactic =\n    BuiltInRules && ruleInfo === BuiltInRules.rules.applySyntactic;\n  const isBuiltInCaseInsensitive =\n    BuiltInRules && ruleInfo === BuiltInRules.rules.caseInsensitive;\n\n  // If it's an application of 'caseInsensitive', ensure that the argument is a Terminal.\n  if (isBuiltInCaseInsensitive) {\n    if (!(this.args[0] instanceof pexprs.Terminal)) {\n      throw errors.incorrectArgumentType('a Terminal (e.g. \"abc\")', this.args[0]);\n    }\n  }\n\n  if (isBuiltInApplySyntactic) {\n    const arg = this.args[0];\n    if (!(arg instanceof pexprs.Apply)) {\n      throw errors.incorrectArgumentType('a syntactic rule application', arg);\n    }\n    if (!isSyntactic(arg.ruleName)) {\n      throw errors.applySyntacticWithLexicalRuleApplication(arg);\n    }\n    if (isContextSyntactic) {\n      throw errors.unnecessaryExperimentalApplySyntactic(this);\n    }\n  }\n\n  // ...and that all of the argument expressions only have valid applications and have arity 1.\n  // If `this` is an application of the built-in applySyntactic rule, then its arg is\n  // allowed (and expected) to be a syntactic rule, even if we're in a lexical context.\n  this.args.forEach(arg => {\n    arg._assertAllApplicationsAreValid(ruleName, grammar, isBuiltInApplySyntactic);\n    if (arg.getArity() !== 1) {\n      throw errors.invalidParameter(this.ruleName, arg);\n    }\n  });\n};\n", "import {abstract} from './common.js';\nimport * as errors from './errors.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\npexprs.PExpr.prototype.assertChoicesHaveUniformArity = abstract(\n  'assertChoicesHaveUniformArity'\n);\n\npexprs.any.assertChoicesHaveUniformArity =\n  pexprs.end.assertChoicesHaveUniformArity =\n  pexprs.Terminal.prototype.assertChoicesHaveUniformArity =\n  pexprs.Range.prototype.assertChoicesHaveUniformArity =\n  pexprs.Param.prototype.assertChoicesHaveUniformArity =\n  pexprs.Lex.prototype.assertChoicesHaveUniformArity =\n  pexprs.UnicodeChar.prototype.assertChoicesHaveUniformArity =\n    function (ruleName) {\n      // no-op\n    };\n\npexprs.Alt.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  if (this.terms.length === 0) {\n    return;\n  }\n  const arity = this.terms[0].getArity();\n  for (let idx = 0; idx < this.terms.length; idx++) {\n    const term = this.terms[idx];\n    term.assertChoicesHaveUniformArity();\n    const otherArity = term.getArity();\n    if (arity !== otherArity) {\n      throw errors.inconsistentArity(ruleName, arity, otherArity, term);\n    }\n  }\n};\n\npexprs.Extend.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  // Extend is a special case of Alt that's guaranteed to have exactly two\n  // cases: [extensions, origBody].\n  const actualArity = this.terms[0].getArity();\n  const expectedArity = this.terms[1].getArity();\n  if (actualArity !== expectedArity) {\n    throw errors.inconsistentArity(ruleName, expectedArity, actualArity, this.terms[0]);\n  }\n};\n\npexprs.Seq.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  for (let idx = 0; idx < this.factors.length; idx++) {\n    this.factors[idx].assertChoicesHaveUniformArity(ruleName);\n  }\n};\n\npexprs.Iter.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  this.expr.assertChoicesHaveUniformArity(ruleName);\n};\n\npexprs.Not.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  // no-op (not required b/c the nested expr doesn't show up in the CST)\n};\n\npexprs.Lookahead.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  this.expr.assertChoicesHaveUniformArity(ruleName);\n};\n\npexprs.Apply.prototype.assertChoicesHaveUniformArity = function (ruleName) {\n  // The arities of the parameter expressions is required to be 1 by\n  // `assertAllApplicationsAreValid()`.\n};\n", "import {abstract} from './common.js';\nimport * as errors from './errors.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\npexprs.PExpr.prototype.assertIteratedExprsAreNotNullable = abstract(\n  'assertIteratedExprsAreNotNullable'\n);\n\npexprs.any.assertIteratedExprsAreNotNullable =\n  pexprs.end.assertIteratedExprsAreNotNullable =\n  pexprs.Terminal.prototype.assertIteratedExprsAreNotNullable =\n  pexprs.Range.prototype.assertIteratedExprsAreNotNullable =\n  pexprs.Param.prototype.assertIteratedExprsAreNotNullable =\n  pexprs.UnicodeChar.prototype.assertIteratedExprsAreNotNullable =\n    function (grammar) {\n      // no-op\n    };\n\npexprs.Alt.prototype.assertIteratedExprsAreNotNullable = function (grammar) {\n  for (let idx = 0; idx < this.terms.length; idx++) {\n    this.terms[idx].assertIteratedExprsAreNotNullable(grammar);\n  }\n};\n\npexprs.Seq.prototype.assertIteratedExprsAreNotNullable = function (grammar) {\n  for (let idx = 0; idx < this.factors.length; idx++) {\n    this.factors[idx].assertIteratedExprsAreNotNullable(grammar);\n  }\n};\n\npexprs.Iter.prototype.assertIteratedExprsAreNotNullable = function (grammar) {\n  // Note: this is the implementation of this method for `Star` and `Plus` expressions.\n  // It is overridden for `Opt` below.\n  this.expr.assertIteratedExprsAreNotNullable(grammar);\n  if (this.expr.isNullable(grammar)) {\n    throw errors.kleeneExprHasNullableOperand(this, []);\n  }\n};\n\npexprs.Opt.prototype.assertIteratedExprsAreNotNullable =\n  pexprs.Not.prototype.assertIteratedExprsAreNotNullable =\n  pexprs.Lookahead.prototype.assertIteratedExprsAreNotNullable =\n  pexprs.Lex.prototype.assertIteratedExprsAreNotNullable =\n    function (grammar) {\n      this.expr.assertIteratedExprsAreNotNullable(grammar);\n    };\n\npexprs.Apply.prototype.assertIteratedExprsAreNotNullable = function (grammar) {\n  this.args.forEach(arg => {\n    arg.assertIteratedExprsAreNotNullable(grammar);\n  });\n};\n", "import * as common from './common.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nexport class Node {\n  constructor(matchLength) {\n    this.matchLength = matchLength;\n  }\n\n  get ctorName() {\n    throw new Error('subclass responsibility');\n  }\n\n  numChildren() {\n    return this.children ? this.children.length : 0;\n  }\n\n  childAt(idx) {\n    if (this.children) {\n      return this.children[idx];\n    }\n  }\n\n  indexOfChild(arg) {\n    return this.children.indexOf(arg);\n  }\n\n  hasChildren() {\n    return this.numChildren() > 0;\n  }\n\n  hasNoChildren() {\n    return !this.hasChildren();\n  }\n\n  onlyChild() {\n    if (this.numChildren() !== 1) {\n      throw new Error(\n        'cannot get only child of a node of type ' +\n          this.ctorName +\n          ' (it has ' +\n          this.numChildren() +\n          ' children)'\n      );\n    } else {\n      return this.firstChild();\n    }\n  }\n\n  firstChild() {\n    if (this.hasNoChildren()) {\n      throw new Error(\n        'cannot get first child of a ' + this.ctorName + ' node, which has no children'\n      );\n    } else {\n      return this.childAt(0);\n    }\n  }\n\n  lastChild() {\n    if (this.hasNoChildren()) {\n      throw new Error(\n        'cannot get last child of a ' + this.ctorName + ' node, which has no children'\n      );\n    } else {\n      return this.childAt(this.numChildren() - 1);\n    }\n  }\n\n  childBefore(child) {\n    const childIdx = this.indexOfChild(child);\n    if (childIdx < 0) {\n      throw new Error('Node.childBefore() called w/ an argument that is not a child');\n    } else if (childIdx === 0) {\n      throw new Error('cannot get child before first child');\n    } else {\n      return this.childAt(childIdx - 1);\n    }\n  }\n\n  childAfter(child) {\n    const childIdx = this.indexOfChild(child);\n    if (childIdx < 0) {\n      throw new Error('Node.childAfter() called w/ an argument that is not a child');\n    } else if (childIdx === this.numChildren() - 1) {\n      throw new Error('cannot get child after last child');\n    } else {\n      return this.childAt(childIdx + 1);\n    }\n  }\n\n  isTerminal() {\n    return false;\n  }\n\n  isNonterminal() {\n    return false;\n  }\n\n  isIteration() {\n    return false;\n  }\n\n  isOptional() {\n    return false;\n  }\n}\n\n// Terminals\n\nexport class TerminalNode extends Node {\n  get ctorName() {\n    return '_terminal';\n  }\n\n  isTerminal() {\n    return true;\n  }\n\n  get primitiveValue() {\n    throw new Error('The `primitiveValue` property was removed in Ohm v17.');\n  }\n}\n\n// Nonterminals\n\nexport class NonterminalNode extends Node {\n  constructor(ruleName, children, childOffsets, matchLength) {\n    super(matchLength);\n    this.ruleName = ruleName;\n    this.children = children;\n    this.childOffsets = childOffsets;\n  }\n\n  get ctorName() {\n    return this.ruleName;\n  }\n\n  isNonterminal() {\n    return true;\n  }\n\n  isLexical() {\n    return common.isLexical(this.ctorName);\n  }\n\n  isSyntactic() {\n    return common.isSyntactic(this.ctorName);\n  }\n}\n\n// Iterations\n\nexport class IterationNode extends Node {\n  constructor(children, childOffsets, matchLength, isOptional) {\n    super(matchLength);\n    this.children = children;\n    this.childOffsets = childOffsets;\n    this.optional = isOptional;\n  }\n\n  get ctorName() {\n    return '_iter';\n  }\n\n  isIteration() {\n    return true;\n  }\n\n  isOptional() {\n    return this.optional;\n  }\n}\n", "import {Trace} from './Trace.js';\nimport * as common from './common.js';\nimport * as errors from './errors.js';\nimport {IterationNode, NonterminalNode, TerminalNode} from './nodes.js';\nimport * as pexprs from './pexprs-main.js';\nimport {MAX_CODE_POINT} from './InputStream.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n/*\n  Evaluate the expression and return `true` if it succeeds, `false` otherwise. This method should\n  only be called directly by `State.prototype.eval(expr)`, which also updates the data structures\n  that are used for tracing. (Making those updates in a method of `State` enables the trace-specific\n  data structures to be \"secrets\" of that class, which is good for modularity.)\n\n  The contract of this method is as follows:\n  * When the return value is `true`,\n    - the state object will have `expr.getArity()` more bindings than it did before the call.\n  * When the return value is `false`,\n    - the state object may have more bindings than it did before the call, and\n    - its input stream's position may be anywhere.\n\n  Note that `State.prototype.eval(expr)`, unlike this method, guarantees that neither the state\n  object's bindings nor its input stream's position will change if the expression fails to match.\n*/\npexprs.PExpr.prototype.eval = common.abstract('eval'); // function(state) { ... }\n\npexprs.any.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  const cp = inputStream.nextCodePoint();\n  if (cp !== undefined) {\n    state.pushBinding(new TerminalNode(String.fromCodePoint(cp).length), origPos);\n    return true;\n  } else {\n    state.processFailure(origPos, this);\n    return false;\n  }\n};\n\npexprs.end.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  if (inputStream.atEnd()) {\n    state.pushBinding(new TerminalNode(0), origPos);\n    return true;\n  } else {\n    state.processFailure(origPos, this);\n    return false;\n  }\n};\n\npexprs.Terminal.prototype.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  if (!inputStream.matchString(this.obj)) {\n    state.processFailure(origPos, this);\n    return false;\n  } else {\n    state.pushBinding(new TerminalNode(this.obj.length), origPos);\n    return true;\n  }\n};\n\npexprs.Range.prototype.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n\n  // A range can operate in one of two modes: matching a single, 16-bit _code unit_,\n  // or matching a _code point_. (Code points over 0xFFFF take up two 16-bit code units.)\n  const cp = this.matchCodePoint ? inputStream.nextCodePoint() : inputStream.nextCharCode();\n\n  // Always compare by code point value to get the correct result in all scenarios.\n  // Note that for strings of length 1, codePointAt(0) and charPointAt(0) are equivalent.\n  if (cp !== undefined && this.from.codePointAt(0) <= cp && cp <= this.to.codePointAt(0)) {\n    state.pushBinding(new TerminalNode(String.fromCodePoint(cp).length), origPos);\n    return true;\n  } else {\n    state.processFailure(origPos, this);\n    return false;\n  }\n};\n\npexprs.Param.prototype.eval = function (state) {\n  return state.eval(state.currentApplication().args[this.index]);\n};\n\npexprs.Lex.prototype.eval = function (state) {\n  state.enterLexifiedContext();\n  const ans = state.eval(this.expr);\n  state.exitLexifiedContext();\n  return ans;\n};\n\npexprs.Alt.prototype.eval = function (state) {\n  for (let idx = 0; idx < this.terms.length; idx++) {\n    if (state.eval(this.terms[idx])) {\n      return true;\n    }\n  }\n  return false;\n};\n\npexprs.Seq.prototype.eval = function (state) {\n  for (let idx = 0; idx < this.factors.length; idx++) {\n    const factor = this.factors[idx];\n    if (!state.eval(factor)) {\n      return false;\n    }\n  }\n  return true;\n};\n\npexprs.Iter.prototype.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  const arity = this.getArity();\n  const cols = [];\n  const colOffsets = [];\n  while (cols.length < arity) {\n    cols.push([]);\n    colOffsets.push([]);\n  }\n\n  let numMatches = 0;\n  let prevPos = origPos;\n  let idx;\n  while (numMatches < this.maxNumMatches && state.eval(this.expr)) {\n    if (inputStream.pos === prevPos) {\n      throw errors.kleeneExprHasNullableOperand(this, state._applicationStack);\n    }\n    prevPos = inputStream.pos;\n    numMatches++;\n    const row = state._bindings.splice(state._bindings.length - arity, arity);\n    const rowOffsets = state._bindingOffsets.splice(\n      state._bindingOffsets.length - arity,\n      arity\n    );\n    for (idx = 0; idx < row.length; idx++) {\n      cols[idx].push(row[idx]);\n      colOffsets[idx].push(rowOffsets[idx]);\n    }\n  }\n  if (numMatches < this.minNumMatches) {\n    return false;\n  }\n  let offset = state.posToOffset(origPos);\n  let matchLength = 0;\n  if (numMatches > 0) {\n    const lastCol = cols[arity - 1];\n    const lastColOffsets = colOffsets[arity - 1];\n\n    const endOffset =\n      lastColOffsets[lastColOffsets.length - 1] + lastCol[lastCol.length - 1].matchLength;\n    offset = colOffsets[0][0];\n    matchLength = endOffset - offset;\n  }\n  const isOptional = this instanceof pexprs.Opt;\n  for (idx = 0; idx < cols.length; idx++) {\n    state._bindings.push(\n      new IterationNode(cols[idx], colOffsets[idx], matchLength, isOptional)\n    );\n    state._bindingOffsets.push(offset);\n  }\n  return true;\n};\n\npexprs.Not.prototype.eval = function (state) {\n  /*\n    TODO:\n    - Right now we're just throwing away all of the failures that happen inside a `not`, and\n      recording `this` as a failed expression.\n    - Double negation should be equivalent to lookahead, but that's not the case right now wrt\n      failures. E.g., ~~'foo' produces a failure for ~~'foo', but maybe it should produce\n      a failure for 'foo' instead.\n  */\n\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  state.pushFailuresInfo();\n\n  const ans = state.eval(this.expr);\n\n  state.popFailuresInfo();\n  if (ans) {\n    state.processFailure(origPos, this);\n    return false;\n  }\n\n  inputStream.pos = origPos;\n  return true;\n};\n\npexprs.Lookahead.prototype.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  if (state.eval(this.expr)) {\n    inputStream.pos = origPos;\n    return true;\n  } else {\n    return false;\n  }\n};\n\npexprs.Apply.prototype.eval = function (state) {\n  const caller = state.currentApplication();\n  const actuals = caller ? caller.args : [];\n  const app = this.substituteParams(actuals);\n\n  const posInfo = state.getCurrentPosInfo();\n  if (posInfo.isActive(app)) {\n    // This rule is already active at this position, i.e., it is left-recursive.\n    return app.handleCycle(state);\n  }\n\n  const memoKey = app.toMemoKey();\n  const memoRec = posInfo.memo[memoKey];\n\n  if (memoRec && posInfo.shouldUseMemoizedResult(memoRec)) {\n    if (state.hasNecessaryInfo(memoRec)) {\n      return state.useMemoizedResult(state.inputStream.pos, memoRec);\n    }\n    delete posInfo.memo[memoKey];\n  }\n  return app.reallyEval(state);\n};\n\npexprs.Apply.prototype.handleCycle = function (state) {\n  const posInfo = state.getCurrentPosInfo();\n  const {currentLeftRecursion} = posInfo;\n  const memoKey = this.toMemoKey();\n  let memoRec = posInfo.memo[memoKey];\n\n  if (currentLeftRecursion && currentLeftRecursion.headApplication.toMemoKey() === memoKey) {\n    // We already know about this left recursion, but it's possible there are \"involved\n    // applications\" that we don't already know about, so...\n    memoRec.updateInvolvedApplicationMemoKeys();\n  } else if (!memoRec) {\n    // New left recursion detected! Memoize a failure to try to get a seed parse.\n    memoRec = posInfo.memoize(memoKey, {\n      matchLength: 0,\n      examinedLength: 0,\n      value: false,\n      rightmostFailureOffset: -1,\n    });\n    posInfo.startLeftRecursion(this, memoRec);\n  }\n  return state.useMemoizedResult(state.inputStream.pos, memoRec);\n};\n\npexprs.Apply.prototype.reallyEval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  const origPosInfo = state.getCurrentPosInfo();\n  const ruleInfo = state.grammar.rules[this.ruleName];\n  const {body} = ruleInfo;\n  const {description} = ruleInfo;\n\n  state.enterApplication(origPosInfo, this);\n\n  if (description) {\n    state.pushFailuresInfo();\n  }\n\n  // Reset the input stream's examinedLength property so that we can track\n  // the examined length of this particular application.\n  const origInputStreamExaminedLength = inputStream.examinedLength;\n  inputStream.examinedLength = 0;\n\n  let value = this.evalOnce(body, state);\n  const currentLR = origPosInfo.currentLeftRecursion;\n  const memoKey = this.toMemoKey();\n  const isHeadOfLeftRecursion = currentLR && currentLR.headApplication.toMemoKey() === memoKey;\n  let memoRec;\n\n  if (state.doNotMemoize) {\n    state.doNotMemoize = false;\n  } else if (isHeadOfLeftRecursion) {\n    value = this.growSeedResult(body, state, origPos, currentLR, value);\n    origPosInfo.endLeftRecursion();\n    memoRec = currentLR;\n    memoRec.examinedLength = inputStream.examinedLength - origPos;\n    memoRec.rightmostFailureOffset = state._getRightmostFailureOffset();\n    origPosInfo.memoize(memoKey, memoRec); // updates origPosInfo's maxExaminedLength\n  } else if (!currentLR || !currentLR.isInvolved(memoKey)) {\n    // This application is not involved in left recursion, so it's ok to memoize it.\n    memoRec = origPosInfo.memoize(memoKey, {\n      matchLength: inputStream.pos - origPos,\n      examinedLength: inputStream.examinedLength - origPos,\n      value,\n      failuresAtRightmostPosition: state.cloneRecordedFailures(),\n      rightmostFailureOffset: state._getRightmostFailureOffset(),\n    });\n  }\n  const succeeded = !!value;\n\n  if (description) {\n    state.popFailuresInfo();\n    if (!succeeded) {\n      state.processFailure(origPos, this);\n    }\n    if (memoRec) {\n      memoRec.failuresAtRightmostPosition = state.cloneRecordedFailures();\n    }\n  }\n\n  // Record trace information in the memo table, so that it is available if the memoized result\n  // is used later.\n  if (state.isTracing() && memoRec) {\n    const entry = state.getTraceEntry(origPos, this, succeeded, succeeded ? [value] : []);\n    if (isHeadOfLeftRecursion) {\n      common.assert(entry.terminatingLREntry != null || !succeeded);\n      entry.isHeadOfLeftRecursion = true;\n    }\n    memoRec.traceEntry = entry;\n  }\n\n  // Fix the input stream's examinedLength -- it should be the maximum examined length\n  // across all applications, not just this one.\n  inputStream.examinedLength = Math.max(\n    inputStream.examinedLength,\n    origInputStreamExaminedLength\n  );\n\n  state.exitApplication(origPosInfo, value);\n\n  return succeeded;\n};\n\npexprs.Apply.prototype.evalOnce = function (expr, state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n\n  if (state.eval(expr)) {\n    const arity = expr.getArity();\n    const bindings = state._bindings.splice(state._bindings.length - arity, arity);\n    const offsets = state._bindingOffsets.splice(state._bindingOffsets.length - arity, arity);\n    const matchLength = inputStream.pos - origPos;\n    return new NonterminalNode(this.ruleName, bindings, offsets, matchLength);\n  } else {\n    return false;\n  }\n};\n\npexprs.Apply.prototype.growSeedResult = function (body, state, origPos, lrMemoRec, newValue) {\n  if (!newValue) {\n    return false;\n  }\n\n  const {inputStream} = state;\n\n  while (true) {\n    lrMemoRec.matchLength = inputStream.pos - origPos;\n    lrMemoRec.value = newValue;\n    lrMemoRec.failuresAtRightmostPosition = state.cloneRecordedFailures();\n\n    if (state.isTracing()) {\n      // Before evaluating the body again, add a trace node for this application to the memo entry.\n      // Its only child is a copy of the trace node from `newValue`, which will always be the last\n      // element in `state.trace`.\n      const seedTrace = state.trace[state.trace.length - 1];\n      lrMemoRec.traceEntry = new Trace(\n        state.input,\n        origPos,\n        inputStream.pos,\n        this,\n        true,\n        [newValue],\n        [seedTrace.clone()]\n      );\n    }\n    inputStream.pos = origPos;\n    newValue = this.evalOnce(body, state);\n    if (inputStream.pos - origPos <= lrMemoRec.matchLength) {\n      break;\n    }\n    if (state.isTracing()) {\n      state.trace.splice(-2, 1); // Drop the trace for the old seed.\n    }\n  }\n  if (state.isTracing()) {\n    // The last entry is for an unused result -- pop it and save it in the \"real\" entry.\n    lrMemoRec.traceEntry.recordLRTermination(state.trace.pop(), newValue);\n  }\n  inputStream.pos = origPos + lrMemoRec.matchLength;\n  return lrMemoRec.value;\n};\n\npexprs.UnicodeChar.prototype.eval = function (state) {\n  const {inputStream} = state;\n  const origPos = inputStream.pos;\n  const cp = inputStream.nextCodePoint();\n  if (cp !== undefined && cp <= MAX_CODE_POINT) {\n    const ch = String.fromCodePoint(cp);\n    if (this.pattern.test(ch)) {\n      state.pushBinding(new TerminalNode(ch.length), origPos);\n      return true;\n    }\n  }\n  state.processFailure(origPos, this);\n  return false;\n};\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\npexprs.PExpr.prototype.getArity = abstract('getArity');\n\npexprs.any.getArity =\n  pexprs.end.getArity =\n  pexprs.Terminal.prototype.getArity =\n  pexprs.Range.prototype.getArity =\n  pexprs.Param.prototype.getArity =\n  pexprs.Apply.prototype.getArity =\n  pexprs.UnicodeChar.prototype.getArity =\n    function () {\n      return 1;\n    };\n\npexprs.Alt.prototype.getArity = function () {\n  // This is ok b/c all terms must have the same arity -- this property is\n  // checked by the Grammar constructor.\n  return this.terms.length === 0 ? 0 : this.terms[0].getArity();\n};\n\npexprs.Seq.prototype.getArity = function () {\n  let arity = 0;\n  for (let idx = 0; idx < this.factors.length; idx++) {\n    arity += this.factors[idx].getArity();\n  }\n  return arity;\n};\n\npexprs.Iter.prototype.getArity = function () {\n  return this.expr.getArity();\n};\n\npexprs.Not.prototype.getArity = function () {\n  return 0;\n};\n\npexprs.Lookahead.prototype.getArity = pexprs.Lex.prototype.getArity = function () {\n  return this.expr.getArity();\n};\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nfunction getMetaInfo(expr, grammarInterval) {\n  const metaInfo = {};\n  if (expr.source && grammarInterval) {\n    const adjusted = expr.source.relativeTo(grammarInterval);\n    metaInfo.sourceInterval = [adjusted.startIdx, adjusted.endIdx];\n  }\n  return metaInfo;\n}\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\npexprs.PExpr.prototype.outputRecipe = abstract('outputRecipe');\n\npexprs.any.outputRecipe = function (formals, grammarInterval) {\n  return ['any', getMetaInfo(this, grammarInterval)];\n};\n\npexprs.end.outputRecipe = function (formals, grammarInterval) {\n  return ['end', getMetaInfo(this, grammarInterval)];\n};\n\npexprs.Terminal.prototype.outputRecipe = function (formals, grammarInterval) {\n  return ['terminal', getMetaInfo(this, grammarInterval), this.obj];\n};\n\npexprs.Range.prototype.outputRecipe = function (formals, grammarInterval) {\n  return ['range', getMetaInfo(this, grammarInterval), this.from, this.to];\n};\n\npexprs.Param.prototype.outputRecipe = function (formals, grammarInterval) {\n  return ['param', getMetaInfo(this, grammarInterval), this.index];\n};\n\npexprs.Alt.prototype.outputRecipe = function (formals, grammarInterval) {\n  return ['alt', getMetaInfo(this, grammarInterval)].concat(\n    this.terms.map(term => term.outputRecipe(formals, grammarInterval))\n  );\n};\n\npexprs.Extend.prototype.outputRecipe = function (formals, grammarInterval) {\n  const extension = this.terms[0]; // [extension, original]\n  return extension.outputRecipe(formals, grammarInterval);\n};\n\npexprs.Splice.prototype.outputRecipe = function (formals, grammarInterval) {\n  const beforeTerms = this.terms.slice(0, this.expansionPos);\n  const afterTerms = this.terms.slice(this.expansionPos + 1);\n  return [\n    'splice',\n    getMetaInfo(this, grammarInterval),\n    beforeTerms.map(term => term.outputRecipe(formals, grammarInterval)),\n    afterTerms.map(term => term.outputRecipe(formals, grammarInterval)),\n  ];\n};\n\npexprs.Seq.prototype.outputRecipe = function (formals, grammarInterval) {\n  return ['seq', getMetaInfo(this, grammarInterval)].concat(\n    this.factors.map(factor => factor.outputRecipe(formals, grammarInterval))\n  );\n};\n\npexprs.Star.prototype.outputRecipe =\n  pexprs.Plus.prototype.outputRecipe =\n  pexprs.Opt.prototype.outputRecipe =\n  pexprs.Not.prototype.outputRecipe =\n  pexprs.Lookahead.prototype.outputRecipe =\n  pexprs.Lex.prototype.outputRecipe =\n    function (formals, grammarInterval) {\n      return [\n        this.constructor.name.toLowerCase(),\n        getMetaInfo(this, grammarInterval),\n        this.expr.outputRecipe(formals, grammarInterval),\n      ];\n    };\n\npexprs.Apply.prototype.outputRecipe = function (formals, grammarInterval) {\n  return [\n    'app',\n    getMetaInfo(this, grammarInterval),\n    this.ruleName,\n    this.args.map(arg => arg.outputRecipe(formals, grammarInterval)),\n  ];\n};\n\npexprs.UnicodeChar.prototype.outputRecipe = function (formals, grammarInterval) {\n  return ['unicodeChar', getMetaInfo(this, grammarInterval), this.categoryOrProp];\n};\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n/*\n  Called at grammar creation time to rewrite a rule body, replacing each reference to a formal\n  parameter with a `Param` node. Returns a PExpr -- either a new one, or the original one if\n  it was modified in place.\n*/\npexprs.PExpr.prototype.introduceParams = abstract('introduceParams');\n\npexprs.any.introduceParams =\n  pexprs.end.introduceParams =\n  pexprs.Terminal.prototype.introduceParams =\n  pexprs.Range.prototype.introduceParams =\n  pexprs.Param.prototype.introduceParams =\n  pexprs.UnicodeChar.prototype.introduceParams =\n    function (formals) {\n      return this;\n    };\n\npexprs.Alt.prototype.introduceParams = function (formals) {\n  this.terms.forEach((term, idx, terms) => {\n    terms[idx] = term.introduceParams(formals);\n  });\n  return this;\n};\n\npexprs.Seq.prototype.introduceParams = function (formals) {\n  this.factors.forEach((factor, idx, factors) => {\n    factors[idx] = factor.introduceParams(formals);\n  });\n  return this;\n};\n\npexprs.Iter.prototype.introduceParams =\n  pexprs.Not.prototype.introduceParams =\n  pexprs.Lookahead.prototype.introduceParams =\n  pexprs.Lex.prototype.introduceParams =\n    function (formals) {\n      this.expr = this.expr.introduceParams(formals);\n      return this;\n    };\n\npexprs.Apply.prototype.introduceParams = function (formals) {\n  const index = formals.indexOf(this.ruleName);\n  if (index >= 0) {\n    if (this.args.length > 0) {\n      // TODO: Should this be supported? See issue #64.\n      throw new Error('Parameterized rules cannot be passed as arguments to another rule.');\n    }\n    return new pexprs.Param(index).withSource(this.source);\n  } else {\n    this.args.forEach((arg, idx, args) => {\n      args[idx] = arg.introduceParams(formals);\n    });\n    return this;\n  }\n};\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n// Returns `true` if this parsing expression may accept without consuming any input.\npexprs.PExpr.prototype.isNullable = function (grammar) {\n  return this._isNullable(grammar, Object.create(null));\n};\n\npexprs.PExpr.prototype._isNullable = abstract('_isNullable');\n\npexprs.any._isNullable =\n  pexprs.Range.prototype._isNullable =\n  pexprs.Param.prototype._isNullable =\n  pexprs.Plus.prototype._isNullable =\n  pexprs.UnicodeChar.prototype._isNullable =\n    function (grammar, memo) {\n      return false;\n    };\n\npexprs.end._isNullable = function (grammar, memo) {\n  return true;\n};\n\npexprs.Terminal.prototype._isNullable = function (grammar, memo) {\n  if (typeof this.obj === 'string') {\n    // This is an over-simplification: it's only correct if the input is a string. If it's an array\n    // or an object, then the empty string parsing expression is not nullable.\n    return this.obj === '';\n  } else {\n    return false;\n  }\n};\n\npexprs.Alt.prototype._isNullable = function (grammar, memo) {\n  return this.terms.length === 0 || this.terms.some(term => term._isNullable(grammar, memo));\n};\n\npexprs.Seq.prototype._isNullable = function (grammar, memo) {\n  return this.factors.every(factor => factor._isNullable(grammar, memo));\n};\n\npexprs.Star.prototype._isNullable =\n  pexprs.Opt.prototype._isNullable =\n  pexprs.Not.prototype._isNullable =\n  pexprs.Lookahead.prototype._isNullable =\n    function (grammar, memo) {\n      return true;\n    };\n\npexprs.Lex.prototype._isNullable = function (grammar, memo) {\n  return this.expr._isNullable(grammar, memo);\n};\n\npexprs.Apply.prototype._isNullable = function (grammar, memo) {\n  const key = this.toMemoKey();\n  if (!Object.prototype.hasOwnProperty.call(memo, key)) {\n    const {body} = grammar.rules[this.ruleName];\n    const inlined = body.substituteParams(this.args);\n    memo[key] = false; // Prevent infinite recursion for recursive rules.\n    memo[key] = inlined._isNullable(grammar, memo);\n  }\n  return memo[key];\n};\n", "import {abstract, checkNotNull} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n/*\n  Returns a PExpr that results from recursively replacing every formal parameter (i.e., instance\n  of `Param`) inside this PExpr with its actual value from `actuals` (an Array).\n\n  The receiver must not be modified; a new PExpr must be returned if any replacement is necessary.\n*/\n// function(actuals) { ... }\npexprs.PExpr.prototype.substituteParams = abstract('substituteParams');\n\npexprs.any.substituteParams =\n  pexprs.end.substituteParams =\n  pexprs.Terminal.prototype.substituteParams =\n  pexprs.Range.prototype.substituteParams =\n  pexprs.UnicodeChar.prototype.substituteParams =\n    function (actuals) {\n      return this;\n    };\n\npexprs.Param.prototype.substituteParams = function (actuals) {\n  return checkNotNull(actuals[this.index]);\n};\n\npexprs.Alt.prototype.substituteParams = function (actuals) {\n  return new pexprs.Alt(this.terms.map(term => term.substituteParams(actuals)));\n};\n\npexprs.Seq.prototype.substituteParams = function (actuals) {\n  return new pexprs.Seq(this.factors.map(factor => factor.substituteParams(actuals)));\n};\n\npexprs.Iter.prototype.substituteParams =\n  pexprs.Not.prototype.substituteParams =\n  pexprs.Lookahead.prototype.substituteParams =\n  pexprs.Lex.prototype.substituteParams =\n    function (actuals) {\n      return new this.constructor(this.expr.substituteParams(actuals));\n    };\n\npexprs.Apply.prototype.substituteParams = function (actuals) {\n  if (this.args.length === 0) {\n    // Avoid making a copy of this application, as an optimization\n    return this;\n  } else {\n    const args = this.args.map(arg => arg.substituteParams(actuals));\n    return new pexprs.Apply(this.ruleName, args);\n  }\n};\n", "import {abstract, copyWithoutDuplicates} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nfunction isRestrictedJSIdentifier(str) {\n  return /^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(str);\n}\n\nfunction resolveDuplicatedNames(argumentNameList) {\n  // `count` is used to record the number of times each argument name occurs in the list,\n  // this is useful for checking duplicated argument name. It maps argument names to ints.\n  const count = Object.create(null);\n  argumentNameList.forEach(argName => {\n    count[argName] = (count[argName] || 0) + 1;\n  });\n\n  // Append subscripts ('_1', '_2', ...) to duplicate argument names.\n  Object.keys(count).forEach(dupArgName => {\n    if (count[dupArgName] <= 1) {\n      return;\n    }\n\n    // This name shows up more than once, so add subscripts.\n    let subscript = 1;\n    argumentNameList.forEach((argName, idx) => {\n      if (argName === dupArgName) {\n        argumentNameList[idx] = argName + '_' + subscript++;\n      }\n    });\n  });\n}\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n/*\n  Returns a list of strings that will be used as the default argument names for its receiver\n  (a pexpr) in a semantic action. This is used exclusively by the Semantics Editor.\n\n  `firstArgIndex` is the 1-based index of the first argument name that will be generated for this\n  pexpr. It enables us to name arguments positionally, e.g., if the second argument is a\n  non-alphanumeric terminal like \"+\", it will be named '$2'.\n\n  `noDupCheck` is true if the caller of `toArgumentNameList` is not a top level caller. It enables\n  us to avoid nested duplication subscripts appending, e.g., '_1_1', '_1_2', by only checking\n  duplicates at the top level.\n\n  Here is a more elaborate example that illustrates how this method works:\n  `(a \"+\" b).toArgumentNameList(1)` evaluates to `['a', '$2', 'b']` with the following recursive\n  calls:\n\n    (a).toArgumentNameList(1) -> ['a'],\n    (\"+\").toArgumentNameList(2) -> ['$2'],\n    (b).toArgumentNameList(3) -> ['b']\n\n  Notes:\n  * This method must only be called on well-formed expressions, e.g., the receiver must\n    not have any Alt sub-expressions with inconsistent arities.\n  * e.getArity() === e.toArgumentNameList(1).length\n*/\n// function(firstArgIndex, noDupCheck) { ... }\npexprs.PExpr.prototype.toArgumentNameList = abstract('toArgumentNameList');\n\npexprs.any.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return ['any'];\n};\n\npexprs.end.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return ['end'];\n};\n\npexprs.Terminal.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  if (typeof this.obj === 'string' && /^[_a-zA-Z0-9]+$/.test(this.obj)) {\n    // If this terminal is a valid suffix for a JS identifier, just prepend it with '_'\n    return ['_' + this.obj];\n  } else {\n    // Otherwise, name it positionally.\n    return ['$' + firstArgIndex];\n  }\n};\n\npexprs.Range.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  let argName = this.from + '_to_' + this.to;\n  // If the `argName` is not valid then try to prepend a `_`.\n  if (!isRestrictedJSIdentifier(argName)) {\n    argName = '_' + argName;\n  }\n  // If the `argName` still not valid after prepending a `_`, then name it positionally.\n  if (!isRestrictedJSIdentifier(argName)) {\n    argName = '$' + firstArgIndex;\n  }\n  return [argName];\n};\n\npexprs.Alt.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  // `termArgNameLists` is an array of arrays where each row is the\n  // argument name list that corresponds to a term in this alternation.\n  const termArgNameLists = this.terms.map(term =>\n    term.toArgumentNameList(firstArgIndex, true)\n  );\n\n  const argumentNameList = [];\n  const numArgs = termArgNameLists[0].length;\n  for (let colIdx = 0; colIdx < numArgs; colIdx++) {\n    const col = [];\n    for (let rowIdx = 0; rowIdx < this.terms.length; rowIdx++) {\n      col.push(termArgNameLists[rowIdx][colIdx]);\n    }\n    const uniqueNames = copyWithoutDuplicates(col);\n    argumentNameList.push(uniqueNames.join('_or_'));\n  }\n\n  if (!noDupCheck) {\n    resolveDuplicatedNames(argumentNameList);\n  }\n  return argumentNameList;\n};\n\npexprs.Seq.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  // Generate the argument name list, without worrying about duplicates.\n  let argumentNameList = [];\n  this.factors.forEach(factor => {\n    const factorArgumentNameList = factor.toArgumentNameList(firstArgIndex, true);\n    argumentNameList = argumentNameList.concat(factorArgumentNameList);\n\n    // Shift the firstArgIndex to take this factor's argument names into account.\n    firstArgIndex += factorArgumentNameList.length;\n  });\n  if (!noDupCheck) {\n    resolveDuplicatedNames(argumentNameList);\n  }\n  return argumentNameList;\n};\n\npexprs.Iter.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  const argumentNameList = this.expr\n    .toArgumentNameList(firstArgIndex, noDupCheck)\n    .map(exprArgumentString =>\n      exprArgumentString[exprArgumentString.length - 1] === 's'\n        ? exprArgumentString + 'es'\n        : exprArgumentString + 's'\n    );\n  if (!noDupCheck) {\n    resolveDuplicatedNames(argumentNameList);\n  }\n  return argumentNameList;\n};\n\npexprs.Opt.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return this.expr.toArgumentNameList(firstArgIndex, noDupCheck).map(argName => {\n    return 'opt' + argName[0].toUpperCase() + argName.slice(1);\n  });\n};\n\npexprs.Not.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return [];\n};\n\npexprs.Lookahead.prototype.toArgumentNameList = pexprs.Lex.prototype.toArgumentNameList =\n  function (firstArgIndex, noDupCheck) {\n    return this.expr.toArgumentNameList(firstArgIndex, noDupCheck);\n  };\n\npexprs.Apply.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return [this.ruleName];\n};\n\npexprs.UnicodeChar.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return ['$' + firstArgIndex];\n};\n\npexprs.Param.prototype.toArgumentNameList = function (firstArgIndex, noDupCheck) {\n  return ['param' + this.index];\n};\n\n// \"Value pexprs\" (Value, Str, Arr, Obj) are going away soon, so we don't worry about them here.\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n// Returns a string representing the PExpr, for use as a UI label, etc.\npexprs.PExpr.prototype.toDisplayString = abstract('toDisplayString');\n\npexprs.Alt.prototype.toDisplayString = pexprs.Seq.prototype.toDisplayString = function () {\n  if (this.source) {\n    return this.source.trimmed().contents;\n  }\n  return '[' + this.constructor.name + ']';\n};\n\npexprs.any.toDisplayString =\n  pexprs.end.toDisplayString =\n  pexprs.Iter.prototype.toDisplayString =\n  pexprs.Not.prototype.toDisplayString =\n  pexprs.Lookahead.prototype.toDisplayString =\n  pexprs.Lex.prototype.toDisplayString =\n  pexprs.Terminal.prototype.toDisplayString =\n  pexprs.Range.prototype.toDisplayString =\n  pexprs.Param.prototype.toDisplayString =\n    function () {\n      return this.toString();\n    };\n\npexprs.Apply.prototype.toDisplayString = function () {\n  if (this.args.length > 0) {\n    const ps = this.args.map(arg => arg.toDisplayString());\n    return this.ruleName + '<' + ps.join(',') + '>';\n  } else {\n    return this.ruleName;\n  }\n};\n\npexprs.UnicodeChar.prototype.toDisplayString = function () {\n  return 'Unicode [' + this.categoryOrProp + '] character';\n};\n", "// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\n/*\n  `Failure`s represent expressions that weren't matched while parsing. They are used to generate\n  error messages automatically. The interface of `Failure`s includes the collowing methods:\n\n  - getText() : String\n  - getType() : String  (one of {\"description\", \"string\", \"code\"})\n  - isDescription() : bool\n  - isStringTerminal() : bool\n  - isCode() : bool\n  - isFluffy() : bool\n  - makeFluffy() : void\n  - subsumes(Failure) : bool\n*/\n\nfunction isValidType(type) {\n  return type === 'description' || type === 'string' || type === 'code';\n}\n\nexport class Failure {\n  constructor(pexpr, text, type) {\n    if (!isValidType(type)) {\n      throw new Error('invalid Failure type: ' + type);\n    }\n    this.pexpr = pexpr;\n    this.text = text;\n    this.type = type;\n    this.fluffy = false;\n  }\n\n  getPExpr() {\n    return this.pexpr;\n  }\n\n  getText() {\n    return this.text;\n  }\n\n  getType() {\n    return this.type;\n  }\n\n  isDescription() {\n    return this.type === 'description';\n  }\n\n  isStringTerminal() {\n    return this.type === 'string';\n  }\n\n  isCode() {\n    return this.type === 'code';\n  }\n\n  isFluffy() {\n    return this.fluffy;\n  }\n\n  makeFluffy() {\n    this.fluffy = true;\n  }\n\n  clearFluffy() {\n    this.fluffy = false;\n  }\n\n  subsumes(that) {\n    return (\n      this.getText() === that.getText() &&\n      this.type === that.type &&\n      (!this.isFluffy() || (this.isFluffy() && that.isFluffy()))\n    );\n  }\n\n  toString() {\n    return this.type === 'string' ? JSON.stringify(this.getText()) : this.getText();\n  }\n\n  clone() {\n    const failure = new Failure(this.pexpr, this.text, this.type);\n    if (this.isFluffy()) {\n      failure.makeFluffy();\n    }\n    return failure;\n  }\n\n  toKey() {\n    return this.toString() + '#' + this.type;\n  }\n}\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\nimport {Failure} from './Failure.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\npexprs.PExpr.prototype.toFailure = abstract('toFailure');\n\npexprs.any.toFailure = function (grammar) {\n  return new Failure(this, 'any object', 'description');\n};\n\npexprs.end.toFailure = function (grammar) {\n  return new Failure(this, 'end of input', 'description');\n};\n\npexprs.Terminal.prototype.toFailure = function (grammar) {\n  return new Failure(this, this.obj, 'string');\n};\n\npexprs.Range.prototype.toFailure = function (grammar) {\n  // TODO: come up with something better\n  return new Failure(this, JSON.stringify(this.from) + '..' + JSON.stringify(this.to), 'code');\n};\n\npexprs.Not.prototype.toFailure = function (grammar) {\n  const description =\n    this.expr === pexprs.any ? 'nothing' : 'not ' + this.expr.toFailure(grammar);\n  return new Failure(this, description, 'description');\n};\n\npexprs.Lookahead.prototype.toFailure = function (grammar) {\n  return this.expr.toFailure(grammar);\n};\n\npexprs.Apply.prototype.toFailure = function (grammar) {\n  let {description} = grammar.rules[this.ruleName];\n  if (!description) {\n    const article = /^[aeiouAEIOU]/.test(this.ruleName) ? 'an' : 'a';\n    description = article + ' ' + this.ruleName;\n  }\n  return new Failure(this, description, 'description');\n};\n\npexprs.UnicodeChar.prototype.toFailure = function (grammar) {\n  return new Failure(this, 'a Unicode [' + this.categoryOrProp + '] character', 'description');\n};\n\npexprs.Alt.prototype.toFailure = function (grammar) {\n  const fs = this.terms.map(t => t.toFailure(grammar));\n  const description = '(' + fs.join(' or ') + ')';\n  return new Failure(this, description, 'description');\n};\n\npexprs.Seq.prototype.toFailure = function (grammar) {\n  const fs = this.factors.map(f => f.toFailure(grammar));\n  const description = '(' + fs.join(' ') + ')';\n  return new Failure(this, description, 'description');\n};\n\npexprs.Iter.prototype.toFailure = function (grammar) {\n  const description = '(' + this.expr.toFailure(grammar) + this.operator + ')';\n  return new Failure(this, description, 'description');\n};\n", "import {abstract} from './common.js';\nimport * as pexprs from './pexprs-main.js';\n\n// --------------------------------------------------------------------\n// Operations\n// --------------------------------------------------------------------\n\n/*\n  e1.toString() === e2.toString() ==> e1 and e2 are semantically equivalent.\n  Note that this is not an iff (<==>): e.g.,\n  (~\"b\" \"a\").toString() !== (\"a\").toString(), even though\n  ~\"b\" \"a\" and \"a\" are interchangeable in any grammar,\n  both in terms of the languages they accept and their arities.\n*/\npexprs.PExpr.prototype.toString = abstract('toString');\n\npexprs.any.toString = function () {\n  return 'any';\n};\n\npexprs.end.toString = function () {\n  return 'end';\n};\n\npexprs.Terminal.prototype.toString = function () {\n  return JSON.stringify(this.obj);\n};\n\npexprs.Range.prototype.toString = function () {\n  return JSON.stringify(this.from) + '..' + JSON.stringify(this.to);\n};\n\npexprs.Param.prototype.toString = function () {\n  return '$' + this.index;\n};\n\npexprs.Lex.prototype.toString = function () {\n  return '#(' + this.expr.toString() + ')';\n};\n\npexprs.Alt.prototype.toString = function () {\n  return this.terms.length === 1\n    ? this.terms[0].toString()\n    : '(' + this.terms.map(term => term.toString()).join(' | ') + ')';\n};\n\npexprs.Seq.prototype.toString = function () {\n  return this.factors.length === 1\n    ? this.factors[0].toString()\n    : '(' + this.factors.map(factor => factor.toString()).join(' ') + ')';\n};\n\npexprs.Iter.prototype.toString = function () {\n  return this.expr + this.operator;\n};\n\npexprs.Not.prototype.toString = function () {\n  return '~' + this.expr;\n};\n\npexprs.Lookahead.prototype.toString = function () {\n  return '&' + this.expr;\n};\n\npexprs.Apply.prototype.toString = function () {\n  if (this.args.length > 0) {\n    const ps = this.args.map(arg => arg.toString());\n    return this.ruleName + '<' + ps.join(',') + '>';\n  } else {\n    return this.ruleName;\n  }\n};\n\npexprs.UnicodeChar.prototype.toString = function () {\n  return '\\\\p{' + this.categoryOrProp + '}';\n};\n", "import {Failure} from './Failure.js';\nimport {TerminalNode} from './nodes.js';\nimport {assert} from './common.js';\nimport {PExpr, Terminal} from './pexprs-main.js';\n\nexport class CaseInsensitiveTerminal extends PExpr {\n  constructor(param) {\n    super();\n    this.obj = param;\n  }\n\n  _getString(state) {\n    const terminal = state.currentApplication().args[this.obj.index];\n    assert(terminal instanceof Terminal, 'expected a Terminal expression');\n    return terminal.obj;\n  }\n\n  // Implementation of the PExpr API\n\n  allowsSkippingPrecedingSpace() {\n    return true;\n  }\n\n  eval(state) {\n    const {inputStream} = state;\n    const origPos = inputStream.pos;\n    const matchStr = this._getString(state);\n    if (!inputStream.matchString(matchStr, true)) {\n      state.processFailure(origPos, this);\n      return false;\n    } else {\n      state.pushBinding(new TerminalNode(matchStr.length), origPos);\n      return true;\n    }\n  }\n\n  getArity() {\n    return 1;\n  }\n\n  substituteParams(actuals) {\n    return new CaseInsensitiveTerminal(this.obj.substituteParams(actuals));\n  }\n\n  toDisplayString() {\n    return this.obj.toDisplayString() + ' (case-insensitive)';\n  }\n\n  toFailure(grammar) {\n    return new Failure(\n      this,\n      this.obj.toFailure(grammar) + ' (case-insensitive)',\n      'description'\n    );\n  }\n\n  _isNullable(grammar, memo) {\n    return this.obj._isNullable(grammar, memo);\n  }\n}\n", "// --------------------------------------------------------------------\n// Extensions\n// --------------------------------------------------------------------\n\nimport './pexprs-allowsSkippingPrecedingSpace.js';\nimport './pexprs-assertAllApplicationsAreValid.js';\nimport './pexprs-assertChoicesHaveUniformArity.js';\nimport './pexprs-assertIteratedExprsAreNotNullable.js';\nimport './pexprs-eval.js';\nimport './pexprs-getArity.js';\nimport './pexprs-outputRecipe.js';\nimport './pexprs-introduceParams.js';\nimport './pexprs-isNullable.js';\nimport './pexprs-substituteParams.js';\nimport './pexprs-toArgumentNameList.js';\nimport './pexprs-toDisplayString.js';\nimport './pexprs-toFailure.js';\nimport './pexprs-toString.js';\n\nexport * from './pexprs-main.js';\nexport {CaseInsensitiveTerminal} from './CaseInsensitiveTerminal.js';\n", "import {InputStream} from './InputStream.js';\nimport {MatchResult} from './MatchResult.js';\nimport {PosInfo} from './PosInfo.js';\nimport {Trace} from './Trace.js';\nimport * as pexprs from './pexprs.js';\nimport * as util from './util.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nlet builtInApplySyntacticBody;\n\nutil.awaitBuiltInRules(builtInRules => {\n  builtInApplySyntacticBody = builtInRules.rules.applySyntactic.body;\n});\n\nconst applySpaces = new pexprs.Apply('spaces');\n\nexport class MatchState {\n  constructor(matcher, startExpr, optPositionToRecordFailures) {\n    this.matcher = matcher;\n    this.startExpr = startExpr;\n\n    this.grammar = matcher.grammar;\n    this.input = matcher.getInput();\n    this.inputStream = new InputStream(this.input);\n    this.memoTable = matcher._memoTable;\n\n    this.userData = undefined;\n    this.doNotMemoize = false;\n\n    this._bindings = [];\n    this._bindingOffsets = [];\n    this._applicationStack = [];\n    this._posStack = [0];\n    this.inLexifiedContextStack = [false];\n\n    this.rightmostFailurePosition = -1;\n    this._rightmostFailurePositionStack = [];\n    this._recordedFailuresStack = [];\n\n    if (optPositionToRecordFailures !== undefined) {\n      this.positionToRecordFailures = optPositionToRecordFailures;\n      this.recordedFailures = Object.create(null);\n    }\n  }\n\n  posToOffset(pos) {\n    return pos - this._posStack[this._posStack.length - 1];\n  }\n\n  enterApplication(posInfo, app) {\n    this._posStack.push(this.inputStream.pos);\n    this._applicationStack.push(app);\n    this.inLexifiedContextStack.push(false);\n    posInfo.enter(app);\n    this._rightmostFailurePositionStack.push(this.rightmostFailurePosition);\n    this.rightmostFailurePosition = -1;\n  }\n\n  exitApplication(posInfo, optNode) {\n    const origPos = this._posStack.pop();\n    this._applicationStack.pop();\n    this.inLexifiedContextStack.pop();\n    posInfo.exit();\n\n    this.rightmostFailurePosition = Math.max(\n      this.rightmostFailurePosition,\n      this._rightmostFailurePositionStack.pop()\n    );\n\n    if (optNode) {\n      this.pushBinding(optNode, origPos);\n    }\n  }\n\n  enterLexifiedContext() {\n    this.inLexifiedContextStack.push(true);\n  }\n\n  exitLexifiedContext() {\n    this.inLexifiedContextStack.pop();\n  }\n\n  currentApplication() {\n    return this._applicationStack[this._applicationStack.length - 1];\n  }\n\n  inSyntacticContext() {\n    const currentApplication = this.currentApplication();\n    if (currentApplication) {\n      return currentApplication.isSyntactic() && !this.inLexifiedContext();\n    } else {\n      // The top-level context is syntactic if the start application is.\n      return this.startExpr.factors[0].isSyntactic();\n    }\n  }\n\n  inLexifiedContext() {\n    return this.inLexifiedContextStack[this.inLexifiedContextStack.length - 1];\n  }\n\n  skipSpaces() {\n    this.pushFailuresInfo();\n    this.eval(applySpaces);\n    this.popBinding();\n    this.popFailuresInfo();\n    return this.inputStream.pos;\n  }\n\n  skipSpacesIfInSyntacticContext() {\n    return this.inSyntacticContext() ? this.skipSpaces() : this.inputStream.pos;\n  }\n\n  maybeSkipSpacesBefore(expr) {\n    if (expr.allowsSkippingPrecedingSpace() && expr !== applySpaces) {\n      return this.skipSpacesIfInSyntacticContext();\n    } else {\n      return this.inputStream.pos;\n    }\n  }\n\n  pushBinding(node, origPos) {\n    this._bindings.push(node);\n    this._bindingOffsets.push(this.posToOffset(origPos));\n  }\n\n  popBinding() {\n    this._bindings.pop();\n    this._bindingOffsets.pop();\n  }\n\n  numBindings() {\n    return this._bindings.length;\n  }\n\n  truncateBindings(newLength) {\n    // Yes, this is this really faster than setting the `length` property (tested with\n    // bin/es5bench on Node v6.1.0).\n    // Update 2021-10-25: still true on v14.15.5 — it's ~20% speedup on es5bench.\n    while (this._bindings.length > newLength) {\n      this.popBinding();\n    }\n  }\n\n  getCurrentPosInfo() {\n    return this.getPosInfo(this.inputStream.pos);\n  }\n\n  getPosInfo(pos) {\n    let posInfo = this.memoTable[pos];\n    if (!posInfo) {\n      posInfo = this.memoTable[pos] = new PosInfo();\n    }\n    return posInfo;\n  }\n\n  processFailure(pos, expr) {\n    this.rightmostFailurePosition = Math.max(this.rightmostFailurePosition, pos);\n\n    if (this.recordedFailures && pos === this.positionToRecordFailures) {\n      const app = this.currentApplication();\n      if (app) {\n        // Substitute parameters with the actual pexprs that were passed to\n        // the current rule.\n        expr = expr.substituteParams(app.args);\n      } else {\n        // This branch is only reached for the \"end-check\" that is\n        // performed after the top-level application. In that case,\n        // expr === pexprs.end so there is no need to substitute\n        // parameters.\n      }\n\n      this.recordFailure(expr.toFailure(this.grammar), false);\n    }\n  }\n\n  recordFailure(failure, shouldCloneIfNew) {\n    const key = failure.toKey();\n    if (!this.recordedFailures[key]) {\n      this.recordedFailures[key] = shouldCloneIfNew ? failure.clone() : failure;\n    } else if (this.recordedFailures[key].isFluffy() && !failure.isFluffy()) {\n      this.recordedFailures[key].clearFluffy();\n    }\n  }\n\n  recordFailures(failures, shouldCloneIfNew) {\n    Object.keys(failures).forEach(key => {\n      this.recordFailure(failures[key], shouldCloneIfNew);\n    });\n  }\n\n  cloneRecordedFailures() {\n    if (!this.recordedFailures) {\n      return undefined;\n    }\n\n    const ans = Object.create(null);\n    Object.keys(this.recordedFailures).forEach(key => {\n      ans[key] = this.recordedFailures[key].clone();\n    });\n    return ans;\n  }\n\n  getRightmostFailurePosition() {\n    return this.rightmostFailurePosition;\n  }\n\n  _getRightmostFailureOffset() {\n    return this.rightmostFailurePosition >= 0\n      ? this.posToOffset(this.rightmostFailurePosition)\n      : -1;\n  }\n\n  // Returns the memoized trace entry for `expr` at `pos`, if one exists, `null` otherwise.\n  getMemoizedTraceEntry(pos, expr) {\n    const posInfo = this.memoTable[pos];\n    if (posInfo && expr instanceof pexprs.Apply) {\n      const memoRec = posInfo.memo[expr.toMemoKey()];\n      if (memoRec && memoRec.traceEntry) {\n        const entry = memoRec.traceEntry.cloneWithExpr(expr);\n        entry.isMemoized = true;\n        return entry;\n      }\n    }\n    return null;\n  }\n\n  // Returns a new trace entry, with the currently active trace array as its children.\n  getTraceEntry(pos, expr, succeeded, bindings) {\n    if (expr instanceof pexprs.Apply) {\n      const app = this.currentApplication();\n      const actuals = app ? app.args : [];\n      expr = expr.substituteParams(actuals);\n    }\n    return (\n      this.getMemoizedTraceEntry(pos, expr) ||\n      new Trace(this.input, pos, this.inputStream.pos, expr, succeeded, bindings, this.trace)\n    );\n  }\n\n  isTracing() {\n    return !!this.trace;\n  }\n\n  hasNecessaryInfo(memoRec) {\n    if (this.trace && !memoRec.traceEntry) {\n      return false;\n    }\n\n    if (\n      this.recordedFailures &&\n      this.inputStream.pos + memoRec.rightmostFailureOffset === this.positionToRecordFailures\n    ) {\n      return !!memoRec.failuresAtRightmostPosition;\n    }\n\n    return true;\n  }\n\n  useMemoizedResult(origPos, memoRec) {\n    if (this.trace) {\n      this.trace.push(memoRec.traceEntry);\n    }\n\n    const memoRecRightmostFailurePosition =\n      this.inputStream.pos + memoRec.rightmostFailureOffset;\n    this.rightmostFailurePosition = Math.max(\n      this.rightmostFailurePosition,\n      memoRecRightmostFailurePosition\n    );\n    if (\n      this.recordedFailures &&\n      this.positionToRecordFailures === memoRecRightmostFailurePosition &&\n      memoRec.failuresAtRightmostPosition\n    ) {\n      this.recordFailures(memoRec.failuresAtRightmostPosition, true);\n    }\n\n    this.inputStream.examinedLength = Math.max(\n      this.inputStream.examinedLength,\n      memoRec.examinedLength + origPos\n    );\n\n    if (memoRec.value) {\n      this.inputStream.pos += memoRec.matchLength;\n      this.pushBinding(memoRec.value, origPos);\n      return true;\n    }\n    return false;\n  }\n\n  // Evaluate `expr` and return `true` if it succeeded, `false` otherwise. On success, `bindings`\n  // will have `expr.getArity()` more elements than before, and the input stream's position may\n  // have increased. On failure, `bindings` and position will be unchanged.\n  eval(expr) {\n    const {inputStream} = this;\n    const origNumBindings = this._bindings.length;\n    const origUserData = this.userData;\n\n    let origRecordedFailures;\n    if (this.recordedFailures) {\n      origRecordedFailures = this.recordedFailures;\n      this.recordedFailures = Object.create(null);\n    }\n\n    const origPos = inputStream.pos;\n    const memoPos = this.maybeSkipSpacesBefore(expr);\n\n    let origTrace;\n    if (this.trace) {\n      origTrace = this.trace;\n      this.trace = [];\n    }\n\n    // Do the actual evaluation.\n    const ans = expr.eval(this);\n\n    if (this.trace) {\n      const bindings = this._bindings.slice(origNumBindings);\n      const traceEntry = this.getTraceEntry(memoPos, expr, ans, bindings);\n      traceEntry.isImplicitSpaces = expr === applySpaces;\n      traceEntry.isRootNode = expr === this.startExpr;\n      origTrace.push(traceEntry);\n      this.trace = origTrace;\n    }\n\n    if (ans) {\n      if (this.recordedFailures && inputStream.pos === this.positionToRecordFailures) {\n        Object.keys(this.recordedFailures).forEach(key => {\n          this.recordedFailures[key].makeFluffy();\n        });\n      }\n    } else {\n      // Reset the position, bindings, and userData.\n      inputStream.pos = origPos;\n      this.truncateBindings(origNumBindings);\n      this.userData = origUserData;\n    }\n\n    if (this.recordedFailures) {\n      this.recordFailures(origRecordedFailures, false);\n    }\n\n    // The built-in applySyntactic rule needs special handling: we want to skip\n    // trailing spaces, just as with the top-level application of a syntactic rule.\n    if (expr === builtInApplySyntacticBody) {\n      this.skipSpaces();\n    }\n\n    return ans;\n  }\n\n  getMatchResult() {\n    this.grammar._setUpMatchState(this);\n    this.eval(this.startExpr);\n    let rightmostFailures;\n    if (this.recordedFailures) {\n      rightmostFailures = Object.keys(this.recordedFailures).map(\n        key => this.recordedFailures[key]\n      );\n    }\n    const cst = this._bindings[0];\n    if (cst) {\n      cst.grammar = this.grammar;\n    }\n    return new MatchResult(\n      this.matcher,\n      this.input,\n      this.startExpr,\n      cst,\n      this._bindingOffsets[0],\n      this.rightmostFailurePosition,\n      rightmostFailures\n    );\n  }\n\n  getTrace() {\n    this.trace = [];\n    const matchResult = this.getMatchResult();\n\n    // The trace node for the start rule is always the last entry. If it is a syntactic rule,\n    // the first entry is for an application of 'spaces'.\n    // TODO(pdubroy): Clean this up by introducing a special `Match<startAppl>` rule, which will\n    // ensure that there is always a single root trace node.\n    const rootTrace = this.trace[this.trace.length - 1];\n    rootTrace.result = matchResult;\n    return rootTrace;\n  }\n\n  pushFailuresInfo() {\n    this._rightmostFailurePositionStack.push(this.rightmostFailurePosition);\n    this._recordedFailuresStack.push(this.recordedFailures);\n  }\n\n  popFailuresInfo() {\n    this.rightmostFailurePosition = this._rightmostFailurePositionStack.pop();\n    this.recordedFailures = this._recordedFailuresStack.pop();\n  }\n}\n", "import {grammarDoesNotSupportIncrementalParsing} from './errors.js';\nimport {MatchState} from './MatchState.js';\nimport * as pexprs from './pexprs.js';\n\nexport class Matcher {\n  constructor(grammar) {\n    this.grammar = grammar;\n    this._memoTable = [];\n    this._input = '';\n    this._isMemoTableStale = false;\n  }\n\n  _resetMemoTable() {\n    this._memoTable = [];\n    this._isMemoTableStale = false;\n  }\n\n  getInput() {\n    return this._input;\n  }\n\n  setInput(str) {\n    if (this._input !== str) {\n      this.replaceInputRange(0, this._input.length, str);\n    }\n    return this;\n  }\n\n  replaceInputRange(startIdx, endIdx, str) {\n    const prevInput = this._input;\n    const memoTable = this._memoTable;\n    if (\n      startIdx < 0 ||\n      startIdx > prevInput.length ||\n      endIdx < 0 ||\n      endIdx > prevInput.length ||\n      startIdx > endIdx\n    ) {\n      throw new Error('Invalid indices: ' + startIdx + ' and ' + endIdx);\n    }\n\n    // update input\n    this._input = prevInput.slice(0, startIdx) + str + prevInput.slice(endIdx);\n    if (this._input !== prevInput && memoTable.length > 0) {\n      this._isMemoTableStale = true;\n    }\n\n    // update memo table (similar to the above)\n    const restOfMemoTable = memoTable.slice(endIdx);\n    memoTable.length = startIdx;\n    for (let idx = 0; idx < str.length; idx++) {\n      memoTable.push(undefined);\n    }\n    for (const posInfo of restOfMemoTable) {\n      memoTable.push(posInfo);\n    }\n\n    // Invalidate memoRecs\n    for (let pos = 0; pos < startIdx; pos++) {\n      const posInfo = memoTable[pos];\n      if (posInfo) {\n        posInfo.clearObsoleteEntries(pos, startIdx);\n      }\n    }\n\n    return this;\n  }\n\n  match(optStartApplicationStr, options = {incremental: true}) {\n    return this._match(this._getStartExpr(optStartApplicationStr), {\n      incremental: options.incremental,\n      tracing: false,\n    });\n  }\n\n  trace(optStartApplicationStr, options = {incremental: true}) {\n    return this._match(this._getStartExpr(optStartApplicationStr), {\n      incremental: options.incremental,\n      tracing: true,\n    });\n  }\n\n  _match(startExpr, options = {}) {\n    const opts = {\n      tracing: false,\n      incremental: true,\n      positionToRecordFailures: undefined,\n      ...options,\n    };\n    if (!opts.incremental) {\n      this._resetMemoTable();\n    } else if (this._isMemoTableStale && !this.grammar.supportsIncrementalParsing) {\n      throw grammarDoesNotSupportIncrementalParsing(this.grammar);\n    }\n\n    const state = new MatchState(this, startExpr, opts.positionToRecordFailures);\n    return opts.tracing ? state.getTrace() : state.getMatchResult();\n  }\n\n  /*\n    Returns the starting expression for this Matcher's associated grammar. If\n    `optStartApplicationStr` is specified, it is a string expressing a rule application in the\n    grammar. If not specified, the grammar's default start rule will be used.\n  */\n  _getStartExpr(optStartApplicationStr) {\n    const applicationStr = optStartApplicationStr || this.grammar.defaultStartRule;\n    if (!applicationStr) {\n      throw new Error('Missing start rule argument -- the grammar has no default start rule.');\n    }\n\n    const startApp = this.grammar.parseApplication(applicationStr);\n    return new pexprs.Seq([startApp, pexprs.end]);\n  }\n}\n", "import {InputStream} from './InputStream.js';\nimport {IterationNode} from './nodes.js';\nimport {MatchResult} from './MatchResult.js';\nimport * as common from './common.js';\nimport * as errors from './errors.js';\nimport * as util from './util.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nconst globalActionStack = [];\n\nconst hasOwnProperty = (x, prop) => Object.prototype.hasOwnProperty.call(x, prop);\n\n// ----------------- Wrappers -----------------\n\n// Wrappers decorate CST nodes with all of the functionality (i.e., operations and attributes)\n// provided by a Semantics (see below). `Wrapper` is the abstract superclass of all wrappers. A\n// `Wrapper` must have `_node` and `_semantics` instance variables, which refer to the CST node and\n// Semantics (resp.) for which it was created, and a `_childWrappers` instance variable which is\n// used to cache the wrapper instances that are created for its child nodes. Setting these instance\n// variables is the responsibility of the constructor of each Semantics-specific subclass of\n// `Wrapper`.\nclass Wrapper {\n  constructor(node, sourceInterval, baseInterval) {\n    this._node = node;\n    this.source = sourceInterval;\n\n    // The interval that the childOffsets of `node` are relative to. It should be the source\n    // of the closest Nonterminal node.\n    this._baseInterval = baseInterval;\n\n    if (node.isNonterminal()) {\n      common.assert(sourceInterval === baseInterval);\n    }\n    this._childWrappers = [];\n  }\n\n  _forgetMemoizedResultFor(attributeName) {\n    // Remove the memoized attribute from the cstNode and all its children.\n    delete this._node[this._semantics.attributeKeys[attributeName]];\n    this.children.forEach(child => {\n      child._forgetMemoizedResultFor(attributeName);\n    });\n  }\n\n  // Returns the wrapper of the specified child node. Child wrappers are created lazily and\n  // cached in the parent wrapper's `_childWrappers` instance variable.\n  child(idx) {\n    if (!(0 <= idx && idx < this._node.numChildren())) {\n      // TODO: Consider throwing an exception here.\n      return undefined;\n    }\n    let childWrapper = this._childWrappers[idx];\n    if (!childWrapper) {\n      const childNode = this._node.childAt(idx);\n      const offset = this._node.childOffsets[idx];\n\n      const source = this._baseInterval.subInterval(offset, childNode.matchLength);\n      const base = childNode.isNonterminal() ? source : this._baseInterval;\n      childWrapper = this._childWrappers[idx] = this._semantics.wrap(childNode, source, base);\n    }\n    return childWrapper;\n  }\n\n  // Returns an array containing the wrappers of all of the children of the node associated\n  // with this wrapper.\n  _children() {\n    // Force the creation of all child wrappers\n    for (let idx = 0; idx < this._node.numChildren(); idx++) {\n      this.child(idx);\n    }\n    return this._childWrappers;\n  }\n\n  // Returns `true` if the CST node associated with this wrapper corresponds to an iteration\n  // expression, i.e., a Kleene-*, Kleene-+, or an optional. Returns `false` otherwise.\n  isIteration() {\n    return this._node.isIteration();\n  }\n\n  // Returns `true` if the CST node associated with this wrapper is a terminal node, `false`\n  // otherwise.\n  isTerminal() {\n    return this._node.isTerminal();\n  }\n\n  // Returns `true` if the CST node associated with this wrapper is a nonterminal node, `false`\n  // otherwise.\n  isNonterminal() {\n    return this._node.isNonterminal();\n  }\n\n  // Returns `true` if the CST node associated with this wrapper is a nonterminal node\n  // corresponding to a syntactic rule, `false` otherwise.\n  isSyntactic() {\n    return this.isNonterminal() && this._node.isSyntactic();\n  }\n\n  // Returns `true` if the CST node associated with this wrapper is a nonterminal node\n  // corresponding to a lexical rule, `false` otherwise.\n  isLexical() {\n    return this.isNonterminal() && this._node.isLexical();\n  }\n\n  // Returns `true` if the CST node associated with this wrapper is an iterator node\n  // having either one or no child (? operator), `false` otherwise.\n  // Otherwise, throws an exception.\n  isOptional() {\n    return this._node.isOptional();\n  }\n\n  // Create a new _iter wrapper in the same semantics as this wrapper.\n  iteration(optChildWrappers) {\n    const childWrappers = optChildWrappers || [];\n\n    const childNodes = childWrappers.map(c => c._node);\n    const iter = new IterationNode(childNodes, [], -1, false);\n\n    const wrapper = this._semantics.wrap(iter, null, null);\n    wrapper._childWrappers = childWrappers;\n    return wrapper;\n  }\n\n  // Returns an array containing the children of this CST node.\n  get children() {\n    return this._children();\n  }\n\n  // Returns the name of grammar rule that created this CST node.\n  get ctorName() {\n    return this._node.ctorName;\n  }\n\n  // Returns the number of children of this CST node.\n  get numChildren() {\n    return this._node.numChildren();\n  }\n\n  // Returns the contents of the input stream consumed by this CST node.\n  get sourceString() {\n    return this.source.contents;\n  }\n}\n\n// ----------------- Semantics -----------------\n\n// A Semantics is a container for a family of Operations and Attributes for a given grammar.\n// Semantics enable modularity (different clients of a grammar can create their set of operations\n// and attributes in isolation) and extensibility even when operations and attributes are mutually-\n// recursive. This constructor should not be called directly except from\n// `Semantics.createSemantics`. The normal ways to create a Semantics, given a grammar 'g', are\n// `g.createSemantics()` and `g.extendSemantics(parentSemantics)`.\nexport class Semantics {\n  constructor(grammar, superSemantics) {\n    const self = this;\n    this.grammar = grammar;\n    this.checkedActionDicts = false;\n\n    // Constructor for wrapper instances, which are passed as the arguments to the semantic actions\n    // of an operation or attribute. Operations and attributes require double dispatch: the semantic\n    // action is chosen based on both the node's type and the semantics. Wrappers ensure that\n    // the `execute` method is called with the correct (most specific) semantics object as an\n    // argument.\n    this.Wrapper = class extends (superSemantics ? superSemantics.Wrapper : Wrapper) {\n      constructor(node, sourceInterval, baseInterval) {\n        super(node, sourceInterval, baseInterval);\n        self.checkActionDictsIfHaventAlready();\n        this._semantics = self;\n      }\n\n      toString() {\n        return '[semantics wrapper for ' + self.grammar.name + ']';\n      }\n    };\n\n    this.super = superSemantics;\n    if (superSemantics) {\n      if (!(grammar.equals(this.super.grammar) || grammar._inheritsFrom(this.super.grammar))) {\n        throw new Error(\n          \"Cannot extend a semantics for grammar '\" +\n            this.super.grammar.name +\n            \"' for use with grammar '\" +\n            grammar.name +\n            \"' (not a sub-grammar)\"\n        );\n      }\n      this.operations = Object.create(this.super.operations);\n      this.attributes = Object.create(this.super.attributes);\n      this.attributeKeys = Object.create(null);\n\n      // Assign unique symbols for each of the attributes inherited from the super-semantics so that\n      // they are memoized independently.\n\n      for (const attributeName in this.attributes) {\n        Object.defineProperty(this.attributeKeys, attributeName, {\n          value: util.uniqueId(attributeName),\n        });\n      }\n    } else {\n      this.operations = Object.create(null);\n      this.attributes = Object.create(null);\n      this.attributeKeys = Object.create(null);\n    }\n  }\n\n  toString() {\n    return '[semantics for ' + this.grammar.name + ']';\n  }\n\n  checkActionDictsIfHaventAlready() {\n    if (!this.checkedActionDicts) {\n      this.checkActionDicts();\n      this.checkedActionDicts = true;\n    }\n  }\n\n  // Checks that the action dictionaries for all operations and attributes in this semantics,\n  // including the ones that were inherited from the super-semantics, agree with the grammar.\n  // Throws an exception if one or more of them doesn't.\n  checkActionDicts() {\n    let name;\n\n    for (name in this.operations) {\n      this.operations[name].checkActionDict(this.grammar);\n    }\n\n    for (name in this.attributes) {\n      this.attributes[name].checkActionDict(this.grammar);\n    }\n  }\n\n  toRecipe(semanticsOnly) {\n    function hasSuperSemantics(s) {\n      return s.super !== Semantics.BuiltInSemantics._getSemantics();\n    }\n\n    let str = '(function(g) {\\n';\n    if (hasSuperSemantics(this)) {\n      str += '  var semantics = ' + this.super.toRecipe(true) + '(g';\n\n      const superSemanticsGrammar = this.super.grammar;\n      let relatedGrammar = this.grammar;\n      while (relatedGrammar !== superSemanticsGrammar) {\n        str += '.superGrammar';\n        relatedGrammar = relatedGrammar.superGrammar;\n      }\n\n      str += ');\\n';\n      str += '  return g.extendSemantics(semantics)';\n    } else {\n      str += '  return g.createSemantics()';\n    }\n    ['Operation', 'Attribute'].forEach(type => {\n      const semanticOperations = this[type.toLowerCase() + 's'];\n      Object.keys(semanticOperations).forEach(name => {\n        const {actionDict, formals, builtInDefault} = semanticOperations[name];\n\n        let signature = name;\n        if (formals.length > 0) {\n          signature += '(' + formals.join(', ') + ')';\n        }\n\n        let method;\n        if (hasSuperSemantics(this) && this.super[type.toLowerCase() + 's'][name]) {\n          method = 'extend' + type;\n        } else {\n          method = 'add' + type;\n        }\n        str += '\\n    .' + method + '(' + JSON.stringify(signature) + ', {';\n\n        const srcArray = [];\n        Object.keys(actionDict).forEach(actionName => {\n          if (actionDict[actionName] !== builtInDefault) {\n            let source = actionDict[actionName].toString().trim();\n\n            // Convert method shorthand to plain old function syntax.\n            // https://github.com/ohmjs/ohm/issues/263\n            source = source.replace(/^.*\\(/, 'function(');\n\n            srcArray.push('\\n      ' + JSON.stringify(actionName) + ': ' + source);\n          }\n        });\n        str += srcArray.join(',') + '\\n    })';\n      });\n    });\n    str += ';\\n  })';\n\n    if (!semanticsOnly) {\n      str =\n        '(function() {\\n' +\n        '  var grammar = this.fromRecipe(' +\n        this.grammar.toRecipe() +\n        ');\\n' +\n        '  var semantics = ' +\n        str +\n        '(grammar);\\n' +\n        '  return semantics;\\n' +\n        '});\\n';\n    }\n\n    return str;\n  }\n\n  addOperationOrAttribute(type, signature, actionDict) {\n    const typePlural = type + 's';\n\n    const parsedNameAndFormalArgs = parseSignature(signature, type);\n    const {name} = parsedNameAndFormalArgs;\n    const {formals} = parsedNameAndFormalArgs;\n\n    // TODO: check that there are no duplicate formal arguments\n\n    this.assertNewName(name, type);\n\n    // Create the action dictionary for this operation / attribute that contains a `_default` action\n    // which defines the default behavior of iteration, terminal, and non-terminal nodes...\n    const builtInDefault = newDefaultAction(type, name, doIt);\n    const realActionDict = {_default: builtInDefault};\n    // ... and add in the actions supplied by the programmer, which may override some or all of the\n    // default ones.\n    Object.keys(actionDict).forEach(name => {\n      realActionDict[name] = actionDict[name];\n    });\n\n    const entry =\n      type === 'operation'\n        ? new Operation(name, formals, realActionDict, builtInDefault)\n        : new Attribute(name, realActionDict, builtInDefault);\n\n    // The following check is not strictly necessary (it will happen later anyway) but it's better\n    // to catch errors early.\n    entry.checkActionDict(this.grammar);\n\n    this[typePlural][name] = entry;\n\n    function doIt(...args) {\n      // Dispatch to most specific version of this operation / attribute -- it may have been\n      // overridden by a sub-semantics.\n      const thisThing = this._semantics[typePlural][name];\n\n      // Check that the caller passed the correct number of arguments.\n      if (arguments.length !== thisThing.formals.length) {\n        throw new Error(\n          'Invalid number of arguments passed to ' +\n            name +\n            ' ' +\n            type +\n            ' (expected ' +\n            thisThing.formals.length +\n            ', got ' +\n            arguments.length +\n            ')'\n        );\n      }\n\n      // Create an \"arguments object\" from the arguments that were passed to this\n      // operation / attribute.\n      const argsObj = Object.create(null);\n      for (const [idx, val] of Object.entries(args)) {\n        const formal = thisThing.formals[idx];\n        argsObj[formal] = val;\n      }\n\n      const oldArgs = this.args;\n      this.args = argsObj;\n      const ans = thisThing.execute(this._semantics, this);\n      this.args = oldArgs;\n      return ans;\n    }\n\n    if (type === 'operation') {\n      this.Wrapper.prototype[name] = doIt;\n      this.Wrapper.prototype[name].toString = function () {\n        return '[' + name + ' operation]';\n      };\n    } else {\n      Object.defineProperty(this.Wrapper.prototype, name, {\n        get: doIt,\n        configurable: true, // So the property can be deleted.\n      });\n      Object.defineProperty(this.attributeKeys, name, {\n        value: util.uniqueId(name),\n      });\n    }\n  }\n\n  extendOperationOrAttribute(type, name, actionDict) {\n    const typePlural = type + 's';\n\n    // Make sure that `name` really is just a name, i.e., that it doesn't also contain formals.\n    parseSignature(name, 'attribute');\n\n    if (!(this.super && name in this.super[typePlural])) {\n      throw new Error(\n        'Cannot extend ' +\n          type +\n          \" '\" +\n          name +\n          \"': did not inherit an \" +\n          type +\n          ' with that name'\n      );\n    }\n    if (hasOwnProperty(this[typePlural], name)) {\n      throw new Error('Cannot extend ' + type + \" '\" + name + \"' again\");\n    }\n\n    // Create a new operation / attribute whose actionDict delegates to the super operation /\n    // attribute's actionDict, and which has all the keys from `inheritedActionDict`.\n    const inheritedFormals = this[typePlural][name].formals;\n    const inheritedActionDict = this[typePlural][name].actionDict;\n    const newActionDict = Object.create(inheritedActionDict);\n    Object.keys(actionDict).forEach(name => {\n      newActionDict[name] = actionDict[name];\n    });\n\n    this[typePlural][name] =\n      type === 'operation'\n        ? new Operation(name, inheritedFormals, newActionDict)\n        : new Attribute(name, newActionDict);\n\n    // The following check is not strictly necessary (it will happen later anyway) but it's better\n    // to catch errors early.\n    this[typePlural][name].checkActionDict(this.grammar);\n  }\n\n  assertNewName(name, type) {\n    if (hasOwnProperty(Wrapper.prototype, name)) {\n      throw new Error('Cannot add ' + type + \" '\" + name + \"': that's a reserved name\");\n    }\n    if (name in this.operations) {\n      throw new Error(\n        'Cannot add ' + type + \" '\" + name + \"': an operation with that name already exists\"\n      );\n    }\n    if (name in this.attributes) {\n      throw new Error(\n        'Cannot add ' + type + \" '\" + name + \"': an attribute with that name already exists\"\n      );\n    }\n  }\n\n  // Returns a wrapper for the given CST `node` in this semantics.\n  // If `node` is already a wrapper, returns `node` itself.  // TODO: why is this needed?\n  wrap(node, source, optBaseInterval) {\n    const baseInterval = optBaseInterval || source;\n    return node instanceof this.Wrapper ? node : new this.Wrapper(node, source, baseInterval);\n  }\n}\n\nfunction parseSignature(signature, type) {\n  if (!Semantics.prototypeGrammar) {\n    // The Operations and Attributes grammar won't be available while Ohm is loading,\n    // but we can get away the following simplification b/c none of the operations\n    // that are used while loading take arguments.\n    common.assert(signature.indexOf('(') === -1);\n    return {\n      name: signature,\n      formals: [],\n    };\n  }\n\n  const r = Semantics.prototypeGrammar.match(\n    signature,\n    type === 'operation' ? 'OperationSignature' : 'AttributeSignature'\n  );\n  if (r.failed()) {\n    throw new Error(r.message);\n  }\n\n  return Semantics.prototypeGrammarSemantics(r).parse();\n}\n\nfunction newDefaultAction(type, name, doIt) {\n  return function (...children) {\n    const thisThing = this._semantics.operations[name] || this._semantics.attributes[name];\n    const args = thisThing.formals.map(formal => this.args[formal]);\n\n    if (!this.isIteration() && children.length === 1) {\n      // This CST node corresponds to a non-terminal in the grammar (e.g., AddExpr). The fact that\n      // we got here means that this action dictionary doesn't have an action for this particular\n      // non-terminal or a generic `_nonterminal` action.\n      // As a convenience, if this node only has one child, we just return the result of applying\n      // this operation / attribute to the child node.\n      return doIt.apply(children[0], args);\n    } else {\n      // Otherwise, we throw an exception to let the programmer know that we don't know what\n      // to do with this node.\n      throw errors.missingSemanticAction(this.ctorName, name, type, globalActionStack);\n    }\n  };\n}\n\n// Creates a new Semantics instance for `grammar`, inheriting operations and attributes from\n// `optSuperSemantics`, if it is specified. Returns a function that acts as a proxy for the new\n// Semantics instance. When that function is invoked with a CST node as an argument, it returns\n// a wrapper for that node which gives access to the operations and attributes provided by this\n// semantics.\nSemantics.createSemantics = function (grammar, optSuperSemantics) {\n  const s = new Semantics(\n    grammar,\n    optSuperSemantics !== undefined\n      ? optSuperSemantics\n      : Semantics.BuiltInSemantics._getSemantics()\n  );\n\n  // To enable clients to invoke a semantics like a function, return a function that acts as a proxy\n  // for `s`, which is the real `Semantics` instance.\n  const proxy = function ASemantics(matchResult) {\n    if (!(matchResult instanceof MatchResult)) {\n      throw new TypeError(\n        'Semantics expected a MatchResult, but got ' +\n          common.unexpectedObjToString(matchResult)\n      );\n    }\n    if (matchResult.failed()) {\n      throw new TypeError('cannot apply Semantics to ' + matchResult.toString());\n    }\n\n    const cst = matchResult._cst;\n    if (cst.grammar !== grammar) {\n      throw new Error(\n        \"Cannot use a MatchResult from grammar '\" +\n          cst.grammar.name +\n          \"' with a semantics for '\" +\n          grammar.name +\n          \"'\"\n      );\n    }\n    const inputStream = new InputStream(matchResult.input);\n    return s.wrap(cst, inputStream.interval(matchResult._cstOffset, matchResult.input.length));\n  };\n\n  // Forward public methods from the proxy to the semantics instance.\n  proxy.addOperation = function (signature, actionDict) {\n    s.addOperationOrAttribute('operation', signature, actionDict);\n    return proxy;\n  };\n  proxy.extendOperation = function (name, actionDict) {\n    s.extendOperationOrAttribute('operation', name, actionDict);\n    return proxy;\n  };\n  proxy.addAttribute = function (name, actionDict) {\n    s.addOperationOrAttribute('attribute', name, actionDict);\n    return proxy;\n  };\n  proxy.extendAttribute = function (name, actionDict) {\n    s.extendOperationOrAttribute('attribute', name, actionDict);\n    return proxy;\n  };\n  proxy._getActionDict = function (operationOrAttributeName) {\n    const action =\n      s.operations[operationOrAttributeName] || s.attributes[operationOrAttributeName];\n    if (!action) {\n      throw new Error(\n        '\"' +\n          operationOrAttributeName +\n          '\" is not a valid operation or attribute ' +\n          'name in this semantics for \"' +\n          grammar.name +\n          '\"'\n      );\n    }\n    return action.actionDict;\n  };\n  proxy._remove = function (operationOrAttributeName) {\n    let semantic;\n    if (operationOrAttributeName in s.operations) {\n      semantic = s.operations[operationOrAttributeName];\n      delete s.operations[operationOrAttributeName];\n    } else if (operationOrAttributeName in s.attributes) {\n      semantic = s.attributes[operationOrAttributeName];\n      delete s.attributes[operationOrAttributeName];\n    }\n    delete s.Wrapper.prototype[operationOrAttributeName];\n    return semantic;\n  };\n  proxy.getOperationNames = function () {\n    return Object.keys(s.operations);\n  };\n  proxy.getAttributeNames = function () {\n    return Object.keys(s.attributes);\n  };\n  proxy.getGrammar = function () {\n    return s.grammar;\n  };\n  proxy.toRecipe = function (semanticsOnly) {\n    return s.toRecipe(semanticsOnly);\n  };\n\n  // Make the proxy's toString() work.\n  proxy.toString = s.toString.bind(s);\n\n  // Returns the semantics for the proxy.\n  proxy._getSemantics = function () {\n    return s;\n  };\n\n  return proxy;\n};\n\n// ----------------- Operation -----------------\n\n// An Operation represents a function to be applied to a concrete syntax tree (CST) -- it's very\n// similar to a Visitor (http://en.wikipedia.org/wiki/Visitor_pattern). An operation is executed by\n// recursively walking the CST, and at each node, invoking the matching semantic action from\n// `actionDict`. See `Operation.prototype.execute` for details of how a CST node's matching semantic\n// action is found.\nclass Operation {\n  constructor(name, formals, actionDict, builtInDefault) {\n    this.name = name;\n    this.formals = formals;\n    this.actionDict = actionDict;\n    this.builtInDefault = builtInDefault;\n  }\n\n  checkActionDict(grammar) {\n    grammar._checkTopDownActionDict(this.typeName, this.name, this.actionDict);\n  }\n\n  // Execute this operation on the CST node associated with `nodeWrapper` in the context of the\n  // given Semantics instance.\n  execute(semantics, nodeWrapper) {\n    try {\n      // Look for a semantic action whose name matches the node's constructor name, which is either\n      // the name of a rule in the grammar, or '_terminal' (for a terminal node), or '_iter' (for an\n      // iteration node).\n      const {ctorName} = nodeWrapper._node;\n      let actionFn = this.actionDict[ctorName];\n      if (actionFn) {\n        globalActionStack.push([this, ctorName]);\n        return actionFn.apply(nodeWrapper, nodeWrapper._children());\n      }\n\n      // The action dictionary does not contain a semantic action for this specific type of node.\n      // If this is a nonterminal node and the programmer has provided a `_nonterminal` semantic\n      // action, we invoke it:\n      if (nodeWrapper.isNonterminal()) {\n        actionFn = this.actionDict._nonterminal;\n        if (actionFn) {\n          globalActionStack.push([this, '_nonterminal', ctorName]);\n          return actionFn.apply(nodeWrapper, nodeWrapper._children());\n        }\n      }\n\n      // Otherwise, we invoke the '_default' semantic action.\n      globalActionStack.push([this, 'default action', ctorName]);\n      return this.actionDict._default.apply(nodeWrapper, nodeWrapper._children());\n    } finally {\n      globalActionStack.pop();\n    }\n  }\n}\n\nOperation.prototype.typeName = 'operation';\n\n// ----------------- Attribute -----------------\n\n// Attributes are Operations whose results are memoized. This means that, for any given semantics,\n// the semantic action for a CST node will be invoked no more than once.\nclass Attribute extends Operation {\n  constructor(name, actionDict, builtInDefault) {\n    super(name, [], actionDict, builtInDefault);\n  }\n\n  execute(semantics, nodeWrapper) {\n    const node = nodeWrapper._node;\n    const key = semantics.attributeKeys[this.name];\n    if (!hasOwnProperty(node, key)) {\n      // The following is a super-send -- isn't JS beautiful? :/\n      node[key] = Operation.prototype.execute.call(this, semantics, nodeWrapper);\n    }\n    return node[key];\n  }\n}\n\nAttribute.prototype.typeName = 'attribute';\n", "import {Matcher} from './Matcher.js';\nimport {Semantics} from './Semantics.js';\nimport * as common from './common.js';\nimport * as errors from './errors.js';\nimport * as pexprs from './pexprs.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nconst SPECIAL_ACTION_NAMES = ['_iter', '_terminal', '_nonterminal', '_default'];\n\nfunction getSortedRuleValues(grammar) {\n  return Object.keys(grammar.rules)\n    .sort()\n    .map(name => grammar.rules[name]);\n}\n\n// Until ES2019, JSON was not a valid subset of JavaScript because U+2028 (line separator)\n// and U+2029 (paragraph separator) are allowed in JSON string literals, but not in JS.\n// This function properly encodes those two characters so that the resulting string is\n// represents both valid JSON, and valid JavaScript (for ES2018 and below).\n// See https://v8.dev/features/subsume-json for more details.\nconst jsonToJS = str => str.replace(/\\u2028/g, '\\\\u2028').replace(/\\u2029/g, '\\\\u2029');\n\nlet ohmGrammar;\nlet buildGrammar;\n\nexport class Grammar {\n  constructor(name, superGrammar, rules, optDefaultStartRule) {\n    this.name = name;\n    this.superGrammar = superGrammar;\n    this.rules = rules;\n    if (optDefaultStartRule) {\n      if (!(optDefaultStartRule in rules)) {\n        throw new Error(\n          \"Invalid start rule: '\" +\n            optDefaultStartRule +\n            \"' is not a rule in grammar '\" +\n            name +\n            \"'\"\n        );\n      }\n      this.defaultStartRule = optDefaultStartRule;\n    }\n    this._matchStateInitializer = undefined;\n    this.supportsIncrementalParsing = true;\n  }\n\n  matcher() {\n    return new Matcher(this);\n  }\n\n  // Return true if the grammar is a built-in grammar, otherwise false.\n  // NOTE: This might give an unexpected result if called before BuiltInRules is defined!\n  isBuiltIn() {\n    return this === Grammar.ProtoBuiltInRules || this === Grammar.BuiltInRules;\n  }\n\n  equals(g) {\n    if (this === g) {\n      return true;\n    }\n    // Do the cheapest comparisons first.\n    if (\n      g == null ||\n      this.name !== g.name ||\n      this.defaultStartRule !== g.defaultStartRule ||\n      !(this.superGrammar === g.superGrammar || this.superGrammar.equals(g.superGrammar))\n    ) {\n      return false;\n    }\n    const myRules = getSortedRuleValues(this);\n    const otherRules = getSortedRuleValues(g);\n    return (\n      myRules.length === otherRules.length &&\n      myRules.every((rule, i) => {\n        return (\n          rule.description === otherRules[i].description &&\n          rule.formals.join(',') === otherRules[i].formals.join(',') &&\n          rule.body.toString() === otherRules[i].body.toString()\n        );\n      })\n    );\n  }\n\n  match(input, optStartApplication) {\n    const m = this.matcher();\n    m.replaceInputRange(0, 0, input);\n    return m.match(optStartApplication);\n  }\n\n  trace(input, optStartApplication) {\n    const m = this.matcher();\n    m.replaceInputRange(0, 0, input);\n    return m.trace(optStartApplication);\n  }\n\n  createSemantics() {\n    return Semantics.createSemantics(this);\n  }\n\n  extendSemantics(superSemantics) {\n    return Semantics.createSemantics(this, superSemantics._getSemantics());\n  }\n\n  // Check that every key in `actionDict` corresponds to a semantic action, and that it maps to\n  // a function of the correct arity. If not, throw an exception.\n  _checkTopDownActionDict(what, name, actionDict) {\n    const problems = [];\n\n    for (const k in actionDict) {\n      const v = actionDict[k];\n      const isSpecialAction = SPECIAL_ACTION_NAMES.includes(k);\n\n      if (!isSpecialAction && !(k in this.rules)) {\n        problems.push(`'${k}' is not a valid semantic action for '${this.name}'`);\n        continue;\n      }\n      if (typeof v !== 'function') {\n        problems.push(`'${k}' must be a function in an action dictionary for '${this.name}'`);\n        continue;\n      }\n      const actual = v.length;\n      const expected = this._topDownActionArity(k);\n      if (actual !== expected) {\n        let details;\n        if (k === '_iter' || k === '_nonterminal') {\n          details =\n            `it should use a rest parameter, e.g. \\`${k}(...children) {}\\`. ` +\n            'NOTE: this is new in Ohm v16 — see https://ohmjs.org/d/ati for details.';\n        } else {\n          details = `expected ${expected}, got ${actual}`;\n        }\n        problems.push(`Semantic action '${k}' has the wrong arity: ${details}`);\n      }\n    }\n    if (problems.length > 0) {\n      const prettyProblems = problems.map(problem => '- ' + problem);\n      const error = new Error(\n        [\n          `Found errors in the action dictionary of the '${name}' ${what}:`,\n          ...prettyProblems,\n        ].join('\\n')\n      );\n      error.problems = problems;\n      throw error;\n    }\n  }\n\n  // Return the expected arity for a semantic action named `actionName`, which\n  // is either a rule name or a special action name like '_nonterminal'.\n  _topDownActionArity(actionName) {\n    // All special actions have an expected arity of 0, though all but _terminal\n    // are expected to use the rest parameter syntax (e.g. `_iter(...children)`).\n    // This is considered to have arity 0, i.e. `((...args) => {}).length` is 0.\n    return SPECIAL_ACTION_NAMES.includes(actionName)\n      ? 0\n      : this.rules[actionName].body.getArity();\n  }\n\n  _inheritsFrom(grammar) {\n    let g = this.superGrammar;\n    while (g) {\n      if (g.equals(grammar, true)) {\n        return true;\n      }\n      g = g.superGrammar;\n    }\n    return false;\n  }\n\n  toRecipe(superGrammarExpr = undefined) {\n    const metaInfo = {};\n    // Include the grammar source if it is available.\n    if (this.source) {\n      metaInfo.source = this.source.contents;\n    }\n\n    let startRule = null;\n    if (this.defaultStartRule) {\n      startRule = this.defaultStartRule;\n    }\n\n    const rules = {};\n    Object.keys(this.rules).forEach(ruleName => {\n      const ruleInfo = this.rules[ruleName];\n      const {body} = ruleInfo;\n      const isDefinition = !this.superGrammar || !this.superGrammar.rules[ruleName];\n\n      let operation;\n      if (isDefinition) {\n        operation = 'define';\n      } else {\n        operation = body instanceof pexprs.Extend ? 'extend' : 'override';\n      }\n\n      const metaInfo = {};\n      if (ruleInfo.source && this.source) {\n        const adjusted = ruleInfo.source.relativeTo(this.source);\n        metaInfo.sourceInterval = [adjusted.startIdx, adjusted.endIdx];\n      }\n\n      const description = isDefinition ? ruleInfo.description : null;\n      const bodyRecipe = body.outputRecipe(ruleInfo.formals, this.source);\n\n      rules[ruleName] = [\n        operation, // \"define\"/\"extend\"/\"override\"\n        metaInfo,\n        description,\n        ruleInfo.formals,\n        bodyRecipe,\n      ];\n    });\n\n    // If the caller provided an expression to use for the supergrammar, use that.\n    // Otherwise, if the supergrammar is a user grammar, use its recipe inline.\n    let superGrammarOutput = 'null';\n    if (superGrammarExpr) {\n      superGrammarOutput = superGrammarExpr;\n    } else if (this.superGrammar && !this.superGrammar.isBuiltIn()) {\n      superGrammarOutput = this.superGrammar.toRecipe();\n    }\n\n    const recipeElements = [\n      ...['grammar', metaInfo, this.name].map(JSON.stringify),\n      superGrammarOutput,\n      ...[startRule, rules].map(JSON.stringify),\n    ];\n    return jsonToJS(`[${recipeElements.join(',')}]`);\n  }\n\n  // TODO: Come up with better names for these methods.\n  // TODO: Write the analog of these methods for inherited attributes.\n  toOperationActionDictionaryTemplate() {\n    return this._toOperationOrAttributeActionDictionaryTemplate();\n  }\n  toAttributeActionDictionaryTemplate() {\n    return this._toOperationOrAttributeActionDictionaryTemplate();\n  }\n\n  _toOperationOrAttributeActionDictionaryTemplate() {\n    // TODO: add the super-grammar's templates at the right place, e.g., a case for AddExpr_plus\n    // should appear next to other cases of AddExpr.\n\n    const sb = new common.StringBuffer();\n    sb.append('{');\n\n    let first = true;\n\n    for (const ruleName in this.rules) {\n      const {body} = this.rules[ruleName];\n      if (first) {\n        first = false;\n      } else {\n        sb.append(',');\n      }\n      sb.append('\\n');\n      sb.append('  ');\n      this.addSemanticActionTemplate(ruleName, body, sb);\n    }\n\n    sb.append('\\n}');\n    return sb.contents();\n  }\n\n  addSemanticActionTemplate(ruleName, body, sb) {\n    sb.append(ruleName);\n    sb.append(': function(');\n    const arity = this._topDownActionArity(ruleName);\n    sb.append(common.repeat('_', arity).join(', '));\n    sb.append(') {\\n');\n    sb.append('  }');\n  }\n\n  // Parse a string which expresses a rule application in this grammar, and return the\n  // resulting Apply node.\n  parseApplication(str) {\n    let app;\n    if (str.indexOf('<') === -1) {\n      // simple application\n      app = new pexprs.Apply(str);\n    } else {\n      // parameterized application\n      const cst = ohmGrammar.match(str, 'Base_application');\n      app = buildGrammar(cst, {});\n    }\n\n    // Ensure that the application is valid.\n    if (!(app.ruleName in this.rules)) {\n      throw errors.undeclaredRule(app.ruleName, this.name);\n    }\n    const {formals} = this.rules[app.ruleName];\n    if (formals.length !== app.args.length) {\n      const {source} = this.rules[app.ruleName];\n      throw errors.wrongNumberOfParameters(\n        app.ruleName,\n        formals.length,\n        app.args.length,\n        source\n      );\n    }\n    return app;\n  }\n\n  _setUpMatchState(state) {\n    if (this._matchStateInitializer) {\n      this._matchStateInitializer(state);\n    }\n  }\n}\n\n// The following grammar contains a few rules that couldn't be written  in \"userland\".\n// At the bottom of src/main.js, we create a sub-grammar of this grammar that's called\n// `BuiltInRules`. That grammar contains several convenience rules, e.g., `letter` and\n// `digit`, and is implicitly the super-grammar of any grammar whose super-grammar\n// isn't specified.\nGrammar.ProtoBuiltInRules = new Grammar(\n  'ProtoBuiltInRules', // name\n  undefined, // supergrammar\n  {\n    any: {\n      body: pexprs.any,\n      formals: [],\n      description: 'any character',\n      primitive: true,\n    },\n    end: {\n      body: pexprs.end,\n      formals: [],\n      description: 'end of input',\n      primitive: true,\n    },\n\n    caseInsensitive: {\n      body: new pexprs.CaseInsensitiveTerminal(new pexprs.Param(0)),\n      formals: ['str'],\n      primitive: true,\n    },\n    lower: {\n      body: new pexprs.UnicodeChar('Ll'),\n      formals: [],\n      description: 'a lowercase letter',\n      primitive: true,\n    },\n    upper: {\n      body: new pexprs.UnicodeChar('Lu'),\n      formals: [],\n      description: 'an uppercase letter',\n      primitive: true,\n    },\n    // Union of Lt (titlecase), Lm (modifier), and Lo (other), i.e. any letter not in Ll or Lu.\n    unicodeLtmo: {\n      body: new pexprs.UnicodeChar('Ltmo'),\n      formals: [],\n      description: 'a Unicode character in Lt, Lm, or Lo',\n      primitive: true,\n    },\n\n    // These rules are not truly primitive (they could be written in userland) but are defined\n    // here for bootstrapping purposes.\n    spaces: {\n      body: new pexprs.Star(new pexprs.Apply('space')),\n      formals: [],\n    },\n    space: {\n      body: new pexprs.Range('\\x00', ' '),\n      formals: [],\n      description: 'a space',\n    },\n  }\n);\n\n// This method is called from main.js once Ohm has loaded.\nGrammar.initApplicationParser = function (grammar, builderFn) {\n  ohmGrammar = grammar;\n  buildGrammar = builderFn;\n};\n", "import {Grammar} from './Grammar.js';\nimport {InputStream} from './InputStream.js';\nimport {getDuplicates} from './common.js';\nimport * as errors from './errors.js';\nimport * as pexprs from './pexprs.js';\n\n// --------------------------------------------------------------------\n// Private Stuff\n// --------------------------------------------------------------------\n\n// Constructors\n\nexport class GrammarDecl {\n  constructor(name) {\n    this.name = name;\n  }\n\n  // Helpers\n\n  sourceInterval(startIdx, endIdx) {\n    return this.source.subInterval(startIdx, endIdx - startIdx);\n  }\n\n  ensureSuperGrammar() {\n    if (!this.superGrammar) {\n      this.withSuperGrammar(\n        // TODO: The conditional expression below is an ugly hack. It's kind of ok because\n        // I doubt anyone will ever try to declare a grammar called `BuiltInRules`. Still,\n        // we should try to find a better way to do this.\n        this.name === 'BuiltInRules' ? Grammar.ProtoBuiltInRules : Grammar.BuiltInRules\n      );\n    }\n    return this.superGrammar;\n  }\n\n  ensureSuperGrammarRuleForOverriding(name, source) {\n    const ruleInfo = this.ensureSuperGrammar().rules[name];\n    if (!ruleInfo) {\n      throw errors.cannotOverrideUndeclaredRule(name, this.superGrammar.name, source);\n    }\n    return ruleInfo;\n  }\n\n  installOverriddenOrExtendedRule(name, formals, body, source) {\n    const duplicateParameterNames = getDuplicates(formals);\n    if (duplicateParameterNames.length > 0) {\n      throw errors.duplicateParameterNames(name, duplicateParameterNames, source);\n    }\n    const ruleInfo = this.ensureSuperGrammar().rules[name];\n    const expectedFormals = ruleInfo.formals;\n    const expectedNumFormals = expectedFormals ? expectedFormals.length : 0;\n    if (formals.length !== expectedNumFormals) {\n      throw errors.wrongNumberOfParameters(name, expectedNumFormals, formals.length, source);\n    }\n    return this.install(name, formals, body, ruleInfo.description, source);\n  }\n\n  install(name, formals, body, description, source, primitive = false) {\n    this.rules[name] = {\n      body: body.introduceParams(formals),\n      formals,\n      description,\n      source,\n      primitive,\n    };\n    return this;\n  }\n\n  // Stuff that you should only do once\n\n  withSuperGrammar(superGrammar) {\n    if (this.superGrammar) {\n      throw new Error('the super grammar of a GrammarDecl cannot be set more than once');\n    }\n    this.superGrammar = superGrammar;\n    this.rules = Object.create(superGrammar.rules);\n\n    // Grammars with an explicit supergrammar inherit a default start rule.\n    if (!superGrammar.isBuiltIn()) {\n      this.defaultStartRule = superGrammar.defaultStartRule;\n    }\n    return this;\n  }\n\n  withDefaultStartRule(ruleName) {\n    this.defaultStartRule = ruleName;\n    return this;\n  }\n\n  withSource(source) {\n    this.source = new InputStream(source).interval(0, source.length);\n    return this;\n  }\n\n  // Creates a Grammar instance, and if it passes the sanity checks, returns it.\n  build() {\n    const grammar = new Grammar(\n      this.name,\n      this.ensureSuperGrammar(),\n      this.rules,\n      this.defaultStartRule\n    );\n    // Initialize internal props that are inherited from the super grammar.\n    grammar._matchStateInitializer = grammar.superGrammar._matchStateInitializer;\n    grammar.supportsIncrementalParsing = grammar.superGrammar.supportsIncrementalParsing;\n\n    // TODO: change the pexpr.prototype.assert... methods to make them add\n    // exceptions to an array that's provided as an arg. Then we'll be able to\n    // show more than one error of the same type at a time.\n    // TODO: include the offending pexpr in the errors, that way we can show\n    // the part of the source that caused it.\n    const grammarErrors = [];\n    let grammarHasInvalidApplications = false;\n    Object.keys(grammar.rules).forEach(ruleName => {\n      const {body} = grammar.rules[ruleName];\n      try {\n        body.assertChoicesHaveUniformArity(ruleName);\n      } catch (e) {\n        grammarErrors.push(e);\n      }\n      try {\n        body.assertAllApplicationsAreValid(ruleName, grammar);\n      } catch (e) {\n        grammarErrors.push(e);\n        grammarHasInvalidApplications = true;\n      }\n    });\n    if (!grammarHasInvalidApplications) {\n      // The following check can only be done if the grammar has no invalid applications.\n      Object.keys(grammar.rules).forEach(ruleName => {\n        const {body} = grammar.rules[ruleName];\n        try {\n          body.assertIteratedExprsAreNotNullable(grammar, []);\n        } catch (e) {\n          grammarErrors.push(e);\n        }\n      });\n    }\n    if (grammarErrors.length > 0) {\n      errors.throwErrors(grammarErrors);\n    }\n    if (this.source) {\n      grammar.source = this.source;\n    }\n\n    return grammar;\n  }\n\n  // Rule declarations\n\n  define(name, formals, body, description, source, primitive) {\n    this.ensureSuperGrammar();\n    if (this.superGrammar.rules[name]) {\n      throw errors.duplicateRuleDeclaration(name, this.name, this.superGrammar.name, source);\n    } else if (this.rules[name]) {\n      throw errors.duplicateRuleDeclaration(name, this.name, this.name, source);\n    }\n    const duplicateParameterNames = getDuplicates(formals);\n    if (duplicateParameterNames.length > 0) {\n      throw errors.duplicateParameterNames(name, duplicateParameterNames, source);\n    }\n    return this.install(name, formals, body, description, source, primitive);\n  }\n\n  override(name, formals, body, descIgnored, source) {\n    this.ensureSuperGrammarRuleForOverriding(name, source);\n    this.installOverriddenOrExtendedRule(name, formals, body, source);\n    return this;\n  }\n\n  extend(name, formals, fragment, descIgnored, source) {\n    const ruleInfo = this.ensureSuperGrammar().rules[name];\n    if (!ruleInfo) {\n      throw errors.cannotExtendUndeclaredRule(name, this.superGrammar.name, source);\n    }\n    const body = new pexprs.Extend(this.superGrammar, name, fragment);\n    body.source = fragment.source;\n    this.installOverriddenOrExtendedRule(name, formals, body, source);\n    return this;\n  }\n}\n", "import {Grammar} from './Grammar.js';\nimport {GrammarDecl} from './GrammarDecl.js';\nimport * as pexprs from './pexprs.js';\n\n// --------------------------------------------------------------------\n// Private stuff\n// --------------------------------------------------------------------\n\nexport class Builder {\n  constructor() {\n    this.currentDecl = null;\n    this.currentRuleName = null;\n  }\n\n  newGrammar(name) {\n    return new GrammarDecl(name);\n  }\n\n  grammar(metaInfo, name, superGrammar, defaultStartRule, rules) {\n    const gDecl = new GrammarDecl(name);\n    if (superGrammar) {\n      // `superGrammar` may be a recipe (i.e. an Array), or an actual grammar instance.\n      gDecl.withSuperGrammar(\n        superGrammar instanceof Grammar ? superGrammar : this.fromRecipe(superGrammar)\n      );\n    }\n    if (defaultStartRule) {\n      gDecl.withDefaultStartRule(defaultStartRule);\n    }\n    if (metaInfo && metaInfo.source) {\n      gDecl.withSource(metaInfo.source);\n    }\n\n    this.currentDecl = gDecl;\n    Object.keys(rules).forEach(ruleName => {\n      this.currentRuleName = ruleName;\n      const ruleRecipe = rules[ruleName];\n\n      const action = ruleRecipe[0]; // define/extend/override\n      const metaInfo = ruleRecipe[1];\n      const description = ruleRecipe[2];\n      const formals = ruleRecipe[3];\n      const body = this.fromRecipe(ruleRecipe[4]);\n\n      let source;\n      if (gDecl.source && metaInfo && metaInfo.sourceInterval) {\n        source = gDecl.source.subInterval(\n          metaInfo.sourceInterval[0],\n          metaInfo.sourceInterval[1] - metaInfo.sourceInterval[0]\n        );\n      }\n      gDecl[action](ruleName, formals, body, description, source);\n    });\n    this.currentRuleName = this.currentDecl = null;\n    return gDecl.build();\n  }\n\n  terminal(x) {\n    return new pexprs.Terminal(x);\n  }\n\n  range(from, to) {\n    return new pexprs.Range(from, to);\n  }\n\n  param(index) {\n    return new pexprs.Param(index);\n  }\n\n  alt(...termArgs) {\n    let terms = [];\n    for (let arg of termArgs) {\n      if (!(arg instanceof pexprs.PExpr)) {\n        arg = this.fromRecipe(arg);\n      }\n      if (arg instanceof pexprs.Alt) {\n        terms = terms.concat(arg.terms);\n      } else {\n        terms.push(arg);\n      }\n    }\n    return terms.length === 1 ? terms[0] : new pexprs.Alt(terms);\n  }\n\n  seq(...factorArgs) {\n    let factors = [];\n    for (let arg of factorArgs) {\n      if (!(arg instanceof pexprs.PExpr)) {\n        arg = this.fromRecipe(arg);\n      }\n      if (arg instanceof pexprs.Seq) {\n        factors = factors.concat(arg.factors);\n      } else {\n        factors.push(arg);\n      }\n    }\n    return factors.length === 1 ? factors[0] : new pexprs.Seq(factors);\n  }\n\n  star(expr) {\n    if (!(expr instanceof pexprs.PExpr)) {\n      expr = this.fromRecipe(expr);\n    }\n    return new pexprs.Star(expr);\n  }\n\n  plus(expr) {\n    if (!(expr instanceof pexprs.PExpr)) {\n      expr = this.fromRecipe(expr);\n    }\n    return new pexprs.Plus(expr);\n  }\n\n  opt(expr) {\n    if (!(expr instanceof pexprs.PExpr)) {\n      expr = this.fromRecipe(expr);\n    }\n    return new pexprs.Opt(expr);\n  }\n\n  not(expr) {\n    if (!(expr instanceof pexprs.PExpr)) {\n      expr = this.fromRecipe(expr);\n    }\n    return new pexprs.Not(expr);\n  }\n\n  lookahead(expr) {\n    if (!(expr instanceof pexprs.PExpr)) {\n      expr = this.fromRecipe(expr);\n    }\n    return new pexprs.Lookahead(expr);\n  }\n\n  lex(expr) {\n    if (!(expr instanceof pexprs.PExpr)) {\n      expr = this.fromRecipe(expr);\n    }\n    return new pexprs.Lex(expr);\n  }\n\n  app(ruleName, optParams) {\n    if (optParams && optParams.length > 0) {\n      optParams = optParams.map(function (param) {\n        return param instanceof pexprs.PExpr ? param : this.fromRecipe(param);\n      }, this);\n    }\n    return new pexprs.Apply(ruleName, optParams);\n  }\n\n  // Note that unlike other methods in this class, this method cannot be used as a\n  // convenience constructor. It only works with recipes, because it relies on\n  // `this.currentDecl` and `this.currentRuleName` being set.\n  splice(beforeTerms, afterTerms) {\n    return new pexprs.Splice(\n      this.currentDecl.superGrammar,\n      this.currentRuleName,\n      beforeTerms.map(term => this.fromRecipe(term)),\n      afterTerms.map(term => this.fromRecipe(term))\n    );\n  }\n\n  fromRecipe(recipe) {\n    // the meta-info of 'grammar' is processed in Builder.grammar\n    const args = recipe[0] === 'grammar' ? recipe.slice(1) : recipe.slice(2);\n    const result = this[recipe[0]](...args);\n\n    const metaInfo = recipe[1];\n    if (metaInfo) {\n      if (metaInfo.sourceInterval && this.currentDecl) {\n        result.withSource(this.currentDecl.sourceInterval(...metaInfo.sourceInterval));\n      }\n    }\n    return result;\n  }\n}\n", "import {Builder} from './Builder.js';\n\nexport function makeRecipe(recipe) {\n  if (typeof recipe === 'function') {\n    return recipe.call(new Builder());\n  } else {\n    if (typeof recipe === 'string') {\n      // stringified JSON recipe\n      recipe = JSON.parse(recipe);\n    }\n    return new Builder().fromRecipe(recipe);\n  }\n}\n", "import {makeRecipe} from '../src/makeRecipe.js';\nexport default makeRecipe([\"grammar\",{\"source\":\"BuiltInRules {\\n\\n  alnum  (an alpha-numeric character)\\n    = letter\\n    | digit\\n\\n  letter  (a letter)\\n    = lower\\n    | upper\\n    | unicodeLtmo\\n\\n  digit  (a digit)\\n    = \\\"0\\\"..\\\"9\\\"\\n\\n  hexDigit  (a hexadecimal digit)\\n    = digit\\n    | \\\"a\\\"..\\\"f\\\"\\n    | \\\"A\\\"..\\\"F\\\"\\n\\n  ListOf<elem, sep>\\n    = NonemptyListOf<elem, sep>\\n    | EmptyListOf<elem, sep>\\n\\n  NonemptyListOf<elem, sep>\\n    = elem (sep elem)*\\n\\n  EmptyListOf<elem, sep>\\n    = /* nothing */\\n\\n  listOf<elem, sep>\\n    = nonemptyListOf<elem, sep>\\n    | emptyListOf<elem, sep>\\n\\n  nonemptyListOf<elem, sep>\\n    = elem (sep elem)*\\n\\n  emptyListOf<elem, sep>\\n    = /* nothing */\\n\\n  // Allows a syntactic rule application within a lexical context.\\n  applySyntactic<app> = app\\n}\"},\"BuiltInRules\",null,null,{\"alnum\":[\"define\",{\"sourceInterval\":[18,78]},\"an alpha-numeric character\",[],[\"alt\",{\"sourceInterval\":[60,78]},[\"app\",{\"sourceInterval\":[60,66]},\"letter\",[]],[\"app\",{\"sourceInterval\":[73,78]},\"digit\",[]]]],\"letter\":[\"define\",{\"sourceInterval\":[82,142]},\"a letter\",[],[\"alt\",{\"sourceInterval\":[107,142]},[\"app\",{\"sourceInterval\":[107,112]},\"lower\",[]],[\"app\",{\"sourceInterval\":[119,124]},\"upper\",[]],[\"app\",{\"sourceInterval\":[131,142]},\"unicodeLtmo\",[]]]],\"digit\":[\"define\",{\"sourceInterval\":[146,177]},\"a digit\",[],[\"range\",{\"sourceInterval\":[169,177]},\"0\",\"9\"]],\"hexDigit\":[\"define\",{\"sourceInterval\":[181,254]},\"a hexadecimal digit\",[],[\"alt\",{\"sourceInterval\":[219,254]},[\"app\",{\"sourceInterval\":[219,224]},\"digit\",[]],[\"range\",{\"sourceInterval\":[231,239]},\"a\",\"f\"],[\"range\",{\"sourceInterval\":[246,254]},\"A\",\"F\"]]],\"ListOf\":[\"define\",{\"sourceInterval\":[258,336]},null,[\"elem\",\"sep\"],[\"alt\",{\"sourceInterval\":[282,336]},[\"app\",{\"sourceInterval\":[282,307]},\"NonemptyListOf\",[[\"param\",{\"sourceInterval\":[297,301]},0],[\"param\",{\"sourceInterval\":[303,306]},1]]],[\"app\",{\"sourceInterval\":[314,336]},\"EmptyListOf\",[[\"param\",{\"sourceInterval\":[326,330]},0],[\"param\",{\"sourceInterval\":[332,335]},1]]]]],\"NonemptyListOf\":[\"define\",{\"sourceInterval\":[340,388]},null,[\"elem\",\"sep\"],[\"seq\",{\"sourceInterval\":[372,388]},[\"param\",{\"sourceInterval\":[372,376]},0],[\"star\",{\"sourceInterval\":[377,388]},[\"seq\",{\"sourceInterval\":[378,386]},[\"param\",{\"sourceInterval\":[378,381]},1],[\"param\",{\"sourceInterval\":[382,386]},0]]]]],\"EmptyListOf\":[\"define\",{\"sourceInterval\":[392,434]},null,[\"elem\",\"sep\"],[\"seq\",{\"sourceInterval\":[438,438]}]],\"listOf\":[\"define\",{\"sourceInterval\":[438,516]},null,[\"elem\",\"sep\"],[\"alt\",{\"sourceInterval\":[462,516]},[\"app\",{\"sourceInterval\":[462,487]},\"nonemptyListOf\",[[\"param\",{\"sourceInterval\":[477,481]},0],[\"param\",{\"sourceInterval\":[483,486]},1]]],[\"app\",{\"sourceInterval\":[494,516]},\"emptyListOf\",[[\"param\",{\"sourceInterval\":[506,510]},0],[\"param\",{\"sourceInterval\":[512,515]},1]]]]],\"nonemptyListOf\":[\"define\",{\"sourceInterval\":[520,568]},null,[\"elem\",\"sep\"],[\"seq\",{\"sourceInterval\":[552,568]},[\"param\",{\"sourceInterval\":[552,556]},0],[\"star\",{\"sourceInterval\":[557,568]},[\"seq\",{\"sourceInterval\":[558,566]},[\"param\",{\"sourceInterval\":[558,561]},1],[\"param\",{\"sourceInterval\":[562,566]},0]]]]],\"emptyListOf\":[\"define\",{\"sourceInterval\":[572,682]},null,[\"elem\",\"sep\"],[\"seq\",{\"sourceInterval\":[685,685]}]],\"applySyntactic\":[\"define\",{\"sourceInterval\":[685,710]},null,[\"app\"],[\"param\",{\"sourceInterval\":[707,710]},0]]}]);\n", "import BuiltInRules from '../dist/built-in-rules.js';\nimport {Grammar} from './Grammar.js';\nimport {announceBuiltInRules} from './util.js';\n\nGrammar.BuiltInRules = BuiltInRules;\nannounceBuiltInRules(Grammar.BuiltInRules);\n\n// During the bootstrap process, we instantiate some grammars that require\n// the built-in rules to be loaded first (e.g., ohm-grammar.ohm). By\n// exporting `makeRecipe` here, the recipes for those grammars can encode\n// that dependency by importing it from this module.\nexport {makeRecipe} from './makeRecipe.js';\n", "import {makeRecipe} from '../src/main-kernel.js';\nexport default makeRecipe([\"grammar\",{\"source\":\"Ohm {\\n\\n  Grammars\\n    = Grammar*\\n\\n  Grammar\\n    = ident SuperGrammar? \\\"{\\\" Rule* \\\"}\\\"\\n\\n  SuperGrammar\\n    = \\\"<:\\\" ident\\n\\n  Rule\\n    = ident Formals? ruleDescr? \\\"=\\\"  RuleBody  -- define\\n    | ident Formals?            \\\":=\\\" OverrideRuleBody  -- override\\n    | ident Formals?            \\\"+=\\\" RuleBody  -- extend\\n\\n  RuleBody\\n    = \\\"|\\\"? NonemptyListOf<TopLevelTerm, \\\"|\\\">\\n\\n  TopLevelTerm\\n    = Seq caseName  -- inline\\n    | Seq\\n\\n  OverrideRuleBody\\n    = \\\"|\\\"? NonemptyListOf<OverrideTopLevelTerm, \\\"|\\\">\\n\\n  OverrideTopLevelTerm\\n    = \\\"...\\\"  -- superSplice\\n    | TopLevelTerm\\n\\n  Formals\\n    = \\\"<\\\" ListOf<ident, \\\",\\\"> \\\">\\\"\\n\\n  Params\\n    = \\\"<\\\" ListOf<Seq, \\\",\\\"> \\\">\\\"\\n\\n  Alt\\n    = NonemptyListOf<Seq, \\\"|\\\">\\n\\n  Seq\\n    = Iter*\\n\\n  Iter\\n    = Pred \\\"*\\\"  -- star\\n    | Pred \\\"+\\\"  -- plus\\n    | Pred \\\"?\\\"  -- opt\\n    | Pred\\n\\n  Pred\\n    = \\\"~\\\" Lex  -- not\\n    | \\\"&\\\" Lex  -- lookahead\\n    | Lex\\n\\n  Lex\\n    = \\\"#\\\" Base  -- lex\\n    | Base\\n\\n  Base\\n    = ident Params? ~(ruleDescr? \\\"=\\\" | \\\":=\\\" | \\\"+=\\\")  -- application\\n    | oneCharTerminal \\\"..\\\" oneCharTerminal           -- range\\n    | terminal                                       -- terminal\\n    | \\\"(\\\" Alt \\\")\\\"                                    -- paren\\n\\n  ruleDescr  (a rule description)\\n    = \\\"(\\\" ruleDescrText \\\")\\\"\\n\\n  ruleDescrText\\n    = (~\\\")\\\" any)*\\n\\n  caseName\\n    = \\\"--\\\" (~\\\"\\\\n\\\" space)* name (~\\\"\\\\n\\\" space)* (\\\"\\\\n\\\" | &\\\"}\\\")\\n\\n  name  (a name)\\n    = nameFirst nameRest*\\n\\n  nameFirst\\n    = \\\"_\\\"\\n    | letter\\n\\n  nameRest\\n    = \\\"_\\\"\\n    | alnum\\n\\n  ident  (an identifier)\\n    = name\\n\\n  terminal\\n    = \\\"\\\\\\\"\\\" terminalChar* \\\"\\\\\\\"\\\"\\n\\n  oneCharTerminal\\n    = \\\"\\\\\\\"\\\" terminalChar \\\"\\\\\\\"\\\"\\n\\n  terminalChar\\n    = escapeChar\\n      | ~\\\"\\\\\\\\\\\" ~\\\"\\\\\\\"\\\" ~\\\"\\\\n\\\" \\\"\\\\u{0}\\\"..\\\"\\\\u{10FFFF}\\\"\\n\\n  escapeChar  (an escape sequence)\\n    = \\\"\\\\\\\\\\\\\\\\\\\"                                     -- backslash\\n    | \\\"\\\\\\\\\\\\\\\"\\\"                                     -- doubleQuote\\n    | \\\"\\\\\\\\\\\\'\\\"                                     -- singleQuote\\n    | \\\"\\\\\\\\b\\\"                                      -- backspace\\n    | \\\"\\\\\\\\n\\\"                                      -- lineFeed\\n    | \\\"\\\\\\\\r\\\"                                      -- carriageReturn\\n    | \\\"\\\\\\\\t\\\"                                      -- tab\\n    | \\\"\\\\\\\\u{\\\" hexDigit hexDigit? hexDigit?\\n             hexDigit? hexDigit? hexDigit? \\\"}\\\"   -- unicodeCodePoint\\n    | \\\"\\\\\\\\u\\\" hexDigit hexDigit hexDigit hexDigit  -- unicodeEscape\\n    | \\\"\\\\\\\\x\\\" hexDigit hexDigit                    -- hexEscape\\n\\n  space\\n   += comment\\n\\n  comment\\n    = \\\"//\\\" (~\\\"\\\\n\\\" any)* &(\\\"\\\\n\\\" | end)  -- singleLine\\n    | \\\"/*\\\" (~\\\"*/\\\" any)* \\\"*/\\\"  -- multiLine\\n\\n  tokens = token*\\n\\n  token = caseName | comment | ident | operator | punctuation | terminal | any\\n\\n  operator = \\\"<:\\\" | \\\"=\\\" | \\\":=\\\" | \\\"+=\\\" | \\\"*\\\" | \\\"+\\\" | \\\"?\\\" | \\\"~\\\" | \\\"&\\\"\\n\\n  punctuation = \\\"<\\\" | \\\">\\\" | \\\",\\\" | \\\"--\\\"\\n}\"},\"Ohm\",null,\"Grammars\",{\"Grammars\":[\"define\",{\"sourceInterval\":[9,32]},null,[],[\"star\",{\"sourceInterval\":[24,32]},[\"app\",{\"sourceInterval\":[24,31]},\"Grammar\",[]]]],\"Grammar\":[\"define\",{\"sourceInterval\":[36,83]},null,[],[\"seq\",{\"sourceInterval\":[50,83]},[\"app\",{\"sourceInterval\":[50,55]},\"ident\",[]],[\"opt\",{\"sourceInterval\":[56,69]},[\"app\",{\"sourceInterval\":[56,68]},\"SuperGrammar\",[]]],[\"terminal\",{\"sourceInterval\":[70,73]},\"{\"],[\"star\",{\"sourceInterval\":[74,79]},[\"app\",{\"sourceInterval\":[74,78]},\"Rule\",[]]],[\"terminal\",{\"sourceInterval\":[80,83]},\"}\"]]],\"SuperGrammar\":[\"define\",{\"sourceInterval\":[87,116]},null,[],[\"seq\",{\"sourceInterval\":[106,116]},[\"terminal\",{\"sourceInterval\":[106,110]},\"<:\"],[\"app\",{\"sourceInterval\":[111,116]},\"ident\",[]]]],\"Rule_define\":[\"define\",{\"sourceInterval\":[131,181]},null,[],[\"seq\",{\"sourceInterval\":[131,170]},[\"app\",{\"sourceInterval\":[131,136]},\"ident\",[]],[\"opt\",{\"sourceInterval\":[137,145]},[\"app\",{\"sourceInterval\":[137,144]},\"Formals\",[]]],[\"opt\",{\"sourceInterval\":[146,156]},[\"app\",{\"sourceInterval\":[146,155]},\"ruleDescr\",[]]],[\"terminal\",{\"sourceInterval\":[157,160]},\"=\"],[\"app\",{\"sourceInterval\":[162,170]},\"RuleBody\",[]]]],\"Rule_override\":[\"define\",{\"sourceInterval\":[188,248]},null,[],[\"seq\",{\"sourceInterval\":[188,235]},[\"app\",{\"sourceInterval\":[188,193]},\"ident\",[]],[\"opt\",{\"sourceInterval\":[194,202]},[\"app\",{\"sourceInterval\":[194,201]},\"Formals\",[]]],[\"terminal\",{\"sourceInterval\":[214,218]},\":=\"],[\"app\",{\"sourceInterval\":[219,235]},\"OverrideRuleBody\",[]]]],\"Rule_extend\":[\"define\",{\"sourceInterval\":[255,305]},null,[],[\"seq\",{\"sourceInterval\":[255,294]},[\"app\",{\"sourceInterval\":[255,260]},\"ident\",[]],[\"opt\",{\"sourceInterval\":[261,269]},[\"app\",{\"sourceInterval\":[261,268]},\"Formals\",[]]],[\"terminal\",{\"sourceInterval\":[281,285]},\"+=\"],[\"app\",{\"sourceInterval\":[286,294]},\"RuleBody\",[]]]],\"Rule\":[\"define\",{\"sourceInterval\":[120,305]},null,[],[\"alt\",{\"sourceInterval\":[131,305]},[\"app\",{\"sourceInterval\":[131,170]},\"Rule_define\",[]],[\"app\",{\"sourceInterval\":[188,235]},\"Rule_override\",[]],[\"app\",{\"sourceInterval\":[255,294]},\"Rule_extend\",[]]]],\"RuleBody\":[\"define\",{\"sourceInterval\":[309,362]},null,[],[\"seq\",{\"sourceInterval\":[324,362]},[\"opt\",{\"sourceInterval\":[324,328]},[\"terminal\",{\"sourceInterval\":[324,327]},\"|\"]],[\"app\",{\"sourceInterval\":[329,362]},\"NonemptyListOf\",[[\"app\",{\"sourceInterval\":[344,356]},\"TopLevelTerm\",[]],[\"terminal\",{\"sourceInterval\":[358,361]},\"|\"]]]]],\"TopLevelTerm_inline\":[\"define\",{\"sourceInterval\":[385,408]},null,[],[\"seq\",{\"sourceInterval\":[385,397]},[\"app\",{\"sourceInterval\":[385,388]},\"Seq\",[]],[\"app\",{\"sourceInterval\":[389,397]},\"caseName\",[]]]],\"TopLevelTerm\":[\"define\",{\"sourceInterval\":[366,418]},null,[],[\"alt\",{\"sourceInterval\":[385,418]},[\"app\",{\"sourceInterval\":[385,397]},\"TopLevelTerm_inline\",[]],[\"app\",{\"sourceInterval\":[415,418]},\"Seq\",[]]]],\"OverrideRuleBody\":[\"define\",{\"sourceInterval\":[422,491]},null,[],[\"seq\",{\"sourceInterval\":[445,491]},[\"opt\",{\"sourceInterval\":[445,449]},[\"terminal\",{\"sourceInterval\":[445,448]},\"|\"]],[\"app\",{\"sourceInterval\":[450,491]},\"NonemptyListOf\",[[\"app\",{\"sourceInterval\":[465,485]},\"OverrideTopLevelTerm\",[]],[\"terminal\",{\"sourceInterval\":[487,490]},\"|\"]]]]],\"OverrideTopLevelTerm_superSplice\":[\"define\",{\"sourceInterval\":[522,543]},null,[],[\"terminal\",{\"sourceInterval\":[522,527]},\"...\"]],\"OverrideTopLevelTerm\":[\"define\",{\"sourceInterval\":[495,562]},null,[],[\"alt\",{\"sourceInterval\":[522,562]},[\"app\",{\"sourceInterval\":[522,527]},\"OverrideTopLevelTerm_superSplice\",[]],[\"app\",{\"sourceInterval\":[550,562]},\"TopLevelTerm\",[]]]],\"Formals\":[\"define\",{\"sourceInterval\":[566,606]},null,[],[\"seq\",{\"sourceInterval\":[580,606]},[\"terminal\",{\"sourceInterval\":[580,583]},\"<\"],[\"app\",{\"sourceInterval\":[584,602]},\"ListOf\",[[\"app\",{\"sourceInterval\":[591,596]},\"ident\",[]],[\"terminal\",{\"sourceInterval\":[598,601]},\",\"]]],[\"terminal\",{\"sourceInterval\":[603,606]},\">\"]]],\"Params\":[\"define\",{\"sourceInterval\":[610,647]},null,[],[\"seq\",{\"sourceInterval\":[623,647]},[\"terminal\",{\"sourceInterval\":[623,626]},\"<\"],[\"app\",{\"sourceInterval\":[627,643]},\"ListOf\",[[\"app\",{\"sourceInterval\":[634,637]},\"Seq\",[]],[\"terminal\",{\"sourceInterval\":[639,642]},\",\"]]],[\"terminal\",{\"sourceInterval\":[644,647]},\">\"]]],\"Alt\":[\"define\",{\"sourceInterval\":[651,685]},null,[],[\"app\",{\"sourceInterval\":[661,685]},\"NonemptyListOf\",[[\"app\",{\"sourceInterval\":[676,679]},\"Seq\",[]],[\"terminal\",{\"sourceInterval\":[681,684]},\"|\"]]]],\"Seq\":[\"define\",{\"sourceInterval\":[689,704]},null,[],[\"star\",{\"sourceInterval\":[699,704]},[\"app\",{\"sourceInterval\":[699,703]},\"Iter\",[]]]],\"Iter_star\":[\"define\",{\"sourceInterval\":[719,736]},null,[],[\"seq\",{\"sourceInterval\":[719,727]},[\"app\",{\"sourceInterval\":[719,723]},\"Pred\",[]],[\"terminal\",{\"sourceInterval\":[724,727]},\"*\"]]],\"Iter_plus\":[\"define\",{\"sourceInterval\":[743,760]},null,[],[\"seq\",{\"sourceInterval\":[743,751]},[\"app\",{\"sourceInterval\":[743,747]},\"Pred\",[]],[\"terminal\",{\"sourceInterval\":[748,751]},\"+\"]]],\"Iter_opt\":[\"define\",{\"sourceInterval\":[767,783]},null,[],[\"seq\",{\"sourceInterval\":[767,775]},[\"app\",{\"sourceInterval\":[767,771]},\"Pred\",[]],[\"terminal\",{\"sourceInterval\":[772,775]},\"?\"]]],\"Iter\":[\"define\",{\"sourceInterval\":[708,794]},null,[],[\"alt\",{\"sourceInterval\":[719,794]},[\"app\",{\"sourceInterval\":[719,727]},\"Iter_star\",[]],[\"app\",{\"sourceInterval\":[743,751]},\"Iter_plus\",[]],[\"app\",{\"sourceInterval\":[767,775]},\"Iter_opt\",[]],[\"app\",{\"sourceInterval\":[790,794]},\"Pred\",[]]]],\"Pred_not\":[\"define\",{\"sourceInterval\":[809,824]},null,[],[\"seq\",{\"sourceInterval\":[809,816]},[\"terminal\",{\"sourceInterval\":[809,812]},\"~\"],[\"app\",{\"sourceInterval\":[813,816]},\"Lex\",[]]]],\"Pred_lookahead\":[\"define\",{\"sourceInterval\":[831,852]},null,[],[\"seq\",{\"sourceInterval\":[831,838]},[\"terminal\",{\"sourceInterval\":[831,834]},\"&\"],[\"app\",{\"sourceInterval\":[835,838]},\"Lex\",[]]]],\"Pred\":[\"define\",{\"sourceInterval\":[798,862]},null,[],[\"alt\",{\"sourceInterval\":[809,862]},[\"app\",{\"sourceInterval\":[809,816]},\"Pred_not\",[]],[\"app\",{\"sourceInterval\":[831,838]},\"Pred_lookahead\",[]],[\"app\",{\"sourceInterval\":[859,862]},\"Lex\",[]]]],\"Lex_lex\":[\"define\",{\"sourceInterval\":[876,892]},null,[],[\"seq\",{\"sourceInterval\":[876,884]},[\"terminal\",{\"sourceInterval\":[876,879]},\"#\"],[\"app\",{\"sourceInterval\":[880,884]},\"Base\",[]]]],\"Lex\":[\"define\",{\"sourceInterval\":[866,903]},null,[],[\"alt\",{\"sourceInterval\":[876,903]},[\"app\",{\"sourceInterval\":[876,884]},\"Lex_lex\",[]],[\"app\",{\"sourceInterval\":[899,903]},\"Base\",[]]]],\"Base_application\":[\"define\",{\"sourceInterval\":[918,979]},null,[],[\"seq\",{\"sourceInterval\":[918,963]},[\"app\",{\"sourceInterval\":[918,923]},\"ident\",[]],[\"opt\",{\"sourceInterval\":[924,931]},[\"app\",{\"sourceInterval\":[924,930]},\"Params\",[]]],[\"not\",{\"sourceInterval\":[932,963]},[\"alt\",{\"sourceInterval\":[934,962]},[\"seq\",{\"sourceInterval\":[934,948]},[\"opt\",{\"sourceInterval\":[934,944]},[\"app\",{\"sourceInterval\":[934,943]},\"ruleDescr\",[]]],[\"terminal\",{\"sourceInterval\":[945,948]},\"=\"]],[\"terminal\",{\"sourceInterval\":[951,955]},\":=\"],[\"terminal\",{\"sourceInterval\":[958,962]},\"+=\"]]]]],\"Base_range\":[\"define\",{\"sourceInterval\":[986,1041]},null,[],[\"seq\",{\"sourceInterval\":[986,1022]},[\"app\",{\"sourceInterval\":[986,1001]},\"oneCharTerminal\",[]],[\"terminal\",{\"sourceInterval\":[1002,1006]},\"..\"],[\"app\",{\"sourceInterval\":[1007,1022]},\"oneCharTerminal\",[]]]],\"Base_terminal\":[\"define\",{\"sourceInterval\":[1048,1106]},null,[],[\"app\",{\"sourceInterval\":[1048,1056]},\"terminal\",[]]],\"Base_paren\":[\"define\",{\"sourceInterval\":[1113,1168]},null,[],[\"seq\",{\"sourceInterval\":[1113,1124]},[\"terminal\",{\"sourceInterval\":[1113,1116]},\"(\"],[\"app\",{\"sourceInterval\":[1117,1120]},\"Alt\",[]],[\"terminal\",{\"sourceInterval\":[1121,1124]},\")\"]]],\"Base\":[\"define\",{\"sourceInterval\":[907,1168]},null,[],[\"alt\",{\"sourceInterval\":[918,1168]},[\"app\",{\"sourceInterval\":[918,963]},\"Base_application\",[]],[\"app\",{\"sourceInterval\":[986,1022]},\"Base_range\",[]],[\"app\",{\"sourceInterval\":[1048,1056]},\"Base_terminal\",[]],[\"app\",{\"sourceInterval\":[1113,1124]},\"Base_paren\",[]]]],\"ruleDescr\":[\"define\",{\"sourceInterval\":[1172,1231]},\"a rule description\",[],[\"seq\",{\"sourceInterval\":[1210,1231]},[\"terminal\",{\"sourceInterval\":[1210,1213]},\"(\"],[\"app\",{\"sourceInterval\":[1214,1227]},\"ruleDescrText\",[]],[\"terminal\",{\"sourceInterval\":[1228,1231]},\")\"]]],\"ruleDescrText\":[\"define\",{\"sourceInterval\":[1235,1266]},null,[],[\"star\",{\"sourceInterval\":[1255,1266]},[\"seq\",{\"sourceInterval\":[1256,1264]},[\"not\",{\"sourceInterval\":[1256,1260]},[\"terminal\",{\"sourceInterval\":[1257,1260]},\")\"]],[\"app\",{\"sourceInterval\":[1261,1264]},\"any\",[]]]]],\"caseName\":[\"define\",{\"sourceInterval\":[1270,1338]},null,[],[\"seq\",{\"sourceInterval\":[1285,1338]},[\"terminal\",{\"sourceInterval\":[1285,1289]},\"--\"],[\"star\",{\"sourceInterval\":[1290,1304]},[\"seq\",{\"sourceInterval\":[1291,1302]},[\"not\",{\"sourceInterval\":[1291,1296]},[\"terminal\",{\"sourceInterval\":[1292,1296]},\"\\n\"]],[\"app\",{\"sourceInterval\":[1297,1302]},\"space\",[]]]],[\"app\",{\"sourceInterval\":[1305,1309]},\"name\",[]],[\"star\",{\"sourceInterval\":[1310,1324]},[\"seq\",{\"sourceInterval\":[1311,1322]},[\"not\",{\"sourceInterval\":[1311,1316]},[\"terminal\",{\"sourceInterval\":[1312,1316]},\"\\n\"]],[\"app\",{\"sourceInterval\":[1317,1322]},\"space\",[]]]],[\"alt\",{\"sourceInterval\":[1326,1337]},[\"terminal\",{\"sourceInterval\":[1326,1330]},\"\\n\"],[\"lookahead\",{\"sourceInterval\":[1333,1337]},[\"terminal\",{\"sourceInterval\":[1334,1337]},\"}\"]]]]],\"name\":[\"define\",{\"sourceInterval\":[1342,1382]},\"a name\",[],[\"seq\",{\"sourceInterval\":[1363,1382]},[\"app\",{\"sourceInterval\":[1363,1372]},\"nameFirst\",[]],[\"star\",{\"sourceInterval\":[1373,1382]},[\"app\",{\"sourceInterval\":[1373,1381]},\"nameRest\",[]]]]],\"nameFirst\":[\"define\",{\"sourceInterval\":[1386,1418]},null,[],[\"alt\",{\"sourceInterval\":[1402,1418]},[\"terminal\",{\"sourceInterval\":[1402,1405]},\"_\"],[\"app\",{\"sourceInterval\":[1412,1418]},\"letter\",[]]]],\"nameRest\":[\"define\",{\"sourceInterval\":[1422,1452]},null,[],[\"alt\",{\"sourceInterval\":[1437,1452]},[\"terminal\",{\"sourceInterval\":[1437,1440]},\"_\"],[\"app\",{\"sourceInterval\":[1447,1452]},\"alnum\",[]]]],\"ident\":[\"define\",{\"sourceInterval\":[1456,1489]},\"an identifier\",[],[\"app\",{\"sourceInterval\":[1485,1489]},\"name\",[]]],\"terminal\":[\"define\",{\"sourceInterval\":[1493,1531]},null,[],[\"seq\",{\"sourceInterval\":[1508,1531]},[\"terminal\",{\"sourceInterval\":[1508,1512]},\"\\\"\"],[\"star\",{\"sourceInterval\":[1513,1526]},[\"app\",{\"sourceInterval\":[1513,1525]},\"terminalChar\",[]]],[\"terminal\",{\"sourceInterval\":[1527,1531]},\"\\\"\"]]],\"oneCharTerminal\":[\"define\",{\"sourceInterval\":[1535,1579]},null,[],[\"seq\",{\"sourceInterval\":[1557,1579]},[\"terminal\",{\"sourceInterval\":[1557,1561]},\"\\\"\"],[\"app\",{\"sourceInterval\":[1562,1574]},\"terminalChar\",[]],[\"terminal\",{\"sourceInterval\":[1575,1579]},\"\\\"\"]]],\"terminalChar\":[\"define\",{\"sourceInterval\":[1583,1660]},null,[],[\"alt\",{\"sourceInterval\":[1602,1660]},[\"app\",{\"sourceInterval\":[1602,1612]},\"escapeChar\",[]],[\"seq\",{\"sourceInterval\":[1621,1660]},[\"not\",{\"sourceInterval\":[1621,1626]},[\"terminal\",{\"sourceInterval\":[1622,1626]},\"\\\\\"]],[\"not\",{\"sourceInterval\":[1627,1632]},[\"terminal\",{\"sourceInterval\":[1628,1632]},\"\\\"\"]],[\"not\",{\"sourceInterval\":[1633,1638]},[\"terminal\",{\"sourceInterval\":[1634,1638]},\"\\n\"]],[\"range\",{\"sourceInterval\":[1639,1660]},\"\\u0000\",\"􏿿\"]]]],\"escapeChar_backslash\":[\"define\",{\"sourceInterval\":[1703,1758]},null,[],[\"terminal\",{\"sourceInterval\":[1703,1709]},\"\\\\\\\\\"]],\"escapeChar_doubleQuote\":[\"define\",{\"sourceInterval\":[1765,1822]},null,[],[\"terminal\",{\"sourceInterval\":[1765,1771]},\"\\\\\\\"\"]],\"escapeChar_singleQuote\":[\"define\",{\"sourceInterval\":[1829,1886]},null,[],[\"terminal\",{\"sourceInterval\":[1829,1835]},\"\\\\'\"]],\"escapeChar_backspace\":[\"define\",{\"sourceInterval\":[1893,1948]},null,[],[\"terminal\",{\"sourceInterval\":[1893,1898]},\"\\\\b\"]],\"escapeChar_lineFeed\":[\"define\",{\"sourceInterval\":[1955,2009]},null,[],[\"terminal\",{\"sourceInterval\":[1955,1960]},\"\\\\n\"]],\"escapeChar_carriageReturn\":[\"define\",{\"sourceInterval\":[2016,2076]},null,[],[\"terminal\",{\"sourceInterval\":[2016,2021]},\"\\\\r\"]],\"escapeChar_tab\":[\"define\",{\"sourceInterval\":[2083,2132]},null,[],[\"terminal\",{\"sourceInterval\":[2083,2088]},\"\\\\t\"]],\"escapeChar_unicodeCodePoint\":[\"define\",{\"sourceInterval\":[2139,2243]},null,[],[\"seq\",{\"sourceInterval\":[2139,2221]},[\"terminal\",{\"sourceInterval\":[2139,2145]},\"\\\\u{\"],[\"app\",{\"sourceInterval\":[2146,2154]},\"hexDigit\",[]],[\"opt\",{\"sourceInterval\":[2155,2164]},[\"app\",{\"sourceInterval\":[2155,2163]},\"hexDigit\",[]]],[\"opt\",{\"sourceInterval\":[2165,2174]},[\"app\",{\"sourceInterval\":[2165,2173]},\"hexDigit\",[]]],[\"opt\",{\"sourceInterval\":[2188,2197]},[\"app\",{\"sourceInterval\":[2188,2196]},\"hexDigit\",[]]],[\"opt\",{\"sourceInterval\":[2198,2207]},[\"app\",{\"sourceInterval\":[2198,2206]},\"hexDigit\",[]]],[\"opt\",{\"sourceInterval\":[2208,2217]},[\"app\",{\"sourceInterval\":[2208,2216]},\"hexDigit\",[]]],[\"terminal\",{\"sourceInterval\":[2218,2221]},\"}\"]]],\"escapeChar_unicodeEscape\":[\"define\",{\"sourceInterval\":[2250,2309]},null,[],[\"seq\",{\"sourceInterval\":[2250,2291]},[\"terminal\",{\"sourceInterval\":[2250,2255]},\"\\\\u\"],[\"app\",{\"sourceInterval\":[2256,2264]},\"hexDigit\",[]],[\"app\",{\"sourceInterval\":[2265,2273]},\"hexDigit\",[]],[\"app\",{\"sourceInterval\":[2274,2282]},\"hexDigit\",[]],[\"app\",{\"sourceInterval\":[2283,2291]},\"hexDigit\",[]]]],\"escapeChar_hexEscape\":[\"define\",{\"sourceInterval\":[2316,2371]},null,[],[\"seq\",{\"sourceInterval\":[2316,2339]},[\"terminal\",{\"sourceInterval\":[2316,2321]},\"\\\\x\"],[\"app\",{\"sourceInterval\":[2322,2330]},\"hexDigit\",[]],[\"app\",{\"sourceInterval\":[2331,2339]},\"hexDigit\",[]]]],\"escapeChar\":[\"define\",{\"sourceInterval\":[1664,2371]},\"an escape sequence\",[],[\"alt\",{\"sourceInterval\":[1703,2371]},[\"app\",{\"sourceInterval\":[1703,1709]},\"escapeChar_backslash\",[]],[\"app\",{\"sourceInterval\":[1765,1771]},\"escapeChar_doubleQuote\",[]],[\"app\",{\"sourceInterval\":[1829,1835]},\"escapeChar_singleQuote\",[]],[\"app\",{\"sourceInterval\":[1893,1898]},\"escapeChar_backspace\",[]],[\"app\",{\"sourceInterval\":[1955,1960]},\"escapeChar_lineFeed\",[]],[\"app\",{\"sourceInterval\":[2016,2021]},\"escapeChar_carriageReturn\",[]],[\"app\",{\"sourceInterval\":[2083,2088]},\"escapeChar_tab\",[]],[\"app\",{\"sourceInterval\":[2139,2221]},\"escapeChar_unicodeCodePoint\",[]],[\"app\",{\"sourceInterval\":[2250,2291]},\"escapeChar_unicodeEscape\",[]],[\"app\",{\"sourceInterval\":[2316,2339]},\"escapeChar_hexEscape\",[]]]],\"space\":[\"extend\",{\"sourceInterval\":[2375,2394]},null,[],[\"app\",{\"sourceInterval\":[2387,2394]},\"comment\",[]]],\"comment_singleLine\":[\"define\",{\"sourceInterval\":[2412,2458]},null,[],[\"seq\",{\"sourceInterval\":[2412,2443]},[\"terminal\",{\"sourceInterval\":[2412,2416]},\"//\"],[\"star\",{\"sourceInterval\":[2417,2429]},[\"seq\",{\"sourceInterval\":[2418,2427]},[\"not\",{\"sourceInterval\":[2418,2423]},[\"terminal\",{\"sourceInterval\":[2419,2423]},\"\\n\"]],[\"app\",{\"sourceInterval\":[2424,2427]},\"any\",[]]]],[\"lookahead\",{\"sourceInterval\":[2430,2443]},[\"alt\",{\"sourceInterval\":[2432,2442]},[\"terminal\",{\"sourceInterval\":[2432,2436]},\"\\n\"],[\"app\",{\"sourceInterval\":[2439,2442]},\"end\",[]]]]]],\"comment_multiLine\":[\"define\",{\"sourceInterval\":[2465,2501]},null,[],[\"seq\",{\"sourceInterval\":[2465,2487]},[\"terminal\",{\"sourceInterval\":[2465,2469]},\"/*\"],[\"star\",{\"sourceInterval\":[2470,2482]},[\"seq\",{\"sourceInterval\":[2471,2480]},[\"not\",{\"sourceInterval\":[2471,2476]},[\"terminal\",{\"sourceInterval\":[2472,2476]},\"*/\"]],[\"app\",{\"sourceInterval\":[2477,2480]},\"any\",[]]]],[\"terminal\",{\"sourceInterval\":[2483,2487]},\"*/\"]]],\"comment\":[\"define\",{\"sourceInterval\":[2398,2501]},null,[],[\"alt\",{\"sourceInterval\":[2412,2501]},[\"app\",{\"sourceInterval\":[2412,2443]},\"comment_singleLine\",[]],[\"app\",{\"sourceInterval\":[2465,2487]},\"comment_multiLine\",[]]]],\"tokens\":[\"define\",{\"sourceInterval\":[2505,2520]},null,[],[\"star\",{\"sourceInterval\":[2514,2520]},[\"app\",{\"sourceInterval\":[2514,2519]},\"token\",[]]]],\"token\":[\"define\",{\"sourceInterval\":[2524,2600]},null,[],[\"alt\",{\"sourceInterval\":[2532,2600]},[\"app\",{\"sourceInterval\":[2532,2540]},\"caseName\",[]],[\"app\",{\"sourceInterval\":[2543,2550]},\"comment\",[]],[\"app\",{\"sourceInterval\":[2553,2558]},\"ident\",[]],[\"app\",{\"sourceInterval\":[2561,2569]},\"operator\",[]],[\"app\",{\"sourceInterval\":[2572,2583]},\"punctuation\",[]],[\"app\",{\"sourceInterval\":[2586,2594]},\"terminal\",[]],[\"app\",{\"sourceInterval\":[2597,2600]},\"any\",[]]]],\"operator\":[\"define\",{\"sourceInterval\":[2604,2669]},null,[],[\"alt\",{\"sourceInterval\":[2615,2669]},[\"terminal\",{\"sourceInterval\":[2615,2619]},\"<:\"],[\"terminal\",{\"sourceInterval\":[2622,2625]},\"=\"],[\"terminal\",{\"sourceInterval\":[2628,2632]},\":=\"],[\"terminal\",{\"sourceInterval\":[2635,2639]},\"+=\"],[\"terminal\",{\"sourceInterval\":[2642,2645]},\"*\"],[\"terminal\",{\"sourceInterval\":[2648,2651]},\"+\"],[\"terminal\",{\"sourceInterval\":[2654,2657]},\"?\"],[\"terminal\",{\"sourceInterval\":[2660,2663]},\"~\"],[\"terminal\",{\"sourceInterval\":[2666,2669]},\"&\"]]],\"punctuation\":[\"define\",{\"sourceInterval\":[2673,2709]},null,[],[\"alt\",{\"sourceInterval\":[2687,2709]},[\"terminal\",{\"sourceInterval\":[2687,2690]},\"<\"],[\"terminal\",{\"sourceInterval\":[2693,2696]},\">\"],[\"terminal\",{\"sourceInterval\":[2699,2702]},\",\"],[\"terminal\",{\"sourceInterval\":[2705,2709]},\"--\"]]]}]);\n", "import ohmGrammar from '../dist/ohm-grammar.js';\nimport {Builder} from './Builder.js';\nimport * as common from './common.js';\nimport * as errors from './errors.js';\nimport {Grammar} from './Grammar.js';\nimport * as pexprs from './pexprs.js';\n\nconst superSplicePlaceholder = Object.create(pexprs.PExpr.prototype);\n\nfunction namespaceHas(ns, name) {\n  // Look for an enumerable property, anywhere in the prototype chain.\n  for (const prop in ns) {\n    if (prop === name) return true;\n  }\n  return false;\n}\n\n// Returns a Grammar instance (i.e., an object with a `match` method) for\n// `tree`, which is the concrete syntax tree of a user-written grammar.\n// The grammar will be assigned into `namespace` under the name of the grammar\n// as specified in the source.\nexport function buildGrammar(match, namespace, optOhmGrammarForTesting) {\n  const builder = new Builder();\n  let decl;\n  let currentRuleName;\n  let currentRuleFormals;\n  let overriding = false;\n  const metaGrammar = optOhmGrammarForTesting || ohmGrammar;\n\n  // A visitor that produces a Grammar instance from the CST.\n  const helpers = metaGrammar.createSemantics().addOperation('visit', {\n    Grammars(grammarIter) {\n      return grammarIter.children.map(c => c.visit());\n    },\n    Grammar(id, s, _open, rules, _close) {\n      const grammarName = id.visit();\n      decl = builder.newGrammar(grammarName);\n      s.child(0) && s.child(0).visit();\n      rules.children.map(c => c.visit());\n      const g = decl.build();\n      g.source = this.source.trimmed();\n      if (namespaceHas(namespace, grammarName)) {\n        throw errors.duplicateGrammarDeclaration(g, namespace);\n      }\n      namespace[grammarName] = g;\n      return g;\n    },\n\n    SuperGrammar(_, n) {\n      const superGrammarName = n.visit();\n      if (superGrammarName === 'null') {\n        decl.withSuperGrammar(null);\n      } else {\n        if (!namespace || !namespaceHas(namespace, superGrammarName)) {\n          throw errors.undeclaredGrammar(superGrammarName, namespace, n.source);\n        }\n        decl.withSuperGrammar(namespace[superGrammarName]);\n      }\n    },\n\n    Rule_define(n, fs, d, _, b) {\n      currentRuleName = n.visit();\n      currentRuleFormals = fs.children.map(c => c.visit())[0] || [];\n      // If there is no default start rule yet, set it now. This must be done before visiting\n      // the body, because it might contain an inline rule definition.\n      if (!decl.defaultStartRule && decl.ensureSuperGrammar() !== Grammar.ProtoBuiltInRules) {\n        decl.withDefaultStartRule(currentRuleName);\n      }\n      const body = b.visit();\n      const description = d.children.map(c => c.visit())[0];\n      const source = this.source.trimmed();\n      return decl.define(currentRuleName, currentRuleFormals, body, description, source);\n    },\n    Rule_override(n, fs, _, b) {\n      currentRuleName = n.visit();\n      currentRuleFormals = fs.children.map(c => c.visit())[0] || [];\n\n      const source = this.source.trimmed();\n      decl.ensureSuperGrammarRuleForOverriding(currentRuleName, source);\n\n      overriding = true;\n      const body = b.visit();\n      overriding = false;\n      return decl.override(currentRuleName, currentRuleFormals, body, null, source);\n    },\n    Rule_extend(n, fs, _, b) {\n      currentRuleName = n.visit();\n      currentRuleFormals = fs.children.map(c => c.visit())[0] || [];\n      const body = b.visit();\n      const source = this.source.trimmed();\n      return decl.extend(currentRuleName, currentRuleFormals, body, null, source);\n    },\n    RuleBody(_, terms) {\n      return builder.alt(...terms.visit()).withSource(this.source);\n    },\n    OverrideRuleBody(_, terms) {\n      const args = terms.visit();\n\n      // Check if the super-splice operator (`...`) appears in the terms.\n      const expansionPos = args.indexOf(superSplicePlaceholder);\n      if (expansionPos >= 0) {\n        const beforeTerms = args.slice(0, expansionPos);\n        const afterTerms = args.slice(expansionPos + 1);\n\n        // Ensure it appears no more than once.\n        afterTerms.forEach(t => {\n          if (t === superSplicePlaceholder) throw errors.multipleSuperSplices(t);\n        });\n\n        return new pexprs.Splice(\n          decl.superGrammar,\n          currentRuleName,\n          beforeTerms,\n          afterTerms\n        ).withSource(this.source);\n      } else {\n        return builder.alt(...args).withSource(this.source);\n      }\n    },\n    Formals(opointy, fs, cpointy) {\n      return fs.visit();\n    },\n\n    Params(opointy, ps, cpointy) {\n      return ps.visit();\n    },\n\n    Alt(seqs) {\n      return builder.alt(...seqs.visit()).withSource(this.source);\n    },\n\n    TopLevelTerm_inline(b, n) {\n      const inlineRuleName = currentRuleName + '_' + n.visit();\n      const body = b.visit();\n      const source = this.source.trimmed();\n      const isNewRuleDeclaration = !(\n        decl.superGrammar && decl.superGrammar.rules[inlineRuleName]\n      );\n      if (overriding && !isNewRuleDeclaration) {\n        decl.override(inlineRuleName, currentRuleFormals, body, null, source);\n      } else {\n        decl.define(inlineRuleName, currentRuleFormals, body, null, source);\n      }\n      const params = currentRuleFormals.map(formal => builder.app(formal));\n      return builder.app(inlineRuleName, params).withSource(body.source);\n    },\n    OverrideTopLevelTerm_superSplice(_) {\n      return superSplicePlaceholder;\n    },\n\n    Seq(expr) {\n      return builder.seq(...expr.children.map(c => c.visit())).withSource(this.source);\n    },\n\n    Iter_star(x, _) {\n      return builder.star(x.visit()).withSource(this.source);\n    },\n    Iter_plus(x, _) {\n      return builder.plus(x.visit()).withSource(this.source);\n    },\n    Iter_opt(x, _) {\n      return builder.opt(x.visit()).withSource(this.source);\n    },\n\n    Pred_not(_, x) {\n      return builder.not(x.visit()).withSource(this.source);\n    },\n    Pred_lookahead(_, x) {\n      return builder.lookahead(x.visit()).withSource(this.source);\n    },\n\n    Lex_lex(_, x) {\n      return builder.lex(x.visit()).withSource(this.source);\n    },\n\n    Base_application(rule, ps) {\n      const params = ps.children.map(c => c.visit())[0] || [];\n      return builder.app(rule.visit(), params).withSource(this.source);\n    },\n    Base_range(from, _, to) {\n      return builder.range(from.visit(), to.visit()).withSource(this.source);\n    },\n    Base_terminal(expr) {\n      return builder.terminal(expr.visit()).withSource(this.source);\n    },\n    Base_paren(open, x, close) {\n      return x.visit();\n    },\n\n    ruleDescr(open, t, close) {\n      return t.visit();\n    },\n    ruleDescrText(_) {\n      return this.sourceString.trim();\n    },\n\n    caseName(_, space1, n, space2, end) {\n      return n.visit();\n    },\n\n    name(first, rest) {\n      return this.sourceString;\n    },\n    nameFirst(expr) {},\n    nameRest(expr) {},\n\n    terminal(open, cs, close) {\n      return cs.children.map(c => c.visit()).join('');\n    },\n\n    oneCharTerminal(open, c, close) {\n      return c.visit();\n    },\n\n    escapeChar(c) {\n      try {\n        return common.unescapeCodePoint(this.sourceString);\n      } catch (err) {\n        if (err instanceof RangeError && err.message.startsWith('Invalid code point ')) {\n          throw errors.invalidCodePoint(c);\n        }\n        throw err; // Rethrow\n      }\n    },\n\n    NonemptyListOf(x, _, xs) {\n      return [x.visit()].concat(xs.children.map(c => c.visit()));\n    },\n    EmptyListOf() {\n      return [];\n    },\n\n    _terminal() {\n      return this.sourceString;\n    },\n  });\n  return helpers(match).visit();\n}\n", "import {makeRecipe} from '../src/main-kernel.js';\nexport default makeRecipe([\"grammar\",{\"source\":\"OperationsAndAttributes {\\n\\n  AttributeSignature =\\n    name\\n\\n  OperationSignature =\\n    name Formals?\\n\\n  Formals\\n    = \\\"(\\\" ListOf<name, \\\",\\\"> \\\")\\\"\\n\\n  name  (a name)\\n    = nameFirst nameRest*\\n\\n  nameFirst\\n    = \\\"_\\\"\\n    | letter\\n\\n  nameRest\\n    = \\\"_\\\"\\n    | alnum\\n\\n}\"},\"OperationsAndAttributes\",null,\"AttributeSignature\",{\"AttributeSignature\":[\"define\",{\"sourceInterval\":[29,58]},null,[],[\"app\",{\"sourceInterval\":[54,58]},\"name\",[]]],\"OperationSignature\":[\"define\",{\"sourceInterval\":[62,100]},null,[],[\"seq\",{\"sourceInterval\":[87,100]},[\"app\",{\"sourceInterval\":[87,91]},\"name\",[]],[\"opt\",{\"sourceInterval\":[92,100]},[\"app\",{\"sourceInterval\":[92,99]},\"Formals\",[]]]]],\"Formals\":[\"define\",{\"sourceInterval\":[104,143]},null,[],[\"seq\",{\"sourceInterval\":[118,143]},[\"terminal\",{\"sourceInterval\":[118,121]},\"(\"],[\"app\",{\"sourceInterval\":[122,139]},\"ListOf\",[[\"app\",{\"sourceInterval\":[129,133]},\"name\",[]],[\"terminal\",{\"sourceInterval\":[135,138]},\",\"]]],[\"terminal\",{\"sourceInterval\":[140,143]},\")\"]]],\"name\":[\"define\",{\"sourceInterval\":[147,187]},\"a name\",[],[\"seq\",{\"sourceInterval\":[168,187]},[\"app\",{\"sourceInterval\":[168,177]},\"nameFirst\",[]],[\"star\",{\"sourceInterval\":[178,187]},[\"app\",{\"sourceInterval\":[178,186]},\"nameRest\",[]]]]],\"nameFirst\":[\"define\",{\"sourceInterval\":[191,223]},null,[],[\"alt\",{\"sourceInterval\":[207,223]},[\"terminal\",{\"sourceInterval\":[207,210]},\"_\"],[\"app\",{\"sourceInterval\":[217,223]},\"letter\",[]]]],\"nameRest\":[\"define\",{\"sourceInterval\":[227,257]},null,[],[\"alt\",{\"sourceInterval\":[242,257]},[\"terminal\",{\"sourceInterval\":[242,245]},\"_\"],[\"app\",{\"sourceInterval\":[252,257]},\"alnum\",[]]]]}]);\n", "import operationsAndAttributesGrammar from '../dist/operations-and-attributes.js';\nimport {Grammar} from './Grammar.js';\nimport {Semantics} from './Semantics.js';\n\ninitBuiltInSemantics(Grammar.BuiltInRules);\ninitPrototypeParser(operationsAndAttributesGrammar); // requires BuiltInSemantics\n\nfunction initBuiltInSemantics(builtInRules) {\n  const actions = {\n    empty() {\n      return this.iteration();\n    },\n    nonEmpty(first, _, rest) {\n      return this.iteration([first].concat(rest.children));\n    },\n    self(..._children) {\n      return this;\n    },\n  };\n\n  Semantics.BuiltInSemantics = Semantics.createSemantics(builtInRules, null).addOperation(\n    'asIteration',\n    {\n      emptyListOf: actions.empty,\n      nonemptyListOf: actions.nonEmpty,\n      EmptyListOf: actions.empty,\n      NonemptyListOf: actions.nonEmpty,\n      _iter: actions.self,\n    }\n  );\n}\n\nfunction initPrototypeParser(grammar) {\n  Semantics.prototypeGrammarSemantics = grammar.createSemantics().addOperation('parse', {\n    AttributeSignature(name) {\n      return {\n        name: name.parse(),\n        formals: [],\n      };\n    },\n    OperationSignature(name, optFormals) {\n      return {\n        name: name.parse(),\n        formals: optFormals.children.map(c => c.parse())[0] || [],\n      };\n    },\n    Formals(oparen, fs, cparen) {\n      return fs.asIteration().children.map(c => c.parse());\n    },\n    name(first, rest) {\n      return this.sourceString;\n    },\n  });\n  Semantics.prototypeGrammar = grammar;\n}\n", "export function findIndentation(input) {\n  let pos = 0;\n  const stack = [0];\n  const topOfStack = () => stack[stack.length - 1];\n\n  const result = {};\n\n  const regex = /( *).*(?:$|\\r?\\n|\\r)/g;\n  let match;\n  while ((match = regex.exec(input)) != null) {\n    const [line, indent] = match;\n\n    // The last match will always have length 0. In every other case, some\n    // characters will be matched (possibly only the end of line chars).\n    if (line.length === 0) break;\n\n    const indentSize = indent.length;\n    const prevSize = topOfStack();\n\n    const indentPos = pos + indentSize;\n\n    if (indentSize > prevSize) {\n      // Indent -- always only 1.\n      stack.push(indentSize);\n      result[indentPos] = 1;\n    } else if (indentSize < prevSize) {\n      // Dedent -- can be multiple levels.\n      const prevLength = stack.length;\n      while (topOfStack() !== indentSize) {\n        stack.pop();\n      }\n      result[indentPos] = -1 * (prevLength - stack.length);\n    }\n    pos += line.length;\n  }\n  // Ensure that there is a matching DEDENT for every remaining INDENT.\n  if (stack.length > 1) {\n    result[pos] = 1 - stack.length;\n  }\n  return result;\n}\n", "import BuiltInRules from '../dist/built-in-rules.js';\nimport {Builder} from '../src/Builder.js';\nimport {Failure} from '../src/Failure.js';\nimport {TerminalNode} from '../src/nodes.js';\nimport * as pexprs from '../src/pexprs.js';\nimport {findIndentation} from './findIndentation.js';\nimport {InputStream} from './InputStream.js';\n\nconst INDENT_DESCRIPTION = 'an indented block';\nconst DEDENT_DESCRIPTION = 'a dedent';\n\n// A sentinel value that is out of range for both charCodeAt() and codePointAt().\nconst INVALID_CODE_POINT = 0x10ffff + 1;\n\nclass InputStreamWithIndentation extends InputStream {\n  constructor(state) {\n    super(state.input);\n    this.state = state;\n  }\n\n  _indentationAt(pos) {\n    return this.state.userData[pos] || 0;\n  }\n\n  atEnd() {\n    return super.atEnd() && this._indentationAt(this.pos) === 0;\n  }\n\n  next() {\n    if (this._indentationAt(this.pos) !== 0) {\n      this.examinedLength = Math.max(this.examinedLength, this.pos);\n      return undefined;\n    }\n    return super.next();\n  }\n\n  nextCharCode() {\n    if (this._indentationAt(this.pos) !== 0) {\n      this.examinedLength = Math.max(this.examinedLength, this.pos);\n      return INVALID_CODE_POINT;\n    }\n    return super.nextCharCode();\n  }\n\n  nextCodePoint() {\n    if (this._indentationAt(this.pos) !== 0) {\n      this.examinedLength = Math.max(this.examinedLength, this.pos);\n      return INVALID_CODE_POINT;\n    }\n    return super.nextCodePoint();\n  }\n}\n\nclass Indentation extends pexprs.PExpr {\n  constructor(isIndent = true) {\n    super();\n    this.isIndent = isIndent;\n  }\n\n  allowsSkippingPrecedingSpace() {\n    return true;\n  }\n\n  eval(state) {\n    const {inputStream} = state;\n    const pseudoTokens = state.userData;\n    state.doNotMemoize = true;\n\n    const origPos = inputStream.pos;\n\n    const sign = this.isIndent ? 1 : -1;\n    const count = (pseudoTokens[origPos] || 0) * sign;\n    if (count > 0) {\n      // Update the count to consume the pseudotoken.\n      state.userData = Object.create(pseudoTokens);\n      state.userData[origPos] -= sign;\n\n      state.pushBinding(new TerminalNode(0), origPos);\n      return true;\n    } else {\n      state.processFailure(origPos, this);\n      return false;\n    }\n  }\n\n  getArity() {\n    return 1;\n  }\n\n  _assertAllApplicationsAreValid(ruleName, grammar) {}\n\n  _isNullable(grammar, memo) {\n    return false;\n  }\n\n  assertChoicesHaveUniformArity(ruleName) {}\n\n  assertIteratedExprsAreNotNullable(grammar) {}\n\n  introduceParams(formals) {\n    return this;\n  }\n\n  substituteParams(actuals) {\n    return this;\n  }\n\n  toString() {\n    return this.isIndent ? 'indent' : 'dedent';\n  }\n\n  toDisplayString() {\n    return this.toString();\n  }\n\n  toFailure(grammar) {\n    const description = this.isIndent ? INDENT_DESCRIPTION : DEDENT_DESCRIPTION;\n    return new Failure(this, description, 'description');\n  }\n}\n\n// Create a new definition for `any` that can consume indent & dedent.\nconst applyIndent = new pexprs.Apply('indent');\nconst applyDedent = new pexprs.Apply('dedent');\nconst newAnyBody = new pexprs.Splice(BuiltInRules, 'any', [applyIndent, applyDedent], []);\n\nexport const IndentationSensitive = new Builder()\n  .newGrammar('IndentationSensitive')\n  .withSuperGrammar(BuiltInRules)\n  .define('indent', [], new Indentation(true), INDENT_DESCRIPTION, undefined, true)\n  .define('dedent', [], new Indentation(false), DEDENT_DESCRIPTION, undefined, true)\n  .extend('any', [], newAnyBody, 'any character', undefined)\n  .build();\n\nObject.assign(IndentationSensitive, {\n  _matchStateInitializer(state) {\n    state.userData = findIndentation(state.input);\n    state.inputStream = new InputStreamWithIndentation(state);\n  },\n  supportsIncrementalParsing: false,\n});\n", "// Generated by scripts/prebuild.js\nexport const version = '17.3.0';\n", "import ohmGrammar from '../dist/ohm-grammar.js';\nimport {buildGrammar} from './buildGrammar.js';\nimport * as common from './common.js';\nimport * as errors from './errors.js';\nimport {Grammar} from './Grammar.js';\nimport * as pexprs from './pexprs.js';\nimport * as util from './util.js';\n\n// Late initialization for stuff that is bootstrapped.\n\nimport './semanticsDeferredInit.js'; // TODO: Clean this up.\nGrammar.initApplicationParser(ohmGrammar, buildGrammar);\n\nconst isBuffer = obj =>\n  !!obj.constructor &&\n  typeof obj.constructor.isBuffer === 'function' &&\n  obj.constructor.isBuffer(obj);\n\nfunction compileAndLoad(source, namespace) {\n  const m = ohmGrammar.match(source, 'Grammars');\n  if (m.failed()) {\n    throw errors.grammarSyntaxError(m);\n  }\n  return buildGrammar(m, namespace);\n}\n\nexport function grammar(source, optNamespace) {\n  const ns = grammars(source, optNamespace);\n\n  // Ensure that the source contained no more than one grammar definition.\n  const grammarNames = Object.keys(ns);\n  if (grammarNames.length === 0) {\n    throw new Error('Missing grammar definition');\n  } else if (grammarNames.length > 1) {\n    const secondGrammar = ns[grammarNames[1]];\n    const interval = secondGrammar.source;\n    throw new Error(\n      util.getLineAndColumnMessage(interval.sourceString, interval.startIdx) +\n        'Found more than one grammar definition -- use ohm.grammars() instead.'\n    );\n  }\n  return ns[grammarNames[0]]; // Return the one and only grammar.\n}\n\nexport function grammars(source, optNamespace) {\n  const ns = Object.create(optNamespace || {});\n  if (typeof source !== 'string') {\n    // For convenience, detect Node.js Buffer objects and automatically call toString().\n    if (isBuffer(source)) {\n      source = source.toString();\n    } else {\n      throw new TypeError(\n        'Expected string as first argument, got ' + common.unexpectedObjToString(source)\n      );\n    }\n  }\n  compileAndLoad(source, ns);\n  return ns;\n}\n\n// This is used by ohm-editor to instantiate grammars after incremental\n// parsing, which is not otherwise supported in the public API.\nexport {buildGrammar as _buildGrammar};\n\nexport * from './main-kernel.js';\nexport {IndentationSensitive as ExperimentalIndentationSensitive} from './IndentationSensitive.js';\nexport {ohmGrammar};\nexport {pexprs};\nexport {version} from './version.js';\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getAST = getAST;\nconst fs = __importStar(({}));\nconst path = __importStar(({}));\nconst ohm = __importStar(require(\"ohm-js\"));\n__exportStar(({}), exports);\n// Load Grammar\n// grammarPath suppressed\nconst grammarContent = \"GRAM {\\n  Recipe = Frontmatter? Content?\\n  \\n  Content = \\n    | (nl* Section)+      -- explicit\\n    | (nl* Block)+        -- implicit\\n\\n  Frontmatter = \\\"---\\\" nl KeyValue* \\\"---\\\" (nl | end)\\n  KeyValue = key \\\":\\\" sp* value nl\\n  key = (alnum | \\\"_\\\" | \\\"-\\\")+\\n  value = (~nl any)*\\n\\n  Section = header Block*\\n  header = \\\"##\\\" sp+ title headerExtension? sp* nl+\\n  headerExtension = \\n      | retroPlanning sp* intermediateDecl?  -- retro\\n      | intermediateDecl                     -- decl\\n  titleStop = nl | \\\"->&\\\" | \\\"{T-\\\"\\n  title = (~titleStop any)*\\n  \\n  retroPlanning = \\\"{T-\\\" (~\\\"}\\\" any)+ \\\"}\\\"\\n  \\n  Block = \\n    | Comment nl*       -- comment\\n    | (~header step)    -- step\\n  \\n  step = startAction? line (nl line)* (nl+ | end)\\n  startAction = \\\"[\\\" (~\\\"]\\\" any)+ \\\"]\\\" sp*\\n  line = stepContent+\\n  stepContent = \\n    | text\\n    | ws\\n    | intermediateDecl\\n    | applySyntactic<Element> \\n    | fallback\\n    \\n  ws = space+\\n\\n  fallback = ~nl any\\n\\n  Element = \\n    | Ingredient\\n    | Cookware\\n    | Timer\\n    | Temperature\\n    | Reference\\n    | CommentBlock\\n    | Comment\\n\\n  intermediateDecl = \\\"->&\\\" name \\\"{}\\\"\\n\\n  // Ingredients\\n  Ingredient = \\n     | Alternative\\n     | simpleIngredient\\n\\n  Alternative = simpleIngredient (\\\"|\\\" simpleIngredient)+\\n  \\n  // Rule: Quantity is mandatory (it's the delimiter)\\n  simpleIngredient = \\\"@\\\" modifier* name alias? ingredientQuantity preparation? composite?\\n\\n  modifier = \\\"?\\\" | \\\"-\\\" | \\\"*\\\" | \\\"&\\\"\\n  alias = \\\"[\\\" space* name space* \\\"]\\\"\\n  ingredientQuantity = \\\"{\\\" space* (relativeQuantity | absoluteQuantity) space* \\\"}\\\"\\n  relativeQuantity = number space* \\\"%\\\" space* (\\\"@\\\" | \\\"&\\\") space* name\\n  absoluteQuantity = (fixed space*)? (range | number)? space* (unit space*)?\\n  textQuantity = \\\"{\\\" space* (~\\\"}\\\" any)+ space* \\\"}\\\"\\n  fixed = \\\"=\\\"\\n  unit = unitName\\n  unitName = (alnum | sp | \\\"\u00B0\\\" | \\\"%\\\")+\\n  preparation = \\\"(\\\" (~\\\")\\\" any)* \\\")\\\"\\n  composite = \\\"<\\\" space* \\\"@\\\" space* name space* ingredientQuantity?\\n\\n  // Cookware\\n  // Specs say use braces too.\\n  Cookware = \\n    | CookwareAlternative\\n    | simpleCookware\\n\\n  CookwareAlternative = simpleCookware (\\\"|\\\" simpleCookware)+\\n  simpleCookware = \\\"#\\\" modifier* name alias? cookwareQuantity preparation?\\n\\n  // Restrict cookware quantity to only numbers/fixed, NO UNITS.\\n  // Allowed: {}, {2}, {=1}\\n  cookwareQuantity = \\\"{\\\" space* (fixed space*)? number? space* \\\"}\\\"\\n\\n  // Timer\\n  Timer = \\\"~\\\" name? ingredientQuantity \\\"&\\\"?\\n  \\n  // Temperature\\n  Temperature = \\\"!\\\" name? (ingredientQuantity | textQuantity)\\n\\n\\n  // Comments\\n  Comment = \\\"//\\\" (~nl any)*\\n  CommentBlock = \\\"/*\\\" (~\\\"*/\\\" any)* \\\"*/\\\"\\n\\n  // Primitives\\n  name = (~(syntaxChar | nl) any)+\\n  \\n  number = digit+ (\\\".\\\" digit+)? (\\\"/\\\" digit+)?\\n  range = number space* \\\"-\\\" space* number\\n\\n  text = space* (~(elementStart | nl) any)+\\n  \\n  Reference = \\\"&\\\" name ingredientQuantity\\n\\n  // SyntaxChar used for name content exclusion\\n  // Restricted to true delimiters that start a new component\\n  syntaxChar = \\\"{\\\" | \\\"}\\\" | \\\"[\\\" | \\\"]\\\" | \\\"(\\\" | \\\")\\\" | \\\"<\\\" | \\\"|\\\" \\n  \\n  // Name can contain '&' or '@' or other symbols, as long as it doesn't look like a start of a new element if specific context requires it?\\n  // Actually, standard grammar strategy: consume until a known delimiter.\\n  // The delimiters are:\\n  // - `{` (start of quantity)\\n  // - `[` (start of alias)\\n  // - `(` (start of preparation)\\n  // - `<` (start of composite)\\n  // - `|` (start of alternative)\\n  // - newline\\n  \\n  // We removed @, #, ~, !, &, ?, * from syntaxChar list effectively allowing them in names.\\n\\n  \\n  // ElementStart used for text content exclusion\\n  // This remains strict to identify WHERE an element starts in free text.\\n  elementStart = \\\"@\\\" | \\\"#\\\" | \\\"~\\\" | \\\"!\\\" | \\\"//\\\" | \\\"/*\\\" | \\\"->&\\\" | \\\"&\\\"\\n  \\n  nl = \\\"\\\\r\\\"? \\\"\\\\n\\\"\\n  sp = \\\" \\\" | \\\"\\\\t\\\"\\n  space := sp\\n}\\n\";\nconst grammar = ohm.grammar(grammarContent);\n// ----------------------------------------------------------------------------\n// HELPERS\n// ----------------------------------------------------------------------------\n/**\n * Trims a string.\n */\nconst clean = (str) => str.trim();\n/**\n * Safely extracts the AST from an optional node (0 or 1 child).\n * Returns null if the node has no children.\n */\nconst getOpt = (node) => (node.children.length > 0 ? node.children[0].toAST() : null);\n/**\n * Parses a fractional or decimal string into a value object.\n * e.g., \"1/2\" -> { type: 'fraction', value: 0.5, ... }\n */\nconst parseNumber = (n) => {\n    if (!n)\n        return null;\n    const [numStr, denStr] = n.split('/');\n    if (denStr) {\n        const num = parseInt(numStr);\n        const den = parseInt(denStr);\n        return { type: 'fraction', value: num / den, numerator: num, denominator: den, text: n };\n    }\n    else {\n        return { type: 'single', value: parseFloat(n), text: n };\n    }\n};\n/**\n * Parses values from Frontmatter (removing quotes, brackets, etc.)\n */\nconst parseFrontmatterValue = (val) => {\n    val = val.trim();\n    // Helper to strip surrounding quotes\n    const strip = (s) => (s && (s.startsWith(\"'\") || s.startsWith('\"')) && s[0] === s[s.length - 1]) ? s.slice(1, -1) : s;\n    // Handle Arrays [a, b]\n    if (val.startsWith('[') && val.endsWith(']')) {\n        const inner = val.slice(1, -1).trim();\n        return inner ? inner.split(',').map(s => strip(s.trim())) : [];\n    }\n    return strip(val);\n};\n// ----------------------------------------------------------------------------\n// SEMANTICS\n// ----------------------------------------------------------------------------\nconst semantics = grammar.createSemantics();\nsemantics.addOperation('toAST', {\n    // --- Structure ---\n    Recipe(frontmatter, content) {\n        const meta = getOpt(frontmatter) || {};\n        const sections = getOpt(content) || [];\n        return { type: 'Recipe', meta, children: sections };\n    },\n    Frontmatter(_1, _2, kv, _3, _4) {\n        // Merge all KeyValues into a single object\n        return kv.children\n            .map(c => c.toAST())\n            .reduce((acc, curr) => ({ ...acc, ...curr }), {});\n    },\n    KeyValue(key, _1, _2, value, _3) {\n        return { [key.sourceString]: parseFrontmatterValue(value.sourceString) };\n    },\n    Content_explicit(_nls, sections) {\n        return sections.children.map(s => s.toAST());\n    },\n    Content_implicit(nls, blocks) {\n        return blocks.children.map(b => b.toAST());\n    },\n    Section(header, blocks) {\n        const h = header.toAST();\n        return {\n            type: 'Section',\n            title: h.title,\n            retroPlanning: h.retroPlanning,\n            intermediateDecl: h.intermediateDecl,\n            children: blocks.children.map(b => b.toAST()),\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    header(_1, _2, title, extension, _3, _4) {\n        let retroPlanning = null;\n        let intermediateDecl = null;\n        const ext = getOpt(extension);\n        if (ext) {\n            // headerExtension semantic action returns { retroPlanning, intermediateDecl }\n            retroPlanning = ext.retroPlanning;\n            intermediateDecl = ext.intermediateDecl;\n        }\n        return {\n            title: clean(title.sourceString).replace(/^##\\s*/, ''),\n            retroPlanning,\n            intermediateDecl\n        };\n    },\n    headerExtension_retro(retro, _sp, decl) {\n        const intermediate = getOpt(decl);\n        return { retroPlanning: retro.toAST(), intermediateDecl: intermediate };\n    },\n    headerExtension_decl(decl) {\n        return { retroPlanning: null, intermediateDecl: decl.toAST() };\n    },\n    retroPlanning(_1, content, _2) {\n        return clean(content.sourceString);\n    },\n    // --- Blocks & Steps ---\n    Block_comment(comment, _nls) { return comment.toAST(); },\n    Block_step(child) { return child.toAST(); },\n    step(actionNode, line1, _nls, lines, _term) {\n        const action = getOpt(actionNode);\n        // Combine first line with subsequent lines, joined by a space\n        const content = [line1.toAST()];\n        lines.children.forEach(l => {\n            content.push([{ type: 'Text', value: ' ' }]); // Space separator\n            content.push(l.toAST());\n        });\n        // Flatten the array to unify text/ingredients flow\n        const flatContent = content.flat().filter(c => c !== null);\n        return {\n            type: 'Step',\n            action,\n            children: flatContent,\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    startAction(_lb, txt, _rb, _sp) { return clean(txt.sourceString); },\n    line(items) { return items.children.map(i => i.toAST()); },\n    stepContent(child) { return child.toAST(); },\n    intermediateDecl(_1, name, _2) {\n        return { type: 'IntermediateDecl', name: clean(name.sourceString) };\n    },\n    // --- Text & Primitives ---\n    text(spaces, chars) {\n        const val = spaces.sourceString + chars.sourceString;\n        return { type: 'Text', value: val, loc: { start: this.source.startIdx, end: this.source.endIdx } };\n    },\n    fallback(c) {\n        return { type: 'Text', value: c.sourceString, fallback: true, loc: { start: this.source.startIdx, end: this.source.endIdx } };\n    },\n    nl(_r, _n) { return null; },\n    ws(s) { return { type: 'Text', value: s.sourceString }; },\n    // --- Ingredients ---\n    Ingredient(child) { return child.toAST(); },\n    Alternative(first, _bars, rest) {\n        const options = [first.toAST(), ...rest.children.map(c => c.toAST())];\n        return { type: 'Alternative', options, loc: { start: this.source.startIdx, end: this.source.endIdx } };\n    },\n    simpleIngredient(_at, _mods, _name, _alias, _qty, _prep, _comp) {\n        const modifiers = _mods.children.map(m => m.sourceString);\n        return {\n            type: 'Ingredient',\n            name: _name.sourceString.trim(),\n            modifiers,\n            quantity: _qty.toAST(),\n            alias: getOpt(_alias),\n            preparation: getOpt(_prep),\n            composite: getOpt(_comp),\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    composite(_lt, _sp1, _at, _sp2, _name, _sp3, _qty) {\n        return {\n            type: 'Composite',\n            parent: _name.sourceString,\n            quantity: getOpt(_qty)\n        };\n    },\n    alias(_lb, _sp1, name, _sp2, _rb) { return clean(name.sourceString); },\n    preparation(_lp, text, _rp) { return clean(text.sourceString); },\n    unit(name) { return clean(name.sourceString); },\n    ingredientQuantity(_lb, _s1, content, _s3, _rb) {\n        return content.toAST();\n    },\n    relativeQuantity(val, _s1, _pct, _s2, marker, _s3, name) {\n        return {\n            type: 'RelativeQuantity',\n            percent: parseFloat(val.sourceString),\n            target: clean(name.sourceString),\n            referenceType: marker.sourceString === '&' ? 'variable' : 'ingredient',\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    absoluteQuantity(fixed, _sFixed, val, _s2, unit, _sUnit) {\n        return {\n            type: 'Quantity',\n            value: getOpt(val),\n            unit: getOpt(unit),\n            fixed: fixed.children.length > 0,\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    cookwareQuantity(_lb, _s1, fixed, _sFixed, val, _s2, _rb) {\n        return {\n            type: 'Quantity',\n            value: getOpt(val),\n            unit: null,\n            fixed: fixed.children.length > 0,\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    textQuantity(_lb, _s1, content, _s2, _rb) {\n        return { type: 'TextQuantity', value: clean(content.sourceString), loc: { start: this.source.startIdx, end: this.source.endIdx } };\n    },\n    number(_1, _2, _3, _4, _5) {\n        return parseNumber(this.sourceString);\n    },\n    range(n1, _s1, _, _s2, n2) {\n        const min = parseNumber(n1.sourceString);\n        const max = parseNumber(n2.sourceString);\n        if (min && max) {\n            const avg = (min.value + max.value) / 2;\n            return { type: 'range', value: avg, range: { min: min.value, max: max.value }, text: this.sourceString };\n        }\n        return null;\n    },\n    // --- Cookware ---\n    CookwareAlternative(first, _bars, rest) {\n        return {\n            type: 'Alternative',\n            options: [first.toAST(), ...rest.children.map(c => c.toAST())],\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    simpleCookware(_hash, mods, name, alias, qty, prep) {\n        const modifiers = mods.children.map(c => c.sourceString);\n        return {\n            type: 'Cookware',\n            name: clean(name.sourceString),\n            modifiers,\n            alias: getOpt(alias),\n            quantity: qty.toAST(), // Mandatory\n            preparation: getOpt(prep),\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    // --- Other Elements ---\n    Reference(_amp, _name, _qty) {\n        return {\n            type: 'Reference',\n            name: _name.sourceString,\n            quantity: _qty.toAST(),\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    Timer(_1, name, qty, asyncMod) {\n        const n = name.children.length > 0 ? clean(name.children[0].sourceString) : null;\n        return {\n            type: 'Timer',\n            name: n,\n            quantity: qty.toAST(),\n            isAsync: asyncMod.children.length > 0,\n            loc: { start: this.source.startIdx, end: this.source.endIdx }\n        };\n    },\n    Temperature(_1, name, qty) {\n        const n = name.children.length > 0 ? clean(name.children[0].sourceString) : null;\n        return { type: 'Temperature', name: n, quantity: qty.toAST(), loc: { start: this.source.startIdx, end: this.source.endIdx } };\n    },\n    Comment(_1, text) { return { type: 'Comment', value: text.sourceString, kind: 'line', loc: { start: this.source.startIdx, end: this.source.endIdx } }; },\n    CommentBlock(_1, text, _2) { return { type: 'Comment', value: text.sourceString, kind: 'block', loc: { start: this.source.startIdx, end: this.source.endIdx } }; },\n    _terminal() { return null; }\n});\n// ----------------------------------------------------------------------------\n// EXPORTS\n// ----------------------------------------------------------------------------\nfunction getAST(input) {\n    const match = grammar.match(input);\n    if (match.failed()) {\n        throw new Error(match.message);\n    }\n    return semantics(match).toAST();\n}\n// export function parse removed. Use getAST() and then compileFromAST() from gram-compiler.\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.quantityToMinutes = exports.getMass = exports.normalizeUnit = exports.UNIT_CONVERSIONS = void 0;\nexports.UNIT_CONVERSIONS = {\n    mass: {\n        base: 'g',\n        map: {\n            g: 1, gram: 1, grams: 1, gramme: 1, grammes: 1,\n            kg: 1000, kilogram: 1000, kilograms: 1000,\n            mg: 0.001, milligram: 0.001, milligrams: 0.001,\n            oz: 28.3495, ounce: 28.3495, ounces: 28.3495,\n            lb: 453.592, lbs: 453.592, pound: 453.592, pounds: 453.592\n        }\n    },\n    volume: {\n        base: 'ml',\n        map: {\n            ml: 1, milliliter: 1, milliliters: 1,\n            l: 1000, liter: 1000, liters: 1000, litre: 1000, litres: 1000,\n            cl: 10, centiliter: 10,\n            dl: 100, deciliter: 100,\n            tsp: 4.9289, teaspoon: 4.9289, teaspoons: 4.9289,\n            tbsp: 14.7868, tablespoon: 14.7868, tablespoons: 14.7868,\n            cup: 236.588, cups: 236.588,\n            pint: 473.176,\n            quart: 946.353,\n            gallon: 3785.41,\n            'fl oz': 29.5735, 'fluid ounce': 29.5735\n        }\n    }\n};\nconst normalizeUnit = (quantityObj, unit) => {\n    if (!quantityObj)\n        return { quantity: 0, unit: unit || null };\n    const u = (unit || '').toLowerCase().trim();\n    let val = quantityObj;\n    if (typeof quantityObj === 'object' && quantityObj.value !== undefined) {\n        val = quantityObj.value;\n    }\n    if (typeof val !== 'number')\n        return { quantity: quantityObj, unit: u };\n    for (const { base, map } of Object.values(exports.UNIT_CONVERSIONS)) {\n        if (map[u]) {\n            const newVal = val * map[u];\n            return { quantity: newVal, unit: base };\n        }\n    }\n    return { quantity: val, unit: u };\n};\nexports.normalizeUnit = normalizeUnit;\nconst getMass = (qty, unit) => {\n    let val = qty;\n    // Resolve object if needed\n    if (typeof qty === 'object' && qty !== null) {\n        if (qty.type === 'fraction')\n            val = qty.value;\n        else if (qty.type === 'range')\n            val = qty.value; // Average\n        else if (qty.type === 'single')\n            val = qty.value;\n        else\n            return { mass: 0, valid: false };\n    }\n    if (typeof val !== 'number')\n        return { mass: 0, valid: false };\n    const u = (unit || '').toLowerCase().trim();\n    if (exports.UNIT_CONVERSIONS.mass.map[u])\n        return { mass: val * exports.UNIT_CONVERSIONS.mass.map[u], valid: true };\n    if (exports.UNIT_CONVERSIONS.volume.map[u])\n        return { mass: val * exports.UNIT_CONVERSIONS.volume.map[u], valid: true }; // 1ml = 1g approximate\n    return { mass: 0, valid: false };\n};\nexports.getMass = getMass;\nconst quantityToMinutes = (qty) => {\n    if (!qty)\n        return 0;\n    let val = 0;\n    let unit = '';\n    // Handle AST objects\n    if (typeof qty === 'object') {\n        if (qty.type === 'Quantity' && qty.value) {\n            const sub = qty.value;\n            if (sub.type === 'single')\n                val = sub.value;\n            if (sub.type === 'fraction')\n                val = sub.value;\n            if (sub.type === 'range' && sub.range)\n                val = (sub.range.min + sub.range.max) / 2;\n            unit = qty.unit || '';\n        }\n        else if (qty.value !== undefined) {\n            // Fallback for simple objects\n            let raw = qty.value;\n            if (typeof raw === 'object' && raw !== null) {\n                if (raw.type === 'single')\n                    raw = raw.value;\n                else if (raw.type === 'fraction')\n                    raw = raw.value;\n                else if (raw.type === 'range' && raw.range)\n                    raw = (raw.range.min + raw.range.max) / 2;\n            }\n            val = raw;\n            unit = qty.unit || '';\n        }\n    }\n    else {\n        return 0;\n    }\n    if (typeof val !== 'number')\n        return 0;\n    const u = unit.toLowerCase().trim();\n    // Time conversions to minutes\n    if (u === 'h' || u === 'hour' || u === 'hours' || u === 'heure' || u === 'heures')\n        return val * 60;\n    if (u === 'm' || u === 'min' || u === 'minute' || u === 'minutes' || u === 'mins')\n        return val;\n    if (u === 's' || u === 'sec' || u === 'second' || u === 'seconds')\n        return val / 60;\n    return val; // Assume minutes if unknown? Or 0? Let's assume minutes if no unit for timers usually, but safety says 0 or keep val. \n    // However, the parser enforces units for timers usually.\n    // If unit is missing, it might be safer to return val (e.g. 10 -> 10m).\n    return val;\n};\nexports.quantityToMinutes = quantityToMinutes;\n", "\"use strict\";\n/**\n * Ingredient Database\n * Stores physical properties of common ingredients for mass estimation.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.INGREDIENT_DB = void 0;\nexports.getIngredientData = getIngredientData;\n// Top 50 Common Ingredients Data\n// Densities are approximate averages.\n// Internal Definition with Synonyms\nconst RAW_ENTRIES = [\n    // Basics\n    { names: ['water'], data: { density: 1.0 } },\n    { names: ['milk'], data: { density: 1.03 } },\n    { names: ['oil', 'vegetable oil', 'olive oil'], data: { density: 0.92 } },\n    { names: ['butter'], data: { density: 0.95, unit_weight: 113.4 } },\n    // Baking\n    { names: ['flour', 'all-purpose flour', 'wheat flour'], data: { density: 0.59 } },\n    { names: ['sugar', 'granulated sugar'], data: { density: 0.85 } },\n    { names: ['brown sugar'], data: { density: 0.93 } },\n    { names: ['powdered sugar', 'icing sugar', 'confectioners sugar'], data: { density: 0.56 } },\n    { names: ['salt'], data: { density: 1.2 } },\n    { names: ['honey'], data: { density: 1.42 } },\n    { names: ['yeast'], data: { density: 0.95 } },\n    { names: ['baking powder'], data: { density: 0.9 } },\n    { names: ['cocoa', 'cocoa powder'], data: { density: 0.45 } },\n    // Dairy\n    { names: ['cream', 'heavy cream'], data: { density: 1.01 } },\n    { names: ['yogurt', 'yoghurt'], data: { density: 1.06 } },\n    { names: ['cheese', 'cheddar'], data: { density: 0.6 } },\n    // Produce\n    { names: ['egg', 'eggs'], data: { density: 1.03, unit_weight: 55 } },\n    { names: ['egg yolk', 'egg yolks', 'yolk', 'yolks'], data: { density: 1.03, unit_weight: 18 } },\n    { names: ['egg white', 'egg whites', 'white', 'whites'], data: { density: 1.03, unit_weight: 33 } },\n    { names: ['lemon', 'lemons'], data: { density: 1.0, unit_weight: 120 } },\n    { names: ['lemon juice', 'juice'], data: { density: 1.04, unit_weight: 45 } }, // ~1 lemon yield\n    { names: ['lemon zest', 'zest'], data: { density: 0.5, unit_weight: 3 } }, // ~1 lemon yield\n    { names: ['lime', 'limes'], data: { density: 1.0, unit_weight: 60 } },\n    { names: ['onion', 'onions', 'yellow onion'], data: { density: 0.7, unit_weight: 150 } },\n    { names: ['red onion', 'red onions'], data: { density: 0.7, unit_weight: 150 } },\n    { names: ['garlic', 'garlic clove', 'garlic cloves'], data: { density: 0.6, unit_weight: 5 } },\n    { names: ['carrot', 'carrots'], data: { density: 0.7, unit_weight: 100 } },\n    { names: ['potato', 'potatoes', 'russet potato'], data: { density: 0.77, unit_weight: 200 } },\n    { names: ['apple', 'apples'], data: { density: 0.6, unit_weight: 180 } },\n    { names: ['banana', 'bananas'], data: { density: 0.9, unit_weight: 120 } },\n    { names: ['tomato', 'tomatoes'], data: { density: 0.95, unit_weight: 120 } },\n    { names: ['canned tomatoes', 'canned tomato'], data: { density: 1.1 } }, // denser\n    { names: ['bell pepper', 'red bell pepper', 'green bell pepper'], data: { density: 0.5, unit_weight: 150 } },\n    { names: ['chili', 'chili pepper', 'espelette pepper'], data: { density: 0.5, unit_weight: 15 } },\n    { names: ['ginger'], data: { density: 0.9, unit_weight: 30 } }, // ~2 inch piece\n    { names: ['spinach'], data: { density: 0.1, unit_weight: 300 } }, // bunch\n    // Meat & Protein\n    { names: ['chicken', 'chicken breast'], data: { density: 1.05, unit_weight: 200 } },\n    { names: ['chicken thigh', 'chicken thighs'], data: { density: 1.05, unit_weight: 120 } }, // boneless skinless\n    { names: ['beef', 'ground beef', 'steak'], data: { density: 1.05 } },\n    { names: ['pork', 'pork chop'], data: { density: 1.05, unit_weight: 150 } },\n    { names: ['bacon'], data: { density: 0.5 } }, // Rendered? Fried? Raw density ~1.\n    { names: ['tofu'], data: { density: 0.95 } },\n    // Spices (Ground) - Average density ~0.5 g/ml\n    { names: ['pepper', 'black pepper', 'ground pepper'], data: { density: 0.5 } },\n    { names: ['salt', 'sea salt'], data: { density: 1.2 } },\n    { names: ['cinnamon'], data: { density: 0.55 } },\n    { names: ['paprika'], data: { density: 0.45 } },\n    { names: ['cumin'], data: { density: 0.45 } },\n    { names: ['turmeric'], data: { density: 0.6 } },\n    // Stocks & Sauces\n    { names: ['stock', 'chicken stock', 'beef stock', 'vegetable stock', 'broth'], data: { density: 1.01 } },\n    { names: ['mayonnaise'], data: { density: 0.92 } },\n    { names: ['mustard'], data: { density: 1.05 } },\n    { names: ['ketchup'], data: { density: 1.15 } },\n    // Grains\n    { names: ['rice'], data: { density: 0.85 } },\n    { names: ['oats', 'rolled oats'], data: { density: 0.4 } },\n    { names: ['pasta'], data: { density: 0.5 } },\n    // Liquids\n    { names: ['wine', 'red wine', 'white wine'], data: { density: 0.99 } },\n    { names: ['vinegar'], data: { density: 1.01 } },\n    { names: ['soy sauce'], data: { density: 1.13 } },\n    { names: ['maple syrup'], data: { density: 1.32 } }\n];\n// Generate the fast lookup map efficiently\nexports.INGREDIENT_DB = {};\nRAW_ENTRIES.forEach(entry => {\n    entry.names.forEach(name => {\n        exports.INGREDIENT_DB[name] = entry.data;\n    });\n});\nfunction getIngredientData(name) {\n    const slug = name.toLowerCase().trim();\n    // Direct match\n    if (exports.INGREDIENT_DB[slug])\n        return exports.INGREDIENT_DB[slug];\n    // Simple singularization fallback (very naive)\n    if (slug.endsWith('s') && exports.INGREDIENT_DB[slug.slice(0, -1)]) {\n        return exports.INGREDIENT_DB[slug.slice(0, -1)];\n    }\n    return null;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.normalizeMass = normalizeMass;\nconst units_1 = require(\"./units\");\nconst ingredient_db_1 = require(\"./ingredient_db\");\nconst utils_1 = require(\"./utils\");\nfunction normalizeMass(amount, unit, ingredientName, overrides) {\n    if (!unit) {\n        // ...\n    }\n    const u = unit.toLowerCase().trim();\n    // 1. Physical Mass\n    const massMap = units_1.UNIT_CONVERSIONS.mass.map;\n    if (massMap[u] !== undefined) {\n        return { mass: amount * massMap[u], method: 'physical', isEstimate: false };\n    }\n    // 2. Volume -> Density\n    const volMap = units_1.UNIT_CONVERSIONS.volume.map;\n    if (volMap[u] !== undefined) {\n        const volumeMl = amount * volMap[u];\n        let density = 1.0; // Default Water\n        let method = 'default';\n        if (ingredientName) {\n            // Check overrides first\n            if (overrides && overrides[(0, utils_1.slugify)(ingredientName)]) {\n                density = overrides[(0, utils_1.slugify)(ingredientName)];\n                method = 'explicit';\n            }\n            else {\n                const data = (0, ingredient_db_1.getIngredientData)(ingredientName);\n                if (data) {\n                    density = data.density;\n                    method = 'density';\n                }\n            }\n        }\n        return {\n            mass: volumeMl * density,\n            method,\n            isEstimate: method !== 'explicit'\n        };\n    }\n    // 3. Fallback: Treat unknown units as Count/Unit units\n    // e.g. \"clove\", \"head\", \"stick\", \"slice\" -> treated as \"1 unit\" multiplier\n    if (ingredientName) {\n        // Check overrides first\n        if (overrides && overrides[(0, utils_1.slugify)(ingredientName)]) {\n            const unitWt = overrides[(0, utils_1.slugify)(ingredientName)];\n            return {\n                mass: amount * unitWt,\n                method: 'explicit',\n                // Careful: If the override was meant for density (g/ml), this might be ambiguous?\n                // But generally overrides for non-volume things imply unit weight.\n                isEstimate: false\n            };\n        }\n        const data = (0, ingredient_db_1.getIngredientData)(ingredientName);\n        if (data && data.unit_weight) {\n            return { mass: amount * data.unit_weight, method: 'unit_weight', isEstimate: true };\n        }\n    }\n    return null;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.cleanObject = exports.createCleanUsage = exports.minifyQuantity = exports.slugify = void 0;\nconst slugify = (text) => {\n    return text\n        .toString()\n        .toLowerCase()\n        .normalize('NFD')\n        .replace(/[\\u0300-\\u036f]/g, '')\n        .replace(/[^a-z0-9]+/g, '-')\n        .replace(/^-+|-+$/g, '')\n        || 'unknown';\n};\nexports.slugify = slugify;\nconst minifyQuantity = (q) => {\n    if (!q)\n        return undefined;\n    if (typeof q === 'number')\n        return q;\n    // Check for specific AST types or general structures\n    if (q.type === 'single' && q.value !== undefined)\n        return q.value;\n    if (q.type === 'range' || q.type === 'fraction')\n        return q;\n    // If it's a full QuantityAST\n    if (q.type === 'Quantity') {\n        if (q.value && q.value.type === 'single')\n            return q.value.value;\n        return q.value;\n    }\n    // Explicitly ignore RelativeQuantity for minification in this context\n    if (q.type === 'RelativeQuantity')\n        return undefined;\n    return q;\n};\nexports.minifyQuantity = minifyQuantity;\nconst mass_normalization_1 = require(\"./mass_normalization\");\nconst createCleanUsage = (item, id, overrides) => {\n    const obj = { id };\n    const qtyNode = item.quantity;\n    let cleanQty = undefined;\n    if (qtyNode) {\n        // If it's a TextQuantity, we use the value directly\n        if (qtyNode.type === 'TextQuantity') {\n            cleanQty = qtyNode.value;\n        }\n        else {\n            cleanQty = (0, exports.minifyQuantity)(qtyNode.value || qtyNode);\n        }\n    }\n    if (cleanQty !== undefined)\n        obj.qty = cleanQty;\n    if (qtyNode && qtyNode.unit)\n        obj.unit = qtyNode.unit;\n    // Mass Normalization Integration\n    let valForCalc = null;\n    if (typeof obj.qty === 'number')\n        valForCalc = obj.qty;\n    else if (obj.qty && typeof obj.qty === 'object' && typeof obj.qty.value === 'number') {\n        valForCalc = obj.qty.value; // Handles Range (avg) and Fraction\n    }\n    if (valForCalc !== null) {\n        const unitForCalc = obj.unit || 'unit';\n        // Use item.name directly for lookup, do not attach to obj\n        const norm = (0, mass_normalization_1.normalizeMass)(valForCalc, unitForCalc, item.name, overrides);\n        if (norm) {\n            obj.normalizedMass = norm.mass;\n            obj.conversionMethod = norm.method;\n            obj.isEstimate = norm.isEstimate;\n        }\n    }\n    if (item.modifiers && item.modifiers.length > 0) {\n        const MODIFIER_MAP = {\n            '?': 'optional',\n            '-': 'hidden',\n            '&': 'reference',\n            '*': 'bakers_percentage'\n        };\n        obj.modifiers = item.modifiers.map((m) => MODIFIER_MAP[m] || m);\n    }\n    if (item.type === 'Cookware') {\n        if (qtyNode && qtyNode.fixed === false)\n            obj.fixed = false;\n    }\n    else {\n        if (qtyNode && qtyNode.fixed === true)\n            obj.fixed = true;\n    }\n    // Special handling for TextQuantity override\n    if (qtyNode && qtyNode.type === 'TextQuantity') {\n        obj.qty = qtyNode.value;\n        obj.fixed = true;\n    }\n    if (item.alias)\n        obj.alias = item.alias;\n    if (item.preparation)\n        obj.preparation = item.preparation;\n    if (item.composite) {\n        const comp = {};\n        if (item.composite.parent)\n            comp.parent = item.composite.parent;\n        if (item.composite.quantity) {\n            const compQty = item.composite.quantity;\n            const minified = (0, exports.minifyQuantity)(compQty);\n            if (minified !== undefined)\n                comp.quantity = minified;\n            if (compQty.unit)\n                comp.unit = compQty.unit;\n        }\n        obj.composite = comp;\n    }\n    return obj;\n};\nexports.createCleanUsage = createCleanUsage;\nconst cleanObject = (obj) => {\n    if (obj === null || obj === undefined)\n        return undefined;\n    if (Array.isArray(obj)) {\n        const cleanedArr = obj.map(exports.cleanObject).filter(x => x !== undefined && x !== null);\n        return cleanedArr;\n    }\n    if (typeof obj === 'object') {\n        const res = {};\n        for (const key in obj) {\n            const val = obj[key];\n            const cleanedVal = (0, exports.cleanObject)(val);\n            if (cleanedVal !== null && cleanedVal !== undefined) {\n                if (Array.isArray(cleanedVal) && cleanedVal.length === 0)\n                    continue;\n                res[key] = cleanedVal;\n            }\n        }\n        return res;\n    }\n    return obj;\n};\nexports.cleanObject = cleanObject;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.detectCycles = detectCycles;\nfunction detectCycles(sections) {\n    const graph = new Map(); // id -> [dependencies]\n    sections.forEach(sec => {\n        sec.ingredients.forEach(ing => {\n            if (ing.dependencies) {\n                if (!graph.has(ing.id))\n                    graph.set(ing.id, new Set());\n                ing.dependencies.forEach(d => graph.get(ing.id)?.add(d));\n            }\n        });\n    });\n    const visited = new Set();\n    const recursionStack = new Set();\n    const cycles = new Set();\n    function dfs(nodeId) {\n        visited.add(nodeId);\n        recursionStack.add(nodeId);\n        const deps = graph.get(nodeId);\n        if (deps) {\n            for (const dep of deps) {\n                if (!visited.has(dep)) {\n                    dfs(dep);\n                }\n                else if (recursionStack.has(dep)) {\n                    cycles.add(nodeId);\n                    cycles.add(dep);\n                }\n            }\n        }\n        recursionStack.delete(nodeId);\n    }\n    for (const [node] of graph) {\n        if (!visited.has(node))\n            dfs(node);\n    }\n    return cycles;\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.generateShoppingList = generateShoppingList;\nconst utils_1 = require(\"./utils\");\nconst mass_normalization_1 = require(\"./mass_normalization\");\nconst graph_1 = require(\"./graph\");\nfunction formatQuantity(q) {\n    if (!q)\n        return '';\n    if (typeof q === 'number')\n        return q;\n    // Handle objects\n    if (q.type === 'single')\n        return q.value;\n    if (q.type === 'range')\n        return q.text || `${q.value}`;\n    if (q.type === 'fraction')\n        return q.text || `${q.value}`;\n    return JSON.stringify(q);\n}\nfunction generateShoppingList(sections, registry, overrides) {\n    const listMap = new Map();\n    const compositeMap = new Map();\n    const alternatives = [];\n    const circularIds = (0, graph_1.detectCycles)(sections);\n    sections.forEach(sec => {\n        sec.ingredients.forEach(item => {\n            // Handle Alternatives explicitly\n            if (item.type === 'alternative') {\n                alternatives.push(item);\n                return;\n            }\n            // Mark circular on item if detected\n            if (circularIds.has(item.id)) {\n                item.isCircular = true;\n            }\n            if (item.composite) {\n                const parentId = (0, utils_1.slugify)(item.composite.parent);\n                if (!compositeMap.has(parentId)) {\n                    compositeMap.set(parentId, {\n                        type: 'composite',\n                        id: parentId,\n                        qty: 0,\n                        usage: [],\n                        _subUsageMap: new Map(),\n                        _usageAccumulator: new Map()\n                    });\n                }\n                const comp = compositeMap.get(parentId);\n                // Accumulate Parent Quantity Requirement\n                let declParentQty = 0;\n                if (item.composite && item.composite.quantity) {\n                    const minQ = (0, utils_1.minifyQuantity)(item.composite.quantity);\n                    if (typeof minQ === 'number')\n                        declParentQty = minQ;\n                }\n                const subId = item.id;\n                const currentParentTotal = comp._subUsageMap.get(subId) || 0;\n                comp._subUsageMap.set(subId, currentParentTotal + declParentQty);\n                // Accumulate Usage (Child Quantity)\n                const uUnit = item.unit || '';\n                const uKey = `${subId}::${uUnit}`;\n                if (!comp._usageAccumulator.has(uKey)) {\n                    comp._usageAccumulator.set(uKey, {\n                        id: subId,\n                        unit: item.unit,\n                        qty: 0,\n                        alias: item.alias\n                    });\n                }\n                const uEntry = comp._usageAccumulator.get(uKey);\n                let childVal = 0;\n                if (typeof item.qty === 'number') {\n                    childVal = item.qty;\n                }\n                else if (item.qty && typeof item.qty === 'object') {\n                    const m = (0, utils_1.minifyQuantity)(item.qty);\n                    if (typeof m === 'number')\n                        childVal = m;\n                }\n                if (typeof uEntry.qty === 'number') {\n                    uEntry.qty += childVal;\n                }\n                return;\n            }\n            const id = item.id;\n            const key = id;\n            if (!listMap.has(key)) {\n                listMap.set(key, {\n                    id: id,\n                    name: registry.ingredients.get(id)?.name || item.name,\n                    sureMass: 0,\n                    otherUnits: {},\n                    variableParts: [],\n                    _hasSure: false,\n                    normalizedMass: 0,\n                    isEstimate: false,\n                    conversionMethod: 'physical' // default\n                });\n            }\n            const existing = listMap.get(key);\n            // LOGIC: Resolve Quantity to Number if possible\n            let numericQty = null;\n            let unit = item.unit || '';\n            let isGhost = false;\n            // Check if Relative\n            if (item.formula) {\n                if (item.formula.isGhost) {\n                    isGhost = true;\n                }\n                else {\n                    // Calculated relative\n                    if (typeof item.qty === 'number') {\n                        numericQty = item.qty;\n                    }\n                }\n            }\n            else {\n                // Absolute\n                if (typeof item.qty === 'number') {\n                    numericQty = item.qty;\n                }\n                else if (item.qty && typeof item.qty === 'object') {\n                    const qObj = item.qty;\n                    if (qObj.type === 'fraction')\n                        numericQty = qObj.value;\n                    else if (qObj.type === 'range')\n                        numericQty = qObj.value;\n                    else if (qObj.type === 'single')\n                        numericQty = qObj.value;\n                }\n            }\n            if (isGhost) {\n                // GHOST HANDLING\n                let text = item.formula ? item.formula.raw : (item.qty && item.qty.value) || '';\n                if (item.formula) {\n                    text = item.formula.raw;\n                }\n                const display = `${text} \u2753`;\n                existing.variableParts.push(`(${display})`);\n            }\n            else if (numericQty !== null) {\n                // 1. Calculate Mass for Badge (Total Normalized)\n                const norm = (0, mass_normalization_1.normalizeMass)(numericQty, unit, existing.name, overrides);\n                if (norm) {\n                    existing.normalizedMass = (existing.normalizedMass || 0) + norm.mass;\n                    if (norm.isEstimate)\n                        existing.isEstimate = true;\n                }\n                // 2. Aggregation Logic for Display (Physical vs Other)\n                if (norm && norm.method === 'physical') {\n                    existing.sureMass += norm.mass;\n                    existing._hasSure = true;\n                }\n                else {\n                    const u = unit;\n                    if (!existing.otherUnits[u])\n                        existing.otherUnits[u] = 0;\n                    existing.otherUnits[u] += numericQty;\n                }\n            }\n            else {\n                // Unresolved or Just Variable\n                if (item.qty) {\n                    const qStr = formatQuantity(item.qty);\n                    const uStr = unit ? ` ${unit}` : '';\n                    existing.variableParts.push(`${qStr}${uStr}`);\n                }\n            }\n            if (!isGhost && item.isCircular) {\n                existing.variableParts.push(\"\u26A0\uFE0F Ref. Circulaire\");\n            }\n        });\n    });\n    const standardList = [...listMap.values()].map(item => {\n        const res = {\n            id: item.id,\n            name: item.name,\n            normalizedMass: item.normalizedMass,\n            isEstimate: item.isEstimate,\n            conversionMethod: item.isEstimate ? 'estimate' : 'physical'\n        };\n        // Determine main Qty/Unit\n        if (item.sureMass > 0) {\n            res.qty = parseFloat(item.sureMass.toFixed(2));\n            res.unit = 'g';\n        }\n        else {\n            const units = Object.keys(item.otherUnits);\n            if (units.length > 0) {\n                res.qty = parseFloat(item.otherUnits[units[0]].toFixed(2));\n                res.unit = units[0] || null;\n            }\n        }\n        const hasMass = item.sureMass > 0;\n        const hasOther = Object.keys(item.otherUnits).length > 0;\n        const extraEntries = [];\n        if (hasMass) {\n            // Mass is in Qty. Any other units are extra.\n            for (const [u, q] of Object.entries(item.otherUnits)) {\n                const uStr = u ? ` ${u}` : '';\n                extraEntries.push(`${parseFloat(q.toFixed(2))}${uStr}`);\n            }\n        }\n        else if (hasOther) {\n            // First unit is in Qty. Others are extra.\n            const units = Object.keys(item.otherUnits);\n            for (let i = 1; i < units.length; i++) {\n                const u = units[i];\n                const uStr = u ? ` ${u}` : '';\n                extraEntries.push(`${parseFloat(item.otherUnits[u].toFixed(2))}${uStr}`);\n            }\n        }\n        const allVars = [...extraEntries, ...(item.variableParts || [])];\n        if (allVars.length > 0) {\n            res.variable_entries = allVars;\n        }\n        return res;\n    });\n    const compositeList = [...compositeMap.values()].map(c => {\n        let maxQ = 0;\n        for (const q of c._subUsageMap.values()) {\n            if (q > maxQ)\n                maxQ = q;\n        }\n        c.qty = maxQ;\n        // Calculate Mass for Parent Composite\n        // Composite parents are almost always counted units (e.g. 6 eggs)\n        // If an explicit unit exists in composite definition we should use it, but here we infer 'unit' from maxQ usually being unitless count\n        const parentName = registry.ingredients.get(c.id)?.name || c.id;\n        const parentNorm = (0, mass_normalization_1.normalizeMass)(c.qty, 'unit', parentName, overrides);\n        let cRes = {\n            type: 'composite',\n            id: c.id,\n            name: parentName,\n            qty: c.qty,\n            usage: [] // Will populate below\n        };\n        if (parentNorm) {\n            cRes.normalizedMass = parentNorm.mass;\n            cRes.isEstimate = parentNorm.isEstimate;\n            cRes.conversionMethod = parentNorm.method;\n        }\n        // Calculate Mass for Sub-usages\n        cRes.usage = [...c._usageAccumulator.values()].map(u => {\n            const childUsage = { ...u };\n            if (u.qty && typeof u.qty === 'number') {\n                const childId = u.id || '';\n                const childName = registry.ingredients.get(childId)?.name || childId;\n                const childNorm = (0, mass_normalization_1.normalizeMass)(u.qty, u.unit || '', childName, overrides);\n                if (childNorm) {\n                    childUsage.normalizedMass = childNorm.mass;\n                    childUsage.isEstimate = childNorm.isEstimate;\n                    childUsage.conversionMethod = childNorm.method;\n                }\n            }\n            return childUsage;\n        });\n        return cRes;\n    });\n    return [\n        ...standardList,\n        ...compositeList,\n        ...alternatives\n    ];\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.processBlockItem = processBlockItem;\nexports.compile = compile;\nconst units_1 = require(\"./units\");\nconst utils_1 = require(\"./utils\");\nconst shopping_1 = require(\"./shopping\");\nconst mass_normalization_1 = require(\"./mass_normalization\");\n// Helper type helper since we don't have all exact AST names matching from Ohm semantics yet\n// We'll trust the structure matches types.ts\nfunction processBlockItem(item, ctx, registry, secIngredients, secCookware) {\n    if (!item)\n        return null;\n    if (item.type === 'Ingredient') {\n        const id = (0, utils_1.slugify)(item.name);\n        if (!registry.ingredients.has(id)) {\n            let defaultUnit = null;\n            if (item.quantity && item.quantity.unit)\n                defaultUnit = item.quantity.unit;\n            registry.ingredients.set(id, { id, name: item.name, default_unit: defaultUnit });\n        }\n        const entry = registry.ingredients.get(id);\n        if (entry && item.quantity && item.quantity.unit && !entry.default_unit) {\n            entry.default_unit = item.quantity.unit;\n        }\n        if (item.composite) {\n            if (entry)\n                entry.is_composite = true;\n            const parentId = (0, utils_1.slugify)(item.composite.parent);\n            if (entry)\n                entry.parent = parentId;\n            if (!registry.ingredients.has(parentId)) {\n                registry.ingredients.set(parentId, { id: parentId, name: item.composite.parent, is_composite: true });\n            }\n            else {\n                const parent = registry.ingredients.get(parentId);\n                if (parent)\n                    parent.is_composite = true;\n            }\n        }\n        // Handle RelativeQuantity\n        if (item.quantity && item.quantity.type === 'RelativeQuantity') {\n            const rel = item.quantity;\n            const targetName = rel.target;\n            const targetId = (0, utils_1.slugify)(targetName);\n            const percent = rel.percent;\n            let totalQty = 0;\n            let inheritedUnit = null;\n            let isGhost = false;\n            const markerChar = rel.referenceType === 'variable' ? '&' : '@';\n            // Store formula for display.\n            const formulaStr = `${percent}% de ${markerChar}${targetName}`;\n            if (rel.referenceType === 'variable') {\n                if (ctx.variableWeights.has(targetId)) {\n                    const varData = ctx.variableWeights.get(targetId);\n                    if (varData) {\n                        totalQty = varData.mass;\n                        inheritedUnit = 'g';\n                    }\n                }\n                else {\n                    // Ghost Variable\n                    isGhost = true;\n                    ctx.warnings.push({\n                        code: 'VARIABLE_NOT_FOUND',\n                        message: `Variable '&${targetName}' not found or has undefined mass.`,\n                        item: item.name\n                    });\n                }\n            }\n            else {\n                // Ingredient Resolution (Linear Top-Down)\n                const found = secIngredients.some(i => i.id === targetId);\n                if (!found) {\n                    isGhost = true;\n                    ctx.warnings.push({\n                        code: 'RELATIVE_QUANTITY_UNRESOLVED',\n                        message: `Could not resolve relative quantity for '@${targetName}'. Source not found.`,\n                        item: item.name\n                    });\n                }\n                else {\n                    // Calculate sum\n                    for (const prev of secIngredients) {\n                        if (prev.id === targetId) {\n                            // Use normalizedMass logic which includes density handling\n                            if (prev.normalizedMass) {\n                                totalQty += prev.normalizedMass;\n                                if (!inheritedUnit)\n                                    inheritedUnit = 'g';\n                            }\n                            else if (prev.qty && typeof prev.qty === 'number' && prev.unit) {\n                                // Fallback: try raw normalization if missing on object\n                                const norm = (0, mass_normalization_1.normalizeMass)(prev.qty, prev.unit, prev.name, ctx.densityOverrides);\n                                if (norm) {\n                                    totalQty += norm.mass;\n                                    if (!inheritedUnit)\n                                        inheritedUnit = 'g';\n                                }\n                            }\n                        }\n                    }\n                    if (!inheritedUnit) {\n                        // Found source but no valid mass (e.g. unitless count)\n                        isGhost = true;\n                        ctx.warnings.push({\n                            code: 'RELATIVE_NO_MASS',\n                            message: `Source '@${targetName}' has no mass (unitless or incompatible). Calculation impossible.`,\n                            item: item.name\n                        });\n                    }\n                }\n            }\n            const newVal = totalQty * (percent / 100);\n            const usage = (0, utils_1.createCleanUsage)(item, id, ctx.densityOverrides);\n            usage.qty = parseFloat(newVal.toFixed(2));\n            usage.unit = inheritedUnit || 'g';\n            if (usage.unit) {\n                const norm = (0, mass_normalization_1.normalizeMass)(usage.qty, usage.unit, usage.name || item.name, ctx.densityOverrides);\n                if (norm) {\n                    usage.normalizedMass = norm.mass;\n                    usage.conversionMethod = norm.method;\n                    usage.isEstimate = norm.isEstimate;\n                }\n            }\n            // Check Circular (Direct self-reference)\n            if (targetId === id) {\n                usage.isCircular = true;\n                ctx.warnings.push({\n                    code: 'CIRCULAR_REFERENCE',\n                    message: `Circular reference detected: ${item.name} depends on itself.`,\n                    item: item.name\n                });\n            }\n            // Attach dependency info for graph cycle detection\n            usage.dependencies = [targetId];\n            usage.formula = {\n                raw: formulaStr,\n                target: targetName,\n                percent: percent,\n                isGhost: isGhost\n            };\n            secIngredients.push(usage);\n            return usage;\n        }\n        const usage = (0, utils_1.createCleanUsage)(item, id, ctx.densityOverrides);\n        if (item.modifiers && item.modifiers.includes('&')) {\n            if (!ctx.seenNames.has(item.name)) {\n                ctx.warnings.push({ code: 'UNDEFINED_REFERENCE', message: `Reference to undefined ingredient '@&${item.name}'.`, item: item.name });\n            }\n            if (ctx.definedIntermediates.has(item.name))\n                ctx.usedIntermediates.add(item.name);\n        }\n        else {\n            ctx.seenNames.add(item.name);\n        }\n        if (!item.modifiers || !item.modifiers.includes('&') || item.quantity) {\n            secIngredients.push(usage);\n        }\n        return usage;\n    }\n    if (item.type === 'Cookware') {\n        const id = (0, utils_1.slugify)(item.name);\n        if (!registry.cookware.has(id)) {\n            registry.cookware.set(id, { id, name: item.name });\n        }\n        const usage = (0, utils_1.createCleanUsage)(item, id, ctx.densityOverrides);\n        secCookware.push(usage);\n        return usage;\n    }\n    if (item.type === 'Alternative') {\n        const processedOptions = [];\n        // Sequential processing to allow internal references (e.g. A | B{50% A})\n        let tempIngredientsScope = [...secIngredients];\n        let tempCookwareScope = [...secCookware];\n        item.options.forEach((opt) => {\n            const captureIngredients = [...tempIngredientsScope];\n            const captureCookware = [...tempCookwareScope];\n            const result = processBlockItem(opt, ctx, registry, captureIngredients, captureCookware);\n            processedOptions.push(result);\n            if (result && typeof result !== 'string') {\n                const r = result;\n                if (r.type === 'ingredient' || r.type === 'drink' || (r.id && !r.type)) {\n                    tempIngredientsScope.push(r);\n                }\n                if (r.type === 'cookware') {\n                    tempCookwareScope.push(r);\n                }\n            }\n        });\n        const usage = { id: 'alternative', type: 'alternative', options: processedOptions };\n        if (item.options.length > 0) {\n            if (item.options[0].type === 'Ingredient') {\n                secIngredients.push(usage);\n            }\n            else if (item.options[0].type === 'Cookware') {\n                secCookware.push(usage);\n            }\n        }\n        return usage;\n    }\n    if (item.type === 'Reference') {\n        const id = (0, utils_1.slugify)(item.name);\n        if (!registry.ingredients.has(id)) {\n            ctx.warnings.push({ code: 'UNDEFINED_REFERENCE', message: `Reference to undefined ingredient '&${item.name}'.`, item: item.name });\n        }\n        if (ctx.definedIntermediates.has(item.name))\n            ctx.usedIntermediates.add(item.name);\n        const obj = { type: 'reference', id, name: item.name };\n        if (item.quantity) {\n            const cleanQty = (0, utils_1.minifyQuantity)(item.quantity);\n            if (cleanQty !== undefined)\n                obj.qty = cleanQty;\n            if (item.quantity.unit)\n                obj.unit = item.quantity.unit;\n            if (item.quantity.type === 'TextQuantity')\n                obj.qty = item.quantity.value;\n            // Normalize explicit quantity\n            if (obj.qty && typeof obj.qty === 'number') {\n                const norm = (0, mass_normalization_1.normalizeMass)(obj.qty, obj.unit || '', item.name, ctx.densityOverrides);\n                if (norm) {\n                    obj.normalizedMass = norm.mass;\n                    obj.conversionMethod = norm.method;\n                    obj.isEstimate = norm.isEstimate;\n                }\n            }\n        }\n        else {\n            // No quantity -> Inherit mass from intermediate\n            if (ctx.variableWeights.has(id)) {\n                const w = ctx.variableWeights.get(id);\n                if (w) {\n                    obj.normalizedMass = w.mass;\n                    obj.isEstimate = w.isPartial;\n                    obj.conversionMethod = 'physical'; // Inherited\n                }\n            }\n        }\n        return obj;\n    }\n    if (item.type === 'IntermediateDecl') {\n        const id = (0, utils_1.slugify)(item.name);\n        ctx.intermediateDecl = id;\n        if (!registry.ingredients.has(id)) {\n            registry.ingredients.set(id, { id, name: item.name, is_intermediate: true });\n        }\n        else {\n            const entry = registry.ingredients.get(id);\n            if (entry)\n                entry.is_intermediate = true;\n        }\n        return null;\n    }\n    if (item.type === 'Text')\n        return item.value;\n    // Timer/Temperature logic (keep same)\n    if (item.type === 'Timer' || item.type === 'Temperature') {\n        const obj = { type: item.type.toLowerCase() };\n        if (item.name)\n            obj.name = item.name;\n        if (item.type === 'Timer' && item.isAsync)\n            obj.isAsync = true;\n        if (item.quantity) {\n            const q = item.quantity;\n            if (q.value)\n                obj.quantity = q.value;\n            let unit = q.unit;\n            if (item.type === 'Timer' && (unit === 'm' || unit === 'minutes'))\n                unit = 'min';\n            if (unit)\n                obj.unit = unit;\n            if (q.type === 'TextQuantity') {\n                ctx.warnings.push({ code: 'INVALID_UNIT', message: `Invalid text content in ${item.type}.`, item: q.value });\n                obj.quantity = { type: 'text', value: q.value };\n            }\n            else {\n                if (!unit) {\n                    ctx.warnings.push({ code: 'MISSING_UNIT', message: `${item.type} must have an explicit unit.`, item: item.name || item.type });\n                }\n            }\n        }\n        return obj;\n    }\n    if (item.type === 'Comment') {\n        return { type: 'comment', value: item.value, kind: item.kind };\n    }\n    return item;\n}\nfunction calculateMassMetrics(ingredients) {\n    let totalMass = 0;\n    let missing = [];\n    let isEstimated = false;\n    ingredients.forEach(i => {\n        let target = i;\n        if ((i.type === 'alternative' || i.type === 'group') && i.options && i.options.length > 0) {\n            target = i.options[0];\n        }\n        if (target.normalizedMass) {\n            totalMass += target.normalizedMass;\n            if (target.isEstimate)\n                isEstimated = true;\n        }\n        else {\n            const type = target.type || 'ingredient';\n            const validTypes = ['ingredient', 'reference', 'alternative', 'group'];\n            if (validTypes.includes(type) || !target.type) {\n                missing.push(target.name || target.id);\n            }\n        }\n    });\n    let status = 'precise';\n    if (missing.length > 0)\n        status = 'incomplete';\n    else if (isEstimated)\n        status = 'estimated';\n    return {\n        totalMass: parseFloat(totalMass.toFixed(2)),\n        massStatus: status,\n        missingMassIngredients: missing\n    };\n}\nfunction processSections(astChildren, registry, overrides) {\n    const ctx = {\n        warnings: registry.warnings,\n        intermediateDecl: null,\n        seenNames: new Set(),\n        definedIntermediates: new Set(),\n        usedIntermediates: new Set(),\n        variableWeights: new Map(),\n        globalScopes: new Map(),\n        densityOverrides: overrides || {}\n    };\n    const sections = [];\n    let blocksToProcess = astChildren;\n    if (blocksToProcess.length > 0 && blocksToProcess[0].type !== 'Section') {\n        blocksToProcess = [{ type: 'Section', title: null, children: astChildren }];\n    }\n    let cookCursor = 0;\n    let globalActiveTime = 0;\n    const activeBackgroundTasks = [];\n    blocksToProcess.forEach(section => {\n        if (section.type !== 'Section')\n            return;\n        if (section.intermediateDecl) {\n            const varName = section.intermediateDecl.name;\n            if (ctx.globalScopes.has(varName)) {\n                registry.warnings.push({\n                    code: 'SCOPE_CONFLICT',\n                    message: `La variable globale '&${varName}' est red\u00E9finie.`,\n                    section: section.title\n                });\n            }\n            else {\n                ctx.globalScopes.set(varName, section.title);\n            }\n            const id = (0, utils_1.slugify)(varName);\n            if (!registry.ingredients.has(id)) {\n                registry.ingredients.set(id, { id, name: varName, is_intermediate: true });\n            }\n            ctx.definedIntermediates.add(varName);\n        }\n        const sectionIngredients = [];\n        const sectionCookware = [];\n        const steps = [];\n        section.children.forEach((block) => {\n            if (block.type === 'Step') {\n                let localActiveTime = 0;\n                const stepAsyncTasks = [];\n                const stepContentObjects = [];\n                let stepText = '';\n                ctx.intermediateDecl = null;\n                block.children.forEach((item) => {\n                    const processed = processBlockItem(item, ctx, registry, sectionIngredients, sectionCookware);\n                    if (processed) {\n                        stepContentObjects.push(processed);\n                        if (typeof processed === 'string') {\n                            stepText += processed;\n                        }\n                        else {\n                            const p = processed;\n                            if (p.type === 'timer' && p.quantity) {\n                                const qtyVal = p.quantity.value || p.quantity;\n                                const unit = p.unit || '';\n                                const name = p.name ? `~${p.name}` : '~';\n                                stepText += `${name}{${qtyVal}${unit}}`;\n                                if (p.isAsync)\n                                    stepText += '&';\n                                const duration = (0, units_1.quantityToMinutes)({ value: p.quantity, unit: p.unit });\n                                if (p.isAsync) {\n                                    stepAsyncTasks.push({\n                                        name: p.name || 'Timer',\n                                        duration: duration,\n                                        startOffset: localActiveTime\n                                    });\n                                    activeBackgroundTasks.push({ end: cookCursor + localActiveTime + duration });\n                                }\n                                else {\n                                    localActiveTime += duration;\n                                }\n                            }\n                            else if (p.type === 'ingredient') {\n                                stepText += `@${p.name}`;\n                            }\n                            else if (p.type === 'cookware') {\n                                stepText += `#${p.name}`;\n                            }\n                            else if (p.type === 'temperature') {\n                                const qtyVal = p.quantity.value || p.quantity;\n                                stepText += `!${p.name || ''}{${qtyVal}${p.unit || ''}}`;\n                            }\n                            else if (p.type === 'reference') {\n                                stepText += `&${p.name}`;\n                            }\n                        }\n                    }\n                });\n                if (localActiveTime === 0 && stepAsyncTasks.length === 0) {\n                    localActiveTime = 2;\n                }\n                const startTime = cookCursor;\n                const endTime = cookCursor + localActiveTime;\n                const stepObj = {\n                    type: 'step',\n                    value: stepText.trim(),\n                    content: stepContentObjects,\n                    timings: {\n                        start: startTime,\n                        end: endTime,\n                        activeDuration: localActiveTime\n                    },\n                    backgroundTasks: stepAsyncTasks\n                };\n                if (block.action) {\n                    stepObj.action = block.action;\n                }\n                cookCursor += localActiveTime;\n                globalActiveTime += localActiveTime;\n                let stepMass = 0;\n                let stepValid = true;\n                stepContentObjects.forEach(p => {\n                    if (typeof p !== 'string') {\n                        // Prioritize normalized mass\n                        if (p.normalizedMass) {\n                            stepMass += p.normalizedMass;\n                        }\n                        else if (p.qty && typeof p.qty === 'number' && p.unit) {\n                            // Last resort fallback\n                            const norm = (0, mass_normalization_1.normalizeMass)(p.qty, p.unit, p.name, ctx.densityOverrides);\n                            if (norm)\n                                stepMass += norm.mass;\n                        }\n                        // Check validity for partial status\n                        if (p.type === 'ingredient' && !p.normalizedMass)\n                            stepValid = false;\n                    }\n                });\n                if (ctx.intermediateDecl) {\n                    const varId = ctx.intermediateDecl;\n                    ctx.variableWeights.set(varId, { mass: stepMass, isPartial: !stepValid });\n                    stepObj.intermediate_preparation = ctx.intermediateDecl;\n                }\n                steps.push(stepObj);\n            }\n            else if (block.type === 'Comment') {\n                steps.push({ type: 'comment', value: block.value, kind: block.kind });\n            }\n        });\n        const res = {\n            title: section.title,\n            ingredients: sectionIngredients,\n            cookware: sectionCookware,\n            steps\n        };\n        if (section.intermediateDecl) {\n            res.intermediate_preparation = section.intermediateDecl.name;\n            let secMass = 0;\n            let partial = false;\n            res.ingredients.forEach(ing => {\n                if (ing.normalizedMass) {\n                    secMass += ing.normalizedMass;\n                }\n                else {\n                    partial = true; // Conservative\n                }\n            });\n            const varId = (0, utils_1.slugify)(section.intermediateDecl.name);\n            ctx.variableWeights.set(varId, { mass: secMass, isPartial: partial });\n        }\n        if (section.retroPlanning) {\n            res.retro_planning = section.retroPlanning;\n        }\n        sections.push(res);\n    });\n    let maxBackgroundTaskEnd = 0;\n    activeBackgroundTasks.forEach(t => {\n        if (t.end > maxBackgroundTaskEnd)\n            maxBackgroundTaskEnd = t.end;\n    });\n    const totalTime = Math.max(cookCursor, maxBackgroundTaskEnd);\n    return {\n        sections,\n        metrics: {\n            totalTime,\n            activeTime: globalActiveTime\n        }\n    };\n}\nfunction compile(ast) {\n    if (ast.type !== 'Recipe')\n        throw new Error(\"Compiler expects Recipe AST\");\n    const registry = {\n        ingredients: new Map(),\n        cookware: new Map(),\n        warnings: []\n    };\n    const densityOverrides = {};\n    if (ast.meta && ast.meta.densities) {\n        const d = ast.meta.densities;\n        const list = Array.isArray(d) ? d : [d];\n        list.forEach((entry) => {\n            const parts = entry.split(':');\n            if (parts.length === 2) {\n                const name = (0, utils_1.slugify)(parts[0]);\n                const density = parseFloat(parts[1].trim());\n                if (!isNaN(density)) {\n                    densityOverrides[name] = density;\n                }\n            }\n        });\n    }\n    const resultPayload = processSections(ast.children, registry, densityOverrides);\n    const sections = resultPayload.sections;\n    sections.forEach(sec => {\n        sec.metrics = calculateMassMetrics(sec.ingredients);\n    });\n    const allRawIngredients = [];\n    sections.forEach(sec => {\n        sec.ingredients.forEach(i => {\n            if (i.type !== 'reference') {\n                allRawIngredients.push(i);\n            }\n        });\n    });\n    const globalMassMetrics = calculateMassMetrics(allRawIngredients);\n    const shopping_list = (0, shopping_1.generateShoppingList)(sections, registry, densityOverrides);\n    const globalCookware = [];\n    sections.forEach(sec => {\n        sec.cookware.forEach(cw => {\n            if (!cw.modifiers || !cw.modifiers.includes('reference')) {\n                globalCookware.push(cw);\n            }\n        });\n    });\n    const result = {\n        title: ast.meta.title || null,\n        slug: ast.meta.title ? (0, utils_1.slugify)(ast.meta.title) : null,\n        meta: ast.meta,\n        registry: {\n            ingredients: Object.fromEntries(registry.ingredients),\n            cookware: Object.fromEntries(registry.cookware)\n        },\n        shopping_list,\n        cookware: globalCookware,\n        sections,\n        warnings: registry.warnings,\n        metrics: {\n            ...resultPayload.metrics,\n            ...globalMassMetrics,\n            preparationTime: (() => {\n                let t = 0;\n                t += registry.ingredients.size * 1;\n                t += registry.cookware.size * 1;\n                const countPrep = (item) => {\n                    let localTime = 0;\n                    if (!item)\n                        return 0;\n                    if (item.type === 'ingredient' && item.preparation) {\n                        localTime += 2;\n                    }\n                    if (item.options && Array.isArray(item.options)) {\n                        let maxOpt = 0;\n                        item.options.forEach((opt) => {\n                            const optTime = countPrep(opt);\n                            if (optTime > maxOpt)\n                                maxOpt = optTime;\n                        });\n                        localTime += maxOpt;\n                    }\n                    else if (!item.type && item.id && item.preparation) {\n                        localTime += 2;\n                    }\n                    return localTime;\n                };\n                sections.forEach(sec => {\n                    sec.steps.forEach(s => {\n                        if (s.content)\n                            s.content.forEach((c) => {\n                                t += countPrep(c);\n                            });\n                    });\n                });\n                return t;\n            })()\n        }\n    };\n    return (0, utils_1.cleanObject)(result);\n}\n", "import { getAST } from 'gram-parser';\nimport { compile } from 'gram-compiler';\n\nconst input = document.getElementById('input');\nconst output = document.getElementById('output');\n\nconst status = document.getElementById('status');\nconst themeToggle = document.getElementById('theme-toggle');\n// Output Mode Logic\nconst warningsArea = document.getElementById('warnings');\nconst viewSelect = document.getElementById('view-mode');\n\nviewSelect.addEventListener('change', () => {\n    outputMode = viewSelect.value;\n    update();\n});\n\n// Theme Logic\nthemeToggle.addEventListener('click', () => {\n    document.body.classList.toggle('light');\n    const isLight = document.body.classList.contains('light');\n    localStorage.setItem('theme', isLight ? 'light' : 'dark');\n    updateThemeIcon(isLight);\n});\n\nfunction updateThemeIcon(isLight) {\n    // Simple text or svg swap\n    themeToggle.innerHTML = isLight \n        ? `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"#000000\" viewBox=\"0 0 256 256\"><path d=\"M236.37,139.4a12,12,0,0,0-12-3A84.07,84.07,0,0,1,119.6,31.59a12,12,0,0,0-15-15A108.86,108.86,0,0,0,49.69,55.07,108,108,0,0,0,136,228a107.09,107.09,0,0,0,64.93-21.69,108.86,108.86,0,0,0,38.44-54.94A12,12,0,0,0,236.37,139.4Zm-49.88,47.74A84,84,0,0,1,68.86,69.51,84.93,84.93,0,0,1,92.27,48.29Q92,52.13,92,56A108.12,108.12,0,0,0,200,164q3.87,0,7.71-.27A84.79,84.79,0,0,1,186.49,187.14Z\"></path></svg>` // Moon for \"Go Dark\"\n        : `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" fill=\"#ffffff\" viewBox=\"0 0 256 256\"><path d=\"M116,36V20a12,12,0,0,1,24,0V36a12,12,0,0,1-24,0Zm80,92a68,68,0,1,1-68-68A68.07,68.07,0,0,1,196,128Zm-24,0a44,44,0,1,0-44,44A44.05,44.05,0,0,0,172,128ZM51.51,68.49a12,12,0,1,0,17-17l-12-12a12,12,0,0,0-17,17Zm0,119-12,12a12,12,0,0,0,17,17l12-12a12,12,0,1,0-17-17ZM196,72a12,12,0,0,0,8.49-3.51l12-12a12,12,0,0,0-17-17l-12,12A12,12,0,0,0,196,72Zm8.49,115.51a12,12,0,0,0-17,17l12,12a12,12,0,0,0,17-17ZM48,128a12,12,0,0,0-12-12H20a12,12,0,0,0,0,24H36A12,12,0,0,0,48,128Zm80,80a12,12,0,0,0-12,12v16a12,12,0,0,0,24,0V220A12,12,0,0,0,128,208Zm108-92H220a12,12,0,0,0,0,24h16a12,12,0,0,0,0-24Z\"></path></svg>`; // Sun for \"Go Light\"\n}\n\n// Init Theme\nconst savedTheme = localStorage.getItem('theme');\nif (savedTheme === 'light') {\n    document.body.classList.add('light');\n    updateThemeIcon(true);\n} else {\n    updateThemeIcon(false);\n}\n\n// Debounce function\nfunction debounce(func, wait) {\n    let timeout;\n    return function executedFunction(...args) {\n        const later = () => {\n            clearTimeout(timeout);\n            func(...args);\n        };\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n    };\n}\n\n// Output Mode Logic\nlet outputMode = 'json'; // 'json' | 'markdown' | 'html'\n\n// Helper for minified properties\nfunction getQty(item) {\n    if (item.qty !== undefined) {\n        if (typeof item.qty === 'number') return { value: item.qty, text: String(item.qty) };\n        return item.qty;\n    }\n    return item.quantity;\n}\n\n// Helper for Timer/Temperature range display\nfunction formatQuantityValue(q) {\n    if (!q) return '';\n    // Check if it's a semantic quantity object from the parser\n    // { type: 'range', value: avg, range: { min, max }, text: \"160-180\" }\n    if (q.type === 'range' && q.text) return q.text;\n    \n    // { type: 'fraction', value: 0.5, text: \"1/2\" }\n    if (q.text) return q.text;\n    \n    // { value: 123 }\n    if (q.value !== undefined) return q.value;\n    \n    // Simple number\n    return q;\n}\n\n// Helper for duration formatting\nfunction formatDuration(minutes) {\n    if (!minutes) return '0m';\n    const h = Math.floor(minutes / 60);\n    const m = minutes % 60;\n    if (h > 0) return `${h}h ${m > 0 ? m + 'm' : ''}`;\n    return `${m}m`;\n}\n\nfunction renderMarkdown(data) {\n    const registry = data.registry || { ingredients: {}, cookware: {} };\n    let md = '';\n    \n    // Title\n    if (data.title) md += `# ${data.title}\\n\\n`;\n    \n    // Meta & Metrics\n    if ((data.meta && Object.keys(data.meta).length > 0) || data.metrics) {\n        md += `> **Metadata**\\n`;\n        if (data.metrics) {\n            md += `> - **Total Time**: ${formatDuration(data.metrics.totalTime)}\\n`;\n            md += `> - **Active Time**: ${formatDuration(data.metrics.activeTime)}\\n`;\n            if (data.metrics.preparationTime) {\n                md += `> - **Mise en place**: ${formatDuration(data.metrics.preparationTime)} (est.)\\n`;\n            }\n        }\n        if (data.meta) {\n            for (const [k, v] of Object.entries(data.meta)) {\n                if (k !== 'title') md += `> - ${k}: ${v}\\n`;\n            }\n        }\n        md += '\\n';\n    }\n    \n    // Shopping List\n    if (data.shopping_list && data.shopping_list.length > 0) {\n        md += `## \uD83D\uDED2 Shopping List\\n\\n`;\n        data.shopping_list.forEach(item => {\n            if (item.type === 'alternative' || item.type === 'group') {\n                md += `- **Alternative Group**:\\n`;\n                item.options.forEach(opt => {\n                    md += `  - ${formatIngredient(opt, registry)}\\n`;\n                });\n            } else if (item.type === 'composite') {\n                 // Composite handling for MD\n                 // Parent Quantity Display\n                 let parentStr = formatIngredient(item, registry);\n                 // If formatIngredient didn't add the quantity because it's usually for usage,\n                 // we must handle it here. \n                 // However, formatIngredient uses getQty(item) which looks at item.qty.\n                 // Composite item has 'qty' property (from maxQty).\n                 // So formatIngredient SHOULD display it if present.\n                 md += `- **${parentStr}** (Composite):\\n`;\n                 item.usage.forEach(child => {\n                     md += `  - ${formatIngredient(child, registry)}\\n`;\n                 });\n            } else if (item.display) {\n                  // New Shopping List Format\n                  md += `- ${item.display}\\n`;\n            } else {\n                md += `- ${formatIngredient(item, registry)}\\n`;\n            }\n        });\n        md += '\\n';\n    }\n    \n    // Cookware\n    if (data.cookware && data.cookware.length > 0) {\n        md += `## \uD83C\uDF73 Cookware\\n\\n`;\n        data.cookware.forEach(cw => {\n             if (cw.type === 'alternative' || cw.type === 'group') {\n                 md += `- **Alternative Group**:\\n`;\n                 cw.options.forEach(opt => {\n                     md += `  - ${formatCookware(opt, registry)}\\n`;\n                 });\n             } else {\n                 md += `- ${formatCookware(cw, registry)}\\n`;\n             }\n        });\n        md += '\\n';\n    }\n    \n    // Instructions\n    if (data.sections && data.sections.length > 0) {\n        md += `## \uD83D\uDC68\u200D\uD83C\uDF73 Instructions\\n\\n`;\n        data.sections.forEach(sec => {\n            if (sec.title) {\n                md += `### ${sec.title}`;\n                if (sec.retro_planning) md += ` {T-${sec.retro_planning}}`;\n                md += `\\n\\n`;\n            }\n            \n            // Section Ingredients\n            if (sec.ingredients && sec.ingredients.length > 0) {\n                md += `**Ingredients**:\\n`;\n                sec.ingredients.forEach(item => {\n                    if (item.type === 'alternative' || item.type === 'group') {\n                        md += `- **Alternative Group**:\\n`;\n                        item.options.forEach(opt => {\n                            md += `  - ${formatIngredient(opt, registry)}\\n`;\n                        });\n                    } else {\n                        md += `- ${formatIngredient(item, registry)}\\n`;\n                    }\n                });\n                md += '\\n';\n            }\n            \n            sec.steps.forEach((step, idx) => {\n                if (step.type === 'comment') {\n                     md += `> *${step.value ? step.value.trim() : ''}*\\n\\n`;\n                     return;\n                }\n\n                const stepNum = idx + 1;\n                let stepText = '';\n                \n                // Prepend Action if exists\n                if (step.action) {\n                     stepText += `**[${step.action}]** `;\n                }\n\n                if (step.type === 'text') {\n                    stepText += step.value;\n                } else if (step.type === 'step') {\n                     stepText += step.content.map((c, i, arr) => {\n                         let str = '';\n                         if (typeof c === 'string') {\n                             str = c;\n                         } else if (c.type === 'text') {\n                             str = c.value;\n                         } else if (c.type === 'timer') {\n                             const qStr = `${formatQuantityValue(c.quantity)}${c.unit ? ' ' + c.unit : ''}`;\n                             if (c.isAsync) {\n                                 str = `\u23F3 ${qStr} (async)`;\n                             } else {\n                                 str = `\u23F2\uFE0F ${qStr}`;\n                             }\n                         } else if (c.type === 'temperature') {\n                             str = `\uD83D\uDD25${formatQuantityValue(c.quantity)}${c.unit ? ' ' + c.unit : ''}`;\n                         } else if (c.type === 'reference') {\n                             const name = registry.ingredients[c.id]?.name || c.id;\n                             str = `\uD83D\uDC49*${name}*`;\n                             const qty = getQty(c);\n                             if (qty) {\n                                 str += ` (${qty.text || qty.value}`;\n                                 if (c.unit) str += ` ${c.unit}`;\n                                 str += ')';\n                             }\n                         } else if (!c.type && c.id) {\n                              if (registry.cookware[c.id]) str = `*${formatCookware(c, registry)}*`;\n                              else str = `**${formatIngredient(c, registry)}**`;\n                         } else if (c.type === 'ingredient') {\n                             str = `**${formatIngredient(c, registry)}**`;\n                         } else if (c.type === 'cookware') {\n                             str = `*${formatCookware(c, registry)}*`;\n                         } else if (c.type === 'alternative') {\n                             str = c.options.map(opt => {\n                                 const isCookware = opt.type === 'cookware' || registry.cookware[opt.id];\n                                 if (isCookware) return `*${formatCookware(opt, registry)}*`;\n                                 return `**${formatIngredient(opt, registry)}**`;\n                             }).join(' or ');\n                         } else if (c.type === 'group') {\n                              str = c.options.map(opt => {\n                                 const isCookware = opt.type === 'cookware' || registry.cookware[opt.id];\n                                 if (isCookware) return `*${formatCookware(opt, registry)}*`;\n                                 return `**${formatIngredient(opt, registry)}**`;\n                             }).join(' or ');\n                         } else if (c.type === 'comment') {\n                             str = ` *${c.value.trim()}*`;\n                         }\n\n                         // Spacing Logic\n                         const isObject = (typeof c !== 'string' && c.type !== 'text' && c.type !== 'comment');\n                         if (isObject) {\n                             const next = arr[i+1];\n                             if (next) {\n                                let nextChar = '';\n                                if (typeof next === 'string') nextChar = next[0];\n                                else if (next.type === 'text') nextChar = next.value ? next.value[0] : '';\n                                \n                                // Don't add space if next is glue (punctuation or space)\n                                const isGlue = nextChar && /^[.,!?:;)]/.test(nextChar) || (nextChar && /^\\s/.test(nextChar));\n                                if (!isGlue) {\n                                    str += ' ';\n                                }\n                             }\n                         }\n                         return str;\n                     }).join('');\n                }\n                md += `${stepNum}. ${stepText}\\n`;\n            });\n            md += '\\n';\n        });\n    }\n    \n    return md;\n}\n\nfunction formatIngredient(item, registry) {\n    // Resolve name from registry\n    const def = registry.ingredients[item.id];\n    let str = def ? def.name : item.id;\n    \n    // Alias overrides name if present in usage\n    if (item.alias) str = item.alias;\n    \n    // Shopping List Specific Display\n    // If we have variableentries, we might want to display them cleanly.\n    // The Input item here might be from shopping list OR from instructions.\n    // Shopping list items have 'qty', 'unit', and potentially 'variable_entries'.\n    \n    const qty = getQty(item);\n    \n    // Formula handling\n    const formulaStr = item.formula ? `${item.formula.percent}% of ${item.formula.target}` : null;\n    const isPartial = item.formula && item.formula.is_partial;\n\n    if (isPartial) {\n        // Replace quantity with formula\n        str += ` (${formulaStr} \u26A0\uFE0F)`;\n    } else {\n        let qtyParts = [];\n        \n        if (qty) {\n            let qStr = qty.text || qty.value;\n            if (item.unit) qStr += ` ${item.unit}`;\n            qtyParts.push(qStr);\n        }\n        \n        if (item.variable_entries && item.variable_entries.length > 0) {\n             qtyParts.push(...item.variable_entries);\n        }\n        \n        if (qtyParts.length > 0) {\n             str += ` (${qtyParts.join(' + ')})`;\n        }\n        \n        if (formulaStr) str += ` [${formulaStr}]`;\n    }\n\n    if (item.preparation) str += ` (${item.preparation})`;\n    if (item.modifiers && item.modifiers.includes('optional')) str += ' (optional)';\n    \n    return str;\n}\n\nfunction formatCookware(item, registry) {\n    const def = registry.cookware[item.id];\n    let str = def ? def.name : item.id;\n    \n    if (item.alias) str = item.alias;\n    \n    const qty = getQty(item);\n    if (qty) {\n        str += ` (${qty.value})`;\n    }\n    return str;\n}\n\n\nfunction update() {\n    const text = input.value;\n    try {\n        const ast = getAST(text);\n        const result = compile(ast);\n        \n        // Prepare content\n        let content = '';\n        if (outputMode === 'json') {\n             content = JSON.stringify(result, null, 2);\n             // JSON view already shows them at the bottom.\n             if (result.warnings && result.warnings.length > 0) {\n                 showWarnings(result.warnings);\n             } else {\n                 hideWarnings();\n             }\n        } else if (outputMode === 'ast') {\n             content = renderSExpr(ast);\n             hideWarnings();\n        } else if (outputMode === 'markdown') {\n             content = renderMarkdown(result);\n             if (result.warnings && result.warnings.length > 0) {\n                 showWarnings(result.warnings);\n             } else {\n                 hideWarnings();\n             }\n        } else if (outputMode === 'json-tree') {\n             content = renderJsonTree(result);\n             if (result.warnings && result.warnings.length > 0) {\n                 showWarnings(result.warnings);\n             } else {\n                 hideWarnings();\n             }\n        } else if (outputMode === 'preview') {\n             content = renderHTML(result);\n             if (result.warnings && result.warnings.length > 0) {\n                 showWarnings(result.warnings);\n             } else {\n                 hideWarnings();\n             }\n        }\n\n        const previewOutput = document.getElementById('preview-output');\n        const preOutput = document.getElementById('output').parentElement; // pre is parent of code#output\n        \n        // Render\n        if (outputMode === 'preview' || outputMode === 'json-tree') {\n            // Hide Code View\n            preOutput.style.display = 'none';\n            \n            // Show Preview (reused for tree as it's HTML content)\n            previewOutput.style.display = 'block';\n            previewOutput.innerHTML = content;\n            \n            if (outputMode === 'json-tree') {\n                // Add listeners for Expand/Collapse All\n                const btnExpand = previewOutput.querySelector('#btn-expand-all');\n                const btnCollapse = previewOutput.querySelector('#btn-collapse-all');\n                \n                if (btnExpand && btnCollapse) {\n                    btnExpand.addEventListener('click', () => {\n                         const nodes = previewOutput.querySelectorAll('.json-node');\n                         nodes.forEach(n => {\n                             n.classList.remove('collapsed');\n                             const t = n.querySelector('.json-toggle');\n                             if (t) t.textContent = '\u25BC';\n                         });\n                    });\n                    \n                    btnCollapse.addEventListener('click', () => {\n                         const nodes = previewOutput.querySelectorAll('.json-node');\n                         nodes.forEach((n, index) => {\n                             if (index === 0) return; // Keep root expanded\n                             n.classList.add('collapsed');\n                             const t = n.querySelector('.json-toggle');\n                             if (t) t.textContent = '\u25B6';\n                         });\n                    });\n                }\n                \n                const headers = previewOutput.querySelectorAll('.json-header');\n                headers.forEach(h => {\n                    h.addEventListener('click', (e) => {\n                        e.stopPropagation();\n                        // The parent is the .json-node\n                        const node = h.parentElement;\n                        node.classList.toggle('collapsed');\n                        \n                        // Toggle arrow text\n                        const toggle = h.querySelector('.json-toggle');\n                        if (toggle) {\n                             if (node.classList.contains('collapsed')) {\n                                toggle.textContent = '\u25B6';\n                            } else {\n                                toggle.textContent = '\u25BC';\n                            }\n                        }\n                     });\n                });\n            }\n        } else {\n            // Show Code View\n            preOutput.style.display = 'block'; // Or flex/initial? pre has flex:1\n            // pre styles: flex: 1. So display:flex or block? Pre is block by default but we set flex:1. \n            // Wait, pre is a flex item in .code-viewer?\n            // \"pre { flex: 1; ... }\"\n            // If we hide it, it's gone. If we show it, 'block' works for pre, but flex:1 applies if parent is flex.\n            preOutput.style.removeProperty('display'); // Revert to css default\n            \n            // Hide Preview\n            previewOutput.style.display = 'none';\n\n            if (outputMode === 'json') {\n                output.textContent = content;\n                output.className = 'language-json';\n            } else if (outputMode === 'ast') {\n                output.textContent = content;\n                output.className = 'language-lisp'; // Use Lisp highlighting for S-Expr\n            } else {\n                output.textContent = content; \n                output.className = 'language-markdown';\n            }\n            \n            output.removeAttribute('data-highlighted');\n            // Reset any previous line numbers structure\n            // If we don't do this, hljs might not re-run or might stack tables\n            // But output.textContent = content ALREADY destroys the table structure.\n            // So we just need to tell hljs it's fresh.\n            \n            hljs.highlightElement(output);\n            hljs.lineNumbersBlock(output);\n        }\n        \n        status.textContent = 'Valid';\n        status.className = 'status success';\n    } catch (e) {\n        output.textContent = e.message;\n        output.textContent = e.message; \n        status.textContent = 'Error';\n        status.className = 'status error';\n    }\n}\n\n\nfunction renderHTML(data) {\n    const registry = data.registry || { ingredients: {}, cookware: {} };\n    let html = '';\n    \n    // Title\n    if (data.title) {\n        html += `<h1>${escapeHtml(data.title)}</h1>\\n\\n`;\n    }\n    \n    // Meta & Metrics\n    if ((data.meta && Object.keys(data.meta).length > 0) || data.metrics) {\n        html += `<div class=\"metadata\">\\n`;\n        html += `  <ul>\\n`;\n        \n        // Metrics first for visibility\n        if (data.metrics) {\n            html += `    <li class=\"metrics-item\"><strong>\uD83D\uDD52 Total Time</strong>: ${formatDuration(data.metrics.totalTime)}</li>\\n`;\n            html += `    <li class=\"metrics-item\"><strong>\uD83D\uDC68\u200D\uD83C\uDF73 Active Time</strong>: ${formatDuration(data.metrics.activeTime)}</li>\\n`;\n            \n            // Total Mass\n            if (data.metrics.totalMass) {\n                 const mass = Math.round(data.metrics.totalMass);\n                 let msg = `${mass}g`;\n                 let title = \"Total Recipe Input Mass\";\n                 if (data.metrics.massStatus === 'estimated') {\n                     msg = `~${mass}g`;\n                     title += \" (Estimated)\";\n                 }\n                 if (data.metrics.massStatus === 'incomplete') {\n                     msg = `${mass}g?`;\n                     title += \" (Incomplete - missing some weights)\";\n                 }\n                 html += `    <li class=\"metrics-item\" title=\"${title}\"><strong>\u2696\uFE0F Total Mass</strong>: ${msg}</li>\\n`;\n            }\n\n            if (data.metrics.preparationTime) {\n                html += `    <li class=\"metrics-item\" title=\"Based on ingredient count and complexity\"><strong>\uD83D\uDD2A Mise en place</strong>: ${formatDuration(data.metrics.preparationTime)} <small style=\"opacity:0.6; font-weight:normal\">(est.)</small></li>\\n`;\n            }\n\n            // Separator if meta exists\n            if (data.meta && Object.keys(data.meta).length > 0) {\n                 html += `    <li class=\"separator\"></li>\\n`;\n            }\n        }\n\n        if (data.meta) {\n            for (const [k, v] of Object.entries(data.meta)) {\n                if (k !== 'title') html += `    <li><strong>${escapeHtml(k)}</strong>: ${escapeHtml(v)}</li>\\n`;\n            }\n        }\n        html += `  </ul>\\n`;\n        html += `</div>\\n\\n`;\n    }\n    \n    // Shopping List\n    if (data.shopping_list && data.shopping_list.length > 0) {\n        html += `<div class=\"shopping-list\">\\n`;\n        html += `  <h2>Shopping List</h2>\\n`;\n        html += `  <ul>\\n`;\n        data.shopping_list.forEach(item => {\n            if (item.type === 'alternative' || item.type === 'group') {\n                html += `    <li>\\n`;\n                html += `      <strong>Alternative Group</strong>:\\n`;\n                html += `      <ul>\\n`;\n                item.options.forEach(opt => {\n                    html += `        <li>${formatIngredientHTML(opt, registry)}</li>\\n`;\n                });\n                html += `      </ul>\\n`;\n                html += `    </li>\\n`;\n            } else if (item.type === 'composite') {\n                html += `    <li>\\n`;\n                html += `      <strong>${formatIngredientHTML(item, registry)}</strong> (Composite):\\n`;\n                html += `      <ul>\\n`;\n                item.usage.forEach(child => {\n                     html += `        <li>${formatIngredientHTML(child, registry)}</li>\\n`;\n                });\n                html += `      </ul>\\n`;\n                html += `    </li>\\n`;\n            } else if (item.display) {\n                html += `    <li>${escapeHtml(item.display)}</li>\\n`;\n            } else {\n                html += `    <li>${formatIngredientHTML(item, registry)}</li>\\n`;\n            }\n        });\n        html += `  </ul>\\n`;\n        html += `</div>\\n\\n`;\n    }\n    \n    // Cookware\n    if (data.cookware && data.cookware.length > 0) {\n        html += `<div class=\"cookware\">\\n`;\n        html += `  <h2>Cookware</h2>\\n`;\n        html += `  <ul>\\n`;\n        data.cookware.forEach(cw => {\n            if (cw.type === 'alternative' || cw.type === 'group') {\n                 html += `    <li>\\n`;\n                 html += `      <strong>Alternative Group</strong>:\\n`;\n                 html += `      <ul>\\n`;\n                 cw.options.forEach(opt => {\n                     html += `        <li>${formatCookwareHTML(opt, registry)}</li>\\n`;\n                 });\n                 html += `      </ul>\\n`;\n                 html += `    </li>\\n`;\n            } else {\n                 html += `    <li>${formatCookwareHTML(cw, registry)}</li>\\n`;\n            }\n        });\n        html += `  </ul>\\n`;\n        html += `</div>\\n\\n`;\n    }\n    \n    // Instructions\n    if (data.sections && data.sections.length > 0) {\n        html += `<div class=\"instructions\">\\n`;\n        data.sections.forEach(sec => {\n            html += `  <section>\\n`;\n            if (sec.title) {\n                let titleHtml = escapeHtml(sec.title);\n                if (sec.retro_planning) {\n                    titleHtml += ` <small style=\"font-size:0.6em;opacity:0.8;border:1px solid currentColor;border-radius:4px;padding:2px 6px;vertical-align:middle;\">\u23F1 ${escapeHtml(sec.retro_planning)}</small>`;\n                }\n                \n                // Section Mass\n                if (sec.metrics && sec.metrics.totalMass > 0) {\n                     const mass = Math.round(sec.metrics.totalMass);\n                     let msg = `${mass}g`;\n                     let title = \"Section Input Mass\";\n                     if (sec.metrics.massStatus === 'estimated') {\n                         msg = `~${mass}g`;\n                         title += \" (Estimated)\";\n                     }\n                     if (sec.metrics.massStatus === 'incomplete') {\n                         msg = `${mass}g?`;\n                         title += \" (Incomplete)\";\n                     }\n                     titleHtml += ` <small style=\"font-size:0.6em;opacity:0.8;border:1px solid currentColor;border-radius:4px;padding:2px 6px;vertical-align:middle;\" title=\"${title}\">\u2696\uFE0F ${msg}</small>`;\n                }\n\n                html += `    <h3>${titleHtml}</h3>\\n`;\n            }\n            \n            // Section Ingredients\n            if (sec.ingredients && sec.ingredients.length > 0) {\n                html += `    <div class=\"section-ingredients\">\\n`;\n                html += `      <h4>Ingredients</h4>\\n`;\n                html += `      <ul>\\n`;\n                sec.ingredients.forEach(item => {\n                    if (item.type === 'alternative' || item.type === 'group') {\n                        html += `        <li>\\n`;\n                        html += `          <strong>Alternative Group</strong>:\\n`;\n                        html += `          <ul>\\n`;\n                        item.options.forEach(opt => {\n                            html += `            <li>${formatIngredientHTML(opt, registry)}</li>\\n`;\n                        });\n                        html += `          </ul>\\n`;\n                        html += `        </li>\\n`;\n                    } else {\n                        html += `        <li>${formatIngredientHTML(item, registry)}</li>\\n`;\n                    }\n                });\n                html += `      </ul>\\n`;\n                html += `    </div>\\n`;\n            }\n            \n            html += `    <ol class=\"steps\">\\n`;\n            sec.steps.forEach((step, idx) => {\n                if (step.type === 'comment') {\n                    // Render differently, maybe as a note?\n                    html += `      <li style=\"list-style: none; margin-left: -1em; color: gray; font-style: italic;\">\\n`;\n                    html += `        ${escapeHtml(step.value)}\\n`;\n                    html += `      </li>\\n`;\n                    return;\n                }\n\n                html += `      <li>\\n`;\n                if (step.action) {\n                     html += `        <span class=\"action\">[${escapeHtml(step.action)}]</span> `;\n                }\n                \n                let stepContent = '';\n                if (step.type === 'text') {\n                    stepContent = escapeHtml(step.value);\n                } else if (step.type === 'step') {\n                     stepContent = step.content.map((c, i, arr) => {\n                         let str = '';\n                         if (typeof c === 'string') {\n                             str = escapeHtml(c);\n                         } else if (c.type === 'text') {\n                             str = escapeHtml(c.value);\n                         } else if (c.type === 'timer') {\n                             const q = c.quantity || { value: '' };\n                             const qVal = formatQuantityValue(q);\n                             const asyncClass = c.isAsync ? ' async' : '';\n                             str = `<span class=\"timer${asyncClass}\" data-value=\"${q.value}\" data-unit=\"${c.unit || ''}\">${qVal}${c.unit ? ' ' + c.unit : ''}</span>`;\n                         } else if (c.type === 'temperature') {\n                             const q = c.quantity || { value: '' };\n                             const qVal = formatQuantityValue(q);\n                             str = `<span class=\"temp\" data-value=\"${q.value}\" data-unit=\"${c.unit || ''}\">${qVal}${c.unit ? ' ' + c.unit : ''}</span>`;\n                         } else if (c.type === 'reference') {\n                             const name = registry.ingredients[c.id]?.name || c.id;\n                             let refStr = `<span class=\"reference\">${escapeHtml(name)}`;\n                             const qty = getQty(c);\n                             if (qty) {\n                                  refStr += ` <span class=\"quantity\">${qty.text || qty.value}`;\n                                  if (c.unit) refStr += ` <span class=\"unit\">${c.unit}</span>`;\n                                  refStr += `</span>`;\n                             }\n                             refStr += `</span>`;\n                             str = refStr;\n                         } else if (!c.type && c.id) {\n                              if (registry.cookware[c.id]) str = formatCookwareHTML(c, registry);\n                              else str = formatIngredientHTML(c, registry);\n                         } else if (c.type === 'ingredient') {\n                             str = formatIngredientHTML(c, registry);\n                         } else if (c.type === 'cookware') {\n                             str = formatCookwareHTML(c, registry);\n                         } else if (c.type === 'alternative' || c.type === 'group') {\n                             str = c.options.map(opt => {\n                                 const isCookware = opt.type === 'cookware' || registry.cookware[opt.id];\n                                 if (isCookware) return formatCookwareHTML(opt, registry);\n                                 return formatIngredientHTML(opt, registry);\n                             }).join(' <span class=\"keyword\">or</span> ');\n                         } else if (c.type === 'comment') {\n                             str = `<!-- ${escapeHtml(c.value.trim())} -->`;\n                         }\n\n                         // Spacing Logic\n                         const isObject = (typeof c !== 'string' && c.type !== 'text' && c.type !== 'comment');\n                         if (isObject) {\n                             const next = arr[i+1];\n                             if (next) {\n                                let nextChar = '';\n                                if (typeof next === 'string') nextChar = next[0];\n                                else if (next.type === 'text') nextChar = next.value ? next.value[0] : '';\n                                \n                                // Don't add space if next is glue (punctuation or space)\n                                const isGlue = nextChar && /^[.,!?:;)]/.test(nextChar) || (nextChar && /^\\s/.test(nextChar));\n                                if (!isGlue) {\n                                    str += ' ';\n                                }\n                             }\n                         }\n                         return str;\n                     }).join('');\n                }\n                html += `        ${stepContent}\\n`;\n                html += `      </li>\\n`;\n            });\n            html += `    </ol>\\n`;\n            html += `  </section>\\n`;\n        });\n        html += `</div>\\n`;\n    }\n    \n    return html;\n}\n\nfunction renderJsonTree(data) {\n    // Controls\n    let html = `<div class=\"json-controls\">\n        <button id=\"btn-expand-all\" class=\"tree-btn\">Expand All</button>\n        <button id=\"btn-collapse-all\" class=\"tree-btn\">Collapse All</button>\n    </div>`;\n    \n    html += `<div class=\"json-tree\">${renderJsonNode(data, null, false)}</div>`;\n    return html;\n}\n\nfunction renderJsonNode(item, key = null, addComma = false) {\n    const commaHtml = addComma ? `<span class=\"json-comma\">,</span>` : '';\n    const keyHtml = key ? `<span class=\"json-key\">\"${escapeHtml(key)}\"</span>: ` : '';\n    \n    // Primitives\n    if (item === null || typeof item !== 'object') {\n        let valHtml = '';\n        if (item === null) valHtml = `<span class=\"json-null\">null</span>`;\n        if (typeof item === 'boolean') valHtml = `<span class=\"json-bool\">${item}</span>`;\n        if (typeof item === 'number') valHtml = `<span class=\"json-num\">${item}</span>`;\n        if (typeof item === 'string') valHtml = `<span class=\"json-str\">\"${escapeHtml(item)}\"</span>`;\n        \n        // Wrap in a div to maintain line structure (item vs prop)\n        const content = `${keyHtml}${valHtml}${commaHtml}`;\n        return `<div class=\"${key ? 'json-prop' : 'json-item'}\">${content}</div>`;\n    }\n    \n    // Object or Array\n    const isArray = Array.isArray(item);\n    const keys = isArray ? item : Object.keys(item);\n    const isEmpty = keys.length === 0;\n    const openChar = isArray ? '[' : '{';\n    const closeChar = isArray ? ']' : '}';\n    const typeClass = isArray ? 'json-bracket' : 'json-brace';\n    const countText = `${keys.length} items`;\n    \n    if (isEmpty) {\n        return `<div class=\"${key ? 'json-prop' : 'json-item'}\">${keyHtml}<span class=\"${typeClass}\">${openChar}${closeChar}</span>${commaHtml}</div>`;\n    }\n\n    let html = `<div class=\"json-node expanded\">`;\n    \n    // Header Line\n    html += `<div class=\"json-header\">`;\n    html += `<span class=\"json-toggle\">\u25BC</span>`;\n    html += keyHtml;\n    html += `<span class=\"${typeClass}\">${openChar}</span>`;\n    html += `<span class=\"json-count\">${countText}</span>`;\n    html += `</div>`;\n    \n    // Children\n    html += `<div class=\"json-children\">`;\n    keys.forEach((k, index) => {\n        const child = isArray ? k : item[k];\n        const childKey = isArray ? null : k;\n        html += renderJsonNode(child, childKey, index < keys.length - 1);\n    });\n    html += `</div>`;\n    \n    // Footer (Close)\n    // For proper clicking, maybe the closure shouldn't be part of the header, but standard flow.\n    // The user wants \"},\".\n    html += `<div class=\"json-footer\"><span class=\"${typeClass}\">${closeChar}</span>${commaHtml}</div>`;\n    \n    html += `</div>`;\n    return html;\n}\n\nfunction escapeHtml(unsafe) {\n    if (unsafe === undefined || unsafe === null) return '';\n    return String(unsafe)\n         .replace(/&/g, \"&amp;\")\n         .replace(/</g, \"&lt;\")\n         .replace(/>/g, \"&gt;\")\n         .replace(/\"/g, \"&quot;\")\n         .replace(/'/g, \"&#039;\");\n}\n\nfunction formatIngredientHTML(item, registry) {\n    // Lookup\n    const def = registry.ingredients[item.id];\n    const name = def ? def.name : item.id;\n    \n    let displayName = name;\n    if (item.alias) displayName = item.alias;\n\n    let str = `<span class=\"ingredient\" data-name=\"${escapeHtml(name)}\">${escapeHtml(displayName)}`;\n    \n    const qty = getQty(item);\n    \n    // Formula Setup\n    const formulaStr = item.formula ? `${item.formula.percent}% of ${escapeHtml(item.formula.target)}` : null;\n    const isPartial = item.formula && item.formula.is_partial;\n\n    if (isPartial) {\n        // Show Formula AS Quantity (with warning)\n        str += ` <span class=\"quantity formula-qty\" title=\"Calculation partial or failed\">(${formulaStr} \u26A0\uFE0F)</span>`;\n    } else {\n        // Normal Quantity\n        let qtyContent = '';\n        if (qty) {\n            qtyContent += qty.text || qty.value;\n            if (item.unit) qtyContent += ` <span class=\"unit\">${escapeHtml(item.unit)}</span>`;\n        }\n        \n        // Variable entries support\n        if (item.variable_entries && item.variable_entries.length > 0) {\n             const vars = item.variable_entries.join(' + ');\n             if (qtyContent) qtyContent += ` + ${vars}`;\n             else qtyContent = vars;\n        }\n\n        if (qtyContent) {\n            str += ` <span class=\"quantity\">(${qtyContent})</span>`;\n        }\n\n        // Normal Formula indicator\n        if (formulaStr) {\n             str += ` <span class=\"formula\" title=\"Base Mass Used: ${item.formula ? item.formula.base_mass_used : ''}g\">[${formulaStr}]</span>`;\n        }\n    }\n\n    // Mass Badge\n    if (item.normalizedMass) {\n         // Round to max 1 decimal for display\n         const mass = Math.round(item.normalizedMass * 10) / 10;\n         let display = `${mass}g`;\n         let title = `Calculated Mass: ${mass}g\\nMethod: ${item.conversionMethod}`;\n         \n         if (item.isEstimate) {\n             display = `~${display}`;\n             title += ` (Estimated)`;\n         }\n         \n         if (item.conversionMethod === 'explicit') {\n             display = `\u270D\uFE0F ${display}`;\n             title += ` (User Override)`;\n         } else if (item.conversionMethod === 'physical') {\n             title += ` (Exact)`;\n         }\n\n         str += ` <span class=\"mass-badge\" title=\"${title}\">${display}</span>`;\n    }\n    \n    if (item.preparation) str += ` <span class=\"prep\">(${escapeHtml(item.preparation)})</span>`;\n    if (item.modifiers && item.modifiers.includes('optional')) str += ` <span class=\"opt\">(optional)</span>`;\n    if (item.modifiers && item.modifiers.includes('reference')) str += ` <span class=\"ref\" title=\"Reference to existing ingredient\">\u21A9\uFE0F</span>`;\n    \n    str += `</span>`;\n    return str;\n}\n\nfunction renderSExpr(node, level = 0) {\n    if (node === null || node === undefined) return 'nil';\n    if (typeof node !== 'object') {\n        if (typeof node === 'string') return `\"${node}\"`;\n        return String(node);\n    }\n    \n    // Array handling\n    if (Array.isArray(node)) {\n        return node.map(n => renderSExpr(n, level)).join('\\n');\n    }\n\n    const indent = '  '.repeat(level);\n    const type = node.type || 'Object';\n    \n    // Collect attributes and children\n    let attrs = '';\n    let children = [];\n\n    // Keys to ignore or handle specifically\n    const ignore = new Set(['type', 'loc']);\n\n    Object.entries(node).forEach(([k, v]) => {\n        if (ignore.has(k)) return;\n        \n        if (v === null) return;\n\n        if (typeof v !== 'object') {\n            attrs += ` :${k} ${typeof v === 'string' ? `\"${v}\"` : v}`;\n        } else if (Array.isArray(v)) {\n            // Array of children\n            v.forEach(child => children.push(child));\n        } else {\n            // Single child object\n            // If it's a \"Range\" value object (special case in gram)\n            if (v.min !== undefined && v.max !== undefined) {\n                 attrs += ` :${k} ${v.min}-${v.max}`;\n            } else {\n                 children.push(v);\n            }\n        }\n    });\n\n    if (children.length === 0) {\n        return `${indent}(${type}${attrs})`;\n    }\n\n    // Format children\n    const childrenStr = children.map(c => renderSExpr(c, level + 1)).join('\\n');\n    return `${indent}(${type}${attrs}\\n${childrenStr})`;\n}\n\nfunction formatCookwareHTML(item, registry) {\n    const def = registry.cookware[item.id];\n    const name = def ? def.name : item.id;\n    \n    let displayName = name;\n    if (item.alias) displayName = item.alias;\n\n    let str = `<span class=\"cookware\" data-name=\"${escapeHtml(name)}\">${escapeHtml(displayName)}`;\n    \n    const qty = getQty(item);\n    if (qty) {\n         str += ` <span class=\"quantity\">(${qty.value})</span>`;\n    }\n    str += `</span>`;\n    return str;\n}\n\n\nconst highlights = document.getElementById('highlights');\n\nfunction applyHighlights(text) {\n    // Escape HTML first\n    let escaped = text.replace(/&/g, \"&amp;\")\n                      .replace(/</g, \"&lt;\")\n                      .replace(/>/g, \"&gt;\");\n\n    // Simple Tokenizer Loop would be better, but let's try composed Regex for simplicity\n    // Order matters! \n    \n    // Comments\n    escaped = escaped.replace(/(\\/\\/.*)/g, '<span class=\"token-comment\">$1</span>');\n    \n    // Frontmatter (naive)\n    // Multiline regex in JS for frontmatter\n    // We can't easily match mulitline with simple replace if we already escaped lines. \n    // And standard regex replace doesn't handle state.\n    \n    // Let's do a slightly smarter replacement:\n    // Highlight specific syntax chars wherever they appear if not in comment?\n    // Comments are already wrapped in span, so we shouldn't match inside them?\n    // Regex inside HTML is dangerous. \n    \n    // REWRITE: Tokenize properly-ish.\n    // Actually, for a simple playground, we can use a sequence of replacements on parts that are NOT tags.\n    // But that's hard.\n    \n    // Let's just highlight specific patterns assuming no overlap or handled by order.\n    // Reset to unescaped for processing? No, must render HTML.\n    \n    // Strategy:\n    // 1. Split by newlines.\n    // 2. Process each line.\n    \n    const lines = text.split('\\n');\n    const processedLines = lines.map(line => {\n        // Escape content\n        let l = line.replace(/&/g, \"&amp;\")\n                    .replace(/</g, \"&lt;\")\n                    .replace(/>/g, \"&gt;\");\n                    \n        // Comments\n        if (l.trim().startsWith('//')) {\n            return `<span class=\"token-comment\">${l}</span>`;\n        }\n        \n        // Header\n        if (l.trim().startsWith('##')) {\n             const html = l.replace(/(\\{T-.*?\\})/, '<span class=\"token-timer\">$1</span>');\n             return `<span class=\"token-header\">${html}</span>`;\n        }\n        \n        // Frontmatter separator\n        if (l.trim() === '---') {\n            return `<span class=\"token-frontmatter\">${l}</span>`;\n        }\n\n        // Action [Action Name] at start of line\n        // Strict: Start of line (after leading spaces in l, but l is the full line content including spaces here?)\n        // The loop splits by \\n, so l is the line.\n        // We match ` [Action]` or `[Action]`.\n        l = l.replace(/^(\\s*)(\\[)([^\\]]+)(\\])/, '$1<span class=\"token-action\">$2$3$4</span>');\n\n        // Ingredients / Cookware / etc\n        // @name{qty%unit}\n        // #name{...}\n        // ~timer{...}\n        // !temp{...}\n        \n        // Highlighting Ingredients / Cookware / etc\n        \n        // Regex explaining:\n        // 1. ([@#~!]) -> Type start\n        // 2. ((?:\\[.*?\\]|[^\\{\\}\\[\\]\\(\\)<>\\|@#~!&\\?\\*\\n])*) -> Name (and modifiers? modifiers are ?, -, *, &).\n        //    Modifiers are allowed before name. Modifiers are ? - * &.\n        //    So name group actually captures modifiers + name.\n        //    We exclude syntax chars but modifiers are syntax chars! \n        //    Wait, modifiers are ?, -, *, &.\n        //    If I exclude & from name regex, I exclude modifer?\n        //    Yes. Name definition in grammar: `(~(syntaxChar | nl) any)+`.\n        //    `syntaxChar` INCLUDES `&`, `?`, `*`.\n        //    So strict parser says name cannot contain `&`.\n        //    Structure: @ [Modifiers] Name ...\n        //    The string between @ and { contains modifiers + name.\n        //    The grammar separates them.\n        //    Here in regex we capture \"everything between @ and {\".\n        //    So we should allow modifiers in the capture group.\n        //    We should exclude syntax chars that START other things or delimiters.\n        //    Delimiters: { (start qty), [ (start alias), < (composite).\n        //    Start new element: @ # ~ !\n        //    Others: | (alternative), ( (prep).\n        //    So we should exclude: { [ < | ( @ # ~ ! \n        //    And maybe ) } ] > for safety.\n        //    We should NOT exclude ?, -, *, & because they are modifiers.\n        \n        // Regex explaining:\n        // 1. (-&gt;&amp;|[@#~!&]) -> Type start. Must handle escaped ->& which is -&gt;&amp;\n        // 2. ((?:\\[.*?\\]|[^\\{\\[\\<\\(\\|\\@\\#\\~\\!\\n])*) -> Name\n        \n        l = l.replace(/(-&gt;&amp;|[@#~!&])((?:\\[.*?\\]|[^\\{\\[\\<\\(\\|\\@\\#\\~\\!\\n])*)(\\{.*?\\})?/g, (match, type, name, qty) => {\n             // Filter false positives for '!' (punctuation)\n             if (type === '!' && !qty && (!name || !name.trim().match(/[a-zA-Z0-9]/))) {\n                 return match; \n             }\n             \n             // Handle escaped entities and references\n             let displayType = type;\n             let displayName = name;\n             \n             if (type === '&') {\n                 // Check if it's a pure entity literal like &lt; &gt; &amp;\n                 if (name === 'lt;' || name === 'gt;' || name === 'amp;') {\n                     return match;\n                 }\n                 // Check if it is a reference that got double-escaped prefix &amp;name\n                 if (name.startsWith('amp;')) {\n                     displayName = name.slice(4); // Remove amp;\n                     // It is a reference &name\n                 } \n             }\n             \n             if (type === '-&gt;&amp;') {\n                 displayType = '->&';\n             }\n\n             let cls = 'token-ingredient';\n             if (type === '#') cls = 'token-cookware';\n             if (type === '~') cls = 'token-timer';\n             if (type === '!') cls = 'token-temp';\n             if (type === '&' || type === '-&gt;&amp;') cls = 'token-decl'; \n             \n             // Wrap parts\n             const symbolHtml = `<span class=\"${cls}\">${displayType}</span>`;\n             const nameHtml = `<span class=\"${cls}\">${displayName}</span>`;\n             \n             let qtyHtml = '';\n             if (qty) {\n                 qtyHtml = `<span class=\"${cls}\">${qty}</span>`; \n                 qtyHtml = qtyHtml.replace(/(\\d+(?:\\.\\d+)?)/g, '<span class=\"token-qty\">$1</span>');\n                 qtyHtml = qtyHtml.replace(/(%)([\\w\u00B0]+)/g, '<span class=\"token-syntax\">$1</span><span class=\"token-unit\">$2</span>');\n             }\n             \n             return `${symbolHtml}${nameHtml}${qtyHtml}`;\n        });\n        \n        return l;\n    });\n    \n    return processedLines.join('\\n') + '<br>'; // trailing newlines need br or they disappear\n}\n\n\nfunction handleInput() {\n    const text = input.value;\n    highlights.innerHTML = applyHighlights(text);\n    update();\n}\n\nfunction handleScroll() {\n    highlights.scrollTop = input.scrollTop;\n    highlights.scrollLeft = input.scrollLeft;\n}\n\n// Event Listeners\n\n// 1. Sync Scroll\ninput.addEventListener('scroll', handleScroll);\n\n// 2. Highlight (Immediate)\ninput.addEventListener('input', () => {\n    highlights.innerHTML = applyHighlights(input.value);\n});\n\n// 3. Parse (Debounced)\nconst debouncedParse = debounce(update, 300);\ninput.addEventListener('input', debouncedParse);\n\n// Initial state\nhighlights.innerHTML = applyHighlights(input.value);\nupdate();\n\nfunction showWarnings(warnings) {\n    if (!warningsArea) return;\n    warningsArea.style.display = 'block';\n    \n    // Group warnings?\n    // Structure: { code, message, item }\n    \n    let html = '<div style=\"color: #ef4444; font-weight: bold; margin-bottom: 0.5rem;\">\u26A0\uFE0F Compiler Warnings</div>';\n    html += '<ul style=\"margin: 0; padding-left: 1.5rem; color: #ef4444;\">';\n    \n    warnings.forEach(w => {\n        html += `<li>[${w.code}] ${w.message}</li>`;\n    });\n    \n    html += '</ul>';\n    warningsArea.innerHTML = html;\n}\n\nfunction hideWarnings() {\n    if (warningsArea) warningsArea.style.display = 'none';\n}\nconst copyBtn = document.getElementById('copy-btn');\n\ncopyBtn.addEventListener('click', () => {\n    const textToCopy = output.textContent;\n    navigator.clipboard.writeText(textToCopy).then(() => {\n        // Visual feedback\n        const originalIcon = copyBtn.innerHTML;\n        copyBtn.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 256 256\"><path d=\"M229.66,55.51a8,8,0,0,0-11.32,0L102.5,171.34,49.66,118.51a8,8,0,0,0-11.32,11.32l58.5,58.5a8,8,0,0,0,11.32,0L229.66,66.83A8,8,0,0,0,229.66,55.51Z\"></path></svg>`;\n        copyBtn.style.color = 'var(--token-def)'; // Use our green token color\n        \n        setTimeout(() => {\n            copyBtn.innerHTML = originalIcon;\n            copyBtn.style.color = ''; // Reset color\n        }, 2000);\n    }).catch(err => {\n        console.error('Failed to copy: ', err);\n    });\n});\n// Examples Logic\nconst examplesSelect = document.getElementById('examples-select');\n\n// Load Manifest and Populate Select\nif (examplesSelect) {\n    fetch('dist/examples/manifest.json')\n        .then(res => {\n            if (!res.ok) throw new Error('Could not load manifest');\n            return res.json();\n        })\n        .then(manifest => {\n            // Clear existing options (keep the placeholder)\n            if (examplesSelect.options.length > 1) {\n                // Remove all except first\n                while (examplesSelect.options.length > 1) {\n                    examplesSelect.remove(1);\n                }\n            }\n\n            // Populate\n            manifest.forEach(ex => {\n                const opt = document.createElement('option');\n                opt.value = ex.id; // We store ID, but we need path\n                opt.dataset.path = ex.path; // fix path for runtime\n                opt.textContent = ex.title;\n                examplesSelect.appendChild(opt);\n            });\n        })\n        .catch(e => console.error('Manifest Error:', e));\n\n    examplesSelect.addEventListener('change', (e) => {\n        const option = e.target.selectedOptions[0];\n        if (!option || !option.dataset.path) return;\n\n        const path = option.dataset.path;\n        fetch(path)\n            .then(res => {\n                if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);\n                return res.text();\n            })\n            .then(text => {\n                input.value = text;\n                handleInput();\n            })\n            .catch(err => {\n                console.error('Could not load example:', err);\n                alert('Error loading example file.');\n            });\n\n        // Reset selection\n        e.target.value = \"\";\n    });\n}\n"],
  "mappings": "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",
  "names": ["abstract", "optMethodName", "methodName", "assert", "cond", "message", "defineLazyProperty", "obj", "propName", "getterFn", "memo", "clone", "repeatFn", "fn", "n", "arr", "repeatStr", "str", "repeat", "x", "getDuplicates", "array", "duplicates", "idx", "copyWithoutDuplicates", "noDuplicates", "entry", "isSyntactic", "ruleName", "firstChar", "isLexical", "padLeft", "len", "optChar", "ch", "StringBuffer", "escapeUnicode", "unescapeCodePoint", "s", "unexpectedObjToString", "baseToString", "typeName", "checkNotNull", "toRegExp", "val", "UnicodeCategories", "cat", "UnicodeBinaryProperties", "prop", "PExpr", "_PExpr", "interval", "any", "end", "Terminal", "Range", "from", "to", "Param", "index", "Alt", "terms", "Extend", "superGrammar", "name", "body", "origBody", "Splice", "beforeTerms", "afterTerms", "Seq", "factors", "Iter", "expr", "Star", "Plus", "Opt", "Not", "Lookahead", "Lex", "Apply", "args", "common.isSyntactic", "UnicodeChar", "categoryOrProp", "createError", "optInterval", "e", "intervalSourcesDontMatch", "grammarSyntaxError", "matchFailure", "undeclaredGrammar", "grammarName", "namespace", "duplicateGrammarDeclaration", "grammar", "grammarDoesNotSupportIncrementalParsing", "undeclaredRule", "cannotOverrideUndeclaredRule", "optSource", "cannotExtendUndeclaredRule", "duplicateRuleDeclaration", "declGrammarName", "wrongNumberOfParameters", "expected", "actual", "source", "wrongNumberOfArguments", "duplicateParameterNames", "invalidParameter", "syntacticVsLexicalNote", "applicationOfSyntacticRuleFromLexicalContext", "applyExpr", "applySyntacticWithLexicalRuleApplication", "unnecessaryExperimentalApplySyntactic", "incorrectArgumentType", "expectedType", "multipleSuperSplices", "invalidCodePoint", "applyWrapper", "node", "digitIntervals", "d", "fullInterval", "kleeneExprHasNullableOperand", "kleeneExpr", "applicationStack", "actuals", "stackTrace", "app", "pexprs.Apply", "inconsistentArity", "multipleErrors", "errors", "messages", "missingSemanticAction", "ctorName", "type", "stack", "info", "ans", "moreInfo", "throwErrors", "padNumbersToEqualLength", "maxLen", "common.padLeft", "strcpy", "dest", "src", "offset", "origDestLen", "start", "lineAndColumnToMessage", "ranges", "lineAndCol", "common", "sb", "common.StringBuffer", "lineNumbers", "appendLine", "num", "content", "prefix", "lineLen", "indicationLine", "i", "startIdx", "endIdx", "common.assert", "lineStartOffset", "gutterWidth", "builtInRulesCallbacks", "awaitBuiltInRules", "cb", "announceBuiltInRules", "getLineAndColumn", "lineNum", "colNum", "currOffset", "nextLine", "prevLine", "prevLineStartOffset", "c", "lineEndOffset", "nextLineEndOffset", "line", "getLineAndColumnMessage", "uniqueId", "idCounter", "Interval", "_Interval", "sourceString", "intervals", "util.getLineAndColumn", "range", "util.getLineAndColumnMessage", "that", "errors.intervalSourcesDontMatch", "contents", "newStartIdx", "firstInterval", "MAX_CHAR_CODE", "MAX_CODE_POINT", "InputStream", "nextChar", "cp", "optIgnoreCase", "optEndIdx", "MatchResult", "matcher", "input", "startExpr", "cst", "cstOffset", "rightmostFailurePosition", "optRecordedFailures", "common.defineLazyProperty", "detail", "errorInfo", "matchResultWithFailures", "failures", "failure", "pos", "PosInfo", "application", "headApplication", "memoRec", "applicationMemoKeyStack", "indexOfFirstInvolvedRule", "involvedApplicationMemoKeys", "applicationMemoKey", "memoKey", "invalidatedIdx", "k", "BALLOT_X", "CHECK_MARK", "DOT_OPERATOR", "RIGHTWARDS_DOUBLE_ARROW", "SYMBOL_FOR_HORIZONTAL_TABULATION", "SYMBOL_FOR_LINE_FEED", "SYMBOL_FOR_CARRIAGE_RETURN", "Flags", "spaces", "common.repeat", "getInputExcerpt", "excerpt", "asEscapedString", "Trace", "_Trace", "pos1", "pos2", "succeeded", "bindings", "optChildren", "ruleBodyTrace", "value", "visitorObjOrFn", "optThisArg", "visitor", "_walk", "parent", "depth", "recurse", "child", "mask", "pexprs.PExpr", "pexprs.any", "pexprs.end", "pexprs.Terminal", "pexprs.Range", "pexprs.UnicodeChar", "pexprs.Alt", "pexprs.Iter", "pexprs.Lex", "pexprs.Lookahead", "pexprs.Not", "pexprs.Param", "pexprs.Seq", "BuiltInRules", "util.awaitBuiltInRules", "g", "lexifyCount", "skipSyntacticCheck", "ruleInfo", "isContextSyntactic", "errors.undeclaredRule", "errors.applicationOfSyntacticRuleFromLexicalContext", "errors.wrongNumberOfArguments", "isBuiltInApplySyntactic", "errors.incorrectArgumentType", "arg", "errors.applySyntacticWithLexicalRuleApplication", "errors.unnecessaryExperimentalApplySyntactic", "errors.invalidParameter", "arity", "term", "otherArity", "errors.inconsistentArity", "pexprs.Extend", "actualArity", "expectedArity", "errors.kleeneExprHasNullableOperand", "pexprs.Opt", "Node", "matchLength", "childIdx", "TerminalNode", "NonterminalNode", "children", "childOffsets", "common.isLexical", "IterationNode", "isOptional", "common.abstract", "state", "inputStream", "origPos", "factor", "cols", "colOffsets", "numMatches", "prevPos", "row", "rowOffsets", "lastCol", "lastColOffsets", "endOffset", "caller", "posInfo", "currentLeftRecursion", "origPosInfo", "description", "origInputStreamExaminedLength", "currentLR", "isHeadOfLeftRecursion", "offsets", "lrMemoRec", "newValue", "seedTrace", "getMetaInfo", "grammarInterval", "metaInfo", "adjusted", "formals", "pexprs.Splice", "pexprs.Star", "pexprs.Plus", "key", "inlined", "isRestrictedJSIdentifier", "resolveDuplicatedNames", "argumentNameList", "count", "argName", "dupArgName", "subscript", "firstArgIndex", "noDupCheck", "termArgNameLists", "numArgs", "colIdx", "col", "rowIdx", "uniqueNames", "factorArgumentNameList", "exprArgumentString", "ps", "isValidType", "Failure", "_Failure", "pexpr", "text", "t", "f", "CaseInsensitiveTerminal", "_CaseInsensitiveTerminal", "param", "terminal", "matchStr", "builtInApplySyntacticBody", "builtInRules", "applySpaces", "MatchState", "optPositionToRecordFailures", "optNode", "currentApplication", "newLength", "shouldCloneIfNew", "memoRecRightmostFailurePosition", "origNumBindings", "origUserData", "origRecordedFailures", "memoPos", "origTrace", "traceEntry", "rightmostFailures", "matchResult", "rootTrace", "Matcher", "prevInput", "memoTable", "restOfMemoTable", "optStartApplicationStr", "options", "opts", "applicationStr", "startApp", "globalActionStack", "hasOwnProperty", "Wrapper", "sourceInterval", "baseInterval", "attributeName", "childWrapper", "childNode", "base", "optChildWrappers", "childWrappers", "childNodes", "iter", "wrapper", "Semantics", "_Semantics", "superSemantics", "self", "util.uniqueId", "semanticsOnly", "hasSuperSemantics", "superSemanticsGrammar", "relatedGrammar", "semanticOperations", "actionDict", "builtInDefault", "signature", "method", "srcArray", "actionName", "typePlural", "parsedNameAndFormalArgs", "parseSignature", "newDefaultAction", "doIt", "realActionDict", "Operation", "Attribute", "thisThing", "argsObj", "formal", "oldArgs", "inheritedFormals", "inheritedActionDict", "newActionDict", "optBaseInterval", "r", "errors.missingSemanticAction", "optSuperSemantics", "proxy", "common.unexpectedObjToString", "operationOrAttributeName", "action", "semantic", "semantics", "nodeWrapper", "actionFn", "SPECIAL_ACTION_NAMES", "getSortedRuleValues", "jsonToJS", "ohmGrammar", "buildGrammar", "Grammar", "_Grammar", "rules", "optDefaultStartRule", "myRules", "otherRules", "rule", "optStartApplication", "m", "what", "problems", "v", "details", "prettyProblems", "problem", "error", "superGrammarExpr", "startRule", "isDefinition", "operation", "bodyRecipe", "superGrammarOutput", "recipeElements", "first", "errors.wrongNumberOfParameters", "pexprs.CaseInsensitiveTerminal", "builderFn", "GrammarDecl", "errors.cannotOverrideUndeclaredRule", "errors.duplicateParameterNames", "expectedFormals", "expectedNumFormals", "primitive", "grammarErrors", "grammarHasInvalidApplications", "errors.throwErrors", "errors.duplicateRuleDeclaration", "descIgnored", "fragment", "errors.cannotExtendUndeclaredRule", "Builder", "defaultStartRule", "gDecl", "ruleRecipe", "termArgs", "factorArgs", "optParams", "recipe", "result", "makeRecipe", "superSplicePlaceholder", "namespaceHas", "ns", "match", "optOhmGrammarForTesting", "builder", "decl", "currentRuleName", "currentRuleFormals", "overriding", "grammarIter", "id", "_open", "_close", "errors.duplicateGrammarDeclaration", "_", "superGrammarName", "errors.undeclaredGrammar", "fs", "b", "expansionPos", "errors.multipleSuperSplices", "opointy", "cpointy", "seqs", "inlineRuleName", "isNewRuleDeclaration", "params", "open", "close", "space1", "space2", "rest", "cs", "common.unescapeCodePoint", "err", "errors.invalidCodePoint", "xs", "operationsAndAttributesGrammar", "initBuiltInSemantics", "initPrototypeParser", "actions", "_children", "optFormals", "oparen", "cparen", "findIndentation", "topOfStack", "regex", "indent", "indentSize", "prevSize", "indentPos", "prevLength", "INDENT_DESCRIPTION", "DEDENT_DESCRIPTION", "INVALID_CODE_POINT", "InputStreamWithIndentation", "Indentation", "isIndent", "pseudoTokens", "sign", "applyIndent", "applyDedent", "newAnyBody", "IndentationSensitive", "version", "isBuffer", "compileAndLoad", "errors.grammarSyntaxError", "optNamespace", "grammars", "grammarNames", "require_shimmed_gram_parser", "__commonJSMin", "exports", "__createBinding", "o", "m", "k", "k2", "desc", "__setModuleDefault", "v", "__importStar", "ownKeys", "ar", "mod", "result", "i", "__exportStar", "p", "getAST", "fs", "path", "ohm", "grammarContent", "grammar", "clean", "str", "getOpt", "node", "parseNumber", "n", "numStr", "denStr", "num", "den", "parseFrontmatterValue", "val", "strip", "s", "inner", "semantics", "frontmatter", "content", "meta", "sections", "_1", "_2", "kv", "_3", "_4", "c", "acc", "curr", "key", "value", "_nls", "nls", "blocks", "b", "header", "h", "title", "extension", "retroPlanning", "intermediateDecl", "ext", "retro", "_sp", "decl", "intermediate", "comment", "child", "actionNode", "line1", "lines", "_term", "action", "flatContent", "_lb", "txt", "_rb", "items", "name", "spaces", "chars", "_r", "_n", "first", "_bars", "rest", "_at", "_mods", "_name", "_alias", "_qty", "_prep", "_comp", "modifiers", "_lt", "_sp1", "_sp2", "_sp3", "_lp", "text", "_rp", "_s1", "_s3", "_pct", "_s2", "marker", "fixed", "_sFixed", "unit", "_sUnit", "_5", "n1", "_", "n2", "min", "max", "_hash", "mods", "alias", "qty", "prep", "_amp", "asyncMod", "input", "match", "require_units", "__commonJSMin", "exports", "normalizeUnit", "quantityObj", "unit", "u", "val", "base", "map", "getMass", "qty", "quantityToMinutes", "sub", "raw", "require_ingredient_db", "__commonJSMin", "exports", "getIngredientData", "RAW_ENTRIES", "entry", "name", "slug", "require_mass_normalization", "__commonJSMin", "exports", "normalizeMass", "units_1", "ingredient_db_1", "utils_1", "amount", "unit", "ingredientName", "overrides", "u", "massMap", "volMap", "volumeMl", "density", "method", "data", "unitWt", "require_utils", "__commonJSMin", "exports", "slugify", "text", "minifyQuantity", "q", "mass_normalization_1", "createCleanUsage", "item", "id", "overrides", "obj", "qtyNode", "cleanQty", "valForCalc", "unitForCalc", "norm", "MODIFIER_MAP", "m", "comp", "compQty", "minified", "cleanObject", "x", "res", "key", "val", "cleanedVal", "require_graph", "__commonJSMin", "exports", "detectCycles", "sections", "graph", "sec", "ing", "d", "visited", "recursionStack", "cycles", "dfs", "nodeId", "deps", "dep", "node", "require_shopping", "__commonJSMin", "exports", "generateShoppingList", "utils_1", "mass_normalization_1", "graph_1", "formatQuantity", "q", "sections", "registry", "overrides", "listMap", "compositeMap", "alternatives", "circularIds", "sec", "item", "parentId", "comp", "declParentQty", "minQ", "subId", "currentParentTotal", "uUnit", "uKey", "uEntry", "childVal", "m", "id", "key", "existing", "numericQty", "unit", "isGhost", "qObj", "text", "display", "norm", "u", "qStr", "uStr", "standardList", "res", "units", "hasMass", "hasOther", "extraEntries", "i", "allVars", "compositeList", "c", "maxQ", "parentName", "parentNorm", "cRes", "childUsage", "childId", "childName", "childNorm", "require_dist", "__commonJSMin", "exports", "processBlockItem", "compile", "units_1", "utils_1", "shopping_1", "mass_normalization_1", "item", "ctx", "registry", "secIngredients", "secCookware", "id", "defaultUnit", "entry", "parentId", "parent", "rel", "targetName", "targetId", "percent", "totalQty", "inheritedUnit", "isGhost", "markerChar", "formulaStr", "varData", "i", "prev", "norm", "newVal", "usage", "processedOptions", "tempIngredientsScope", "tempCookwareScope", "opt", "captureIngredients", "captureCookware", "result", "r", "obj", "cleanQty", "w", "q", "unit", "calculateMassMetrics", "ingredients", "totalMass", "missing", "isEstimated", "target", "type", "status", "processSections", "astChildren", "overrides", "sections", "blocksToProcess", "cookCursor", "globalActiveTime", "activeBackgroundTasks", "section", "varName", "sectionIngredients", "sectionCookware", "steps", "block", "localActiveTime", "stepAsyncTasks", "stepContentObjects", "stepText", "processed", "p", "qtyVal", "name", "duration", "startTime", "endTime", "stepObj", "stepMass", "stepValid", "varId", "res", "secMass", "partial", "ing", "maxBackgroundTaskEnd", "t", "totalTime", "ast", "densityOverrides", "d", "parts", "density", "resultPayload", "sec", "allRawIngredients", "globalMassMetrics", "shopping_list", "globalCookware", "cw", "countPrep", "localTime", "maxOpt", "optTime", "s", "c", "import_gram_parser", "import_gram_compiler", "input", "output", "status", "themeToggle", "warningsArea", "viewSelect", "outputMode", "update", "isLight", "updateThemeIcon", "savedTheme", "debounce", "func", "wait", "timeout", "args", "later", "getQty", "item", "formatQuantityValue", "q", "formatDuration", "minutes", "h", "m", "renderMarkdown", "data", "registry", "md", "k", "v", "opt", "formatIngredient", "parentStr", "child", "cw", "formatCookware", "sec", "step", "idx", "stepNum", "stepText", "c", "i", "arr", "str", "qStr", "qty", "next", "nextChar", "def", "formulaStr", "qtyParts", "text", "ast", "result", "content", "showWarnings", "hideWarnings", "renderSExpr", "renderJsonTree", "renderHTML", "previewOutput", "preOutput", "btnExpand", "btnCollapse", "n", "t", "index", "e", "node", "toggle", "html", "escapeHtml", "mass", "msg", "title", "formatIngredientHTML", "formatCookwareHTML", "titleHtml", "stepContent", "qVal", "name", "refStr", "renderJsonNode", "key", "addComma", "commaHtml", "keyHtml", "valHtml", "isArray", "keys", "isEmpty", "openChar", "closeChar", "typeClass", "countText", "unsafe", "displayName", "qtyContent", "vars", "display", "level", "indent", "type", "attrs", "children", "ignore", "childrenStr", "highlights", "applyHighlights", "escaped", "line", "l", "match", "displayType", "cls", "symbolHtml", "nameHtml", "qtyHtml", "handleInput", "handleScroll", "debouncedParse", "warnings", "w", "copyBtn", "textToCopy", "originalIcon", "err", "examplesSelect", "res", "manifest", "ex", "option", "path"]
}
